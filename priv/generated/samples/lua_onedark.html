<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Autumn Sample - lua - onedark (inline)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap" rel="stylesheet">
  <style>
    * {
      font-family: 'JetBrains Mono', monospace;
      line-height: 1.5;
    }
    pre {
      font-size: 15px;
      margin: 20px;
      padding: 50px;
      border-radius: 10px;
    }
  </style>
  <style>
  /* onedark */
pre.autumn-hl { background-color: #282C34; color: #ABB2BF; }
.ahl-info { font-weight: bold; color: #61AFEF; }
.ahl-label { color: #C678DD; }
.ahl-markup.ahl-bold { font-weight: bold; color: #D19A66; }
.ahl-namespace { color: #61AFEF; }
.ahl-markup.ahl-raw.ahl-inline { color: #98C379; }
.ahl-markup.ahl-heading { color: #E06C75; }
.ahl-constant.ahl-builtin { color: #D19A66; }
.ahl-attribute { color: #E5C07B; }
.ahl-type { color: #E5C07B; }
.ahl-diagnostic.ahl-warning { color: #E5C07B; }
.ahl-hint { font-weight: bold; color: #98C379; }
.ahl-constant { color: #56B6C2; }
.ahl-warning { font-weight: bold; color: #E5C07B; }
.ahl-constructor { color: #61AFEF; }
.ahl-diagnostic.ahl-error { color: #E06C75; }
.ahl-diff.ahl-minus { color: #E06C75; }
.ahl-tag { color: #E06C75; }
.ahl-comment { font-style: italic; color: #5C6370; }
.ahl-markup.ahl-link.ahl-text { color: #C678DD; }
.ahl-markup.ahl-italic { font-style: italic; color: #C678DD; }
.ahl-function.ahl-macro { color: #C678DD; }
.ahl-special { color: #61AFEF; }
.ahl-diff.ahl-plus { color: #98C379; }
.ahl-operator { color: #C678DD; }
.ahl-keyword.ahl-directive { color: #C678DD; }
.ahl-diagnostic.ahl-info { color: #61AFEF; }
.ahl-constant.ahl-character.ahl-escape { color: #D19A66; }
.ahl-keyword.ahl-control { color: #C678DD; }
.ahl-markup.ahl-link.ahl-url {  color: #56B6C2; }
.ahl-variable.ahl-builtin { color: #61AFEF; }
.ahl-variable.ahl-parameter { color: #E06C75; }
.ahl-string { color: #98C379; }
.ahl-diff.ahl-delta { color: #D19A66; }
.ahl-keyword.ahl-control.ahl-import { color: #E06C75; }
.ahl-keyword { color: #E06C75; }
.ahl-markup.ahl-quote { color: #E5C07B; }
.ahl-function.ahl-builtin { color: #61AFEF; }
.ahl-markup.ahl-list { color: #E06C75; }
.ahl-keyword.ahl-operator { color: #C678DD; }
.ahl-diagnostic.ahl-hint { color: #98C379; }
.ahl-variable.ahl-other.ahl-member { color: #E06C75; }
.ahl-function { color: #61AFEF; }
.ahl-constant.ahl-numeric { color: #D19A66; }
.ahl-error { font-weight: bold; color: #E06C75; }

  </style>
</head>
<body>
  <pre class="autumn-hl"><code class="language-lua" translate="no"><span class="ahl-comment">---@class <span class="ahl-type">Lazy</span>: <span class="ahl-type">LazyCommands</span>
</span><span class="ahl-keyword">local</span> <span class="ahl-variable">M</span><span class="ahl-operator"> =</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-variable">
M</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">_start</span><span class="ahl-operator"> =</span> 0<span class="ahl-variable">

vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">uv</span><span class="ahl-operator"> =</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">uv</span><span class="ahl-keyword ahl-operator"> or</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">loop</span><span class="ahl-keyword">

local</span> <span class="ahl-keyword ahl-function">function</span> <span class="ahl-variable">profile_require</span>()
  <span class="ahl-keyword">local</span> <span class="ahl-variable">done</span> <span class="ahl-operator">=</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span> ---@type table&lt;string, true&gt;<span class="ahl-keyword">
  local</span> <span class="ahl-variable">r</span> <span class="ahl-operator">=</span> <span class="ahl-variable">require</span>
  <span class="ahl-variable">_G</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">require</span> <span class="ahl-operator">=</span> <span class="ahl-keyword ahl-function">function</span>(<span class="ahl-variable">modname</span>)
    <span class="ahl-keyword">local</span> <span class="ahl-variable">Util</span> <span class="ahl-operator">=</span> <span class="ahl-variable">package</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">loaded</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-string">&quot;lazy.core.util&quot;</span><span class="ahl-punctuation ahl-bracket">]</span>
    <span class="ahl-keyword">if</span> <span class="ahl-variable">Util</span> <span class="ahl-keyword ahl-operator">and</span> <span class="ahl-keyword ahl-operator">not</span> <span class="ahl-variable">done</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">modname</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-keyword">then</span>
      <span class="ahl-variable">done</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">modname</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">=</span> true
      <span class="ahl-variable">Util</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">track</span><span class="ahl-function">(</span><span class="ahl-punctuation ahl-bracket">{</span> <span class="ahl-variable">require</span> <span class="ahl-operator">=</span> <span class="ahl-variable">modname</span> <span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-function">)</span>
      <span class="ahl-keyword">local</span> <span class="ahl-variable">ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">ret</span> <span class="ahl-operator">=</span> <span class="ahl-variable">pcall</span><span class="ahl-function">(</span><span class="ahl-keyword ahl-function">function</span>()
        <span class="ahl-keyword">return <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">F</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">pack_len</span><span class="ahl-function">(</span><span class="ahl-variable">r</span><span class="ahl-function">(</span><span class="ahl-variable">modname</span><span class="ahl-function">)</span><span class="ahl-function">)</span></span>
      <span class="ahl-keyword ahl-function">end</span><span class="ahl-function">)</span>
      <span class="ahl-variable">Util</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">track</span><span class="ahl-function">(</span><span class="ahl-function">)</span>
      <span class="ahl-keyword">if</span> <span class="ahl-keyword ahl-operator">not</span> <span class="ahl-variable">ok</span> <span class="ahl-keyword">then</span>
        <span class="ahl-variable">error</span><span class="ahl-function">(</span><span class="ahl-variable">ret</span><span class="ahl-punctuation ahl-delimiter">,</span> 2<span class="ahl-function">)</span>
      <span class="ahl-keyword">end</span>
      <span class="ahl-keyword">return <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">F</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">unpack_len</span><span class="ahl-function">(</span><span class="ahl-variable">ret</span><span class="ahl-function">)</span></span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-keyword">return <span class="ahl-variable">r</span><span class="ahl-function">(</span><span class="ahl-variable">modname</span><span class="ahl-function">)</span></span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword ahl-function">end</span>
<span class="ahl-keyword ahl-function">end</span><span class="ahl-comment">

---@overload fun(opts: LazyConfig)</span><span class="ahl-comment">
---@overload fun(spec:LazySpec, opts: LazyConfig)</span><span class="ahl-keyword ahl-function">
function</span> <span class="ahl-variable">M</span>.<span class="ahl-variable">setup</span>(<span class="ahl-variable">spec</span>, <span class="ahl-variable">opts</span>)
  <span class="ahl-keyword">if</span> <span class="ahl-variable">type</span><span class="ahl-function">(</span><span class="ahl-variable">spec</span><span class="ahl-function">)</span> <span class="ahl-operator">==</span> <span class="ahl-string">&quot;table&quot;</span> <span class="ahl-keyword ahl-operator">and</span> <span class="ahl-variable">spec</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">spec</span> <span class="ahl-keyword">then</span>
    <span class="ahl-comment">---@cast spec LazyConfig</span>
    <span class="ahl-variable">opts</span> <span class="ahl-operator">=</span> <span class="ahl-variable">spec</span>
  <span class="ahl-keyword">else</span>
    <span class="ahl-variable">opts</span> <span class="ahl-operator">=</span> <span class="ahl-variable">opts</span> <span class="ahl-keyword ahl-operator">or</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-variable">opts</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">spec</span> <span class="ahl-operator">=</span> <span class="ahl-variable">spec</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-variable">M</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">_start</span> <span class="ahl-operator">=</span> <span class="ahl-variable">M</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">_start</span> <span class="ahl-operator">==</span> 0 <span class="ahl-keyword ahl-operator">and</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">uv</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">hrtime</span><span class="ahl-function">(</span><span class="ahl-function">)</span> <span class="ahl-keyword ahl-operator">or</span> <span class="ahl-variable">M</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">_start</span>
  <span class="ahl-keyword">if</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">g</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">lazy_did_setup</span> <span class="ahl-keyword">then</span>
    <span class="ahl-keyword">return <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">notify</span><span class="ahl-function">(</span>
      <span class="ahl-string">&quot;Re-sourcing your config is not supported with lazy.nvim&quot;</span><span class="ahl-punctuation ahl-delimiter">,</span>
      <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">log</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">levels</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">WARN</span><span class="ahl-punctuation ahl-delimiter">,</span>
      <span class="ahl-punctuation ahl-bracket">{</span> <span class="ahl-variable">title</span> <span class="ahl-operator">=</span> <span class="ahl-string">&quot;lazy.nvim&quot;</span> <span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-function">)</span></span>
  <span class="ahl-keyword">end</span>
  <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">g</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">lazy_did_setup</span> <span class="ahl-operator">=</span> true
  <span class="ahl-keyword">if</span> <span class="ahl-keyword ahl-operator">not</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">go</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">loadplugins</span> <span class="ahl-keyword">then</span>
    <span class="ahl-keyword">return</span>
  <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">if</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">fn</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">has</span><span class="ahl-function">(</span><span class="ahl-string">&quot;nvim-0.8.0&quot;</span><span class="ahl-function">)</span> <span class="ahl-operator">~=</span> 1 <span class="ahl-keyword">then</span>
    <span class="ahl-keyword">return <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">notify</span><span class="ahl-function">(</span><span class="ahl-string">&quot;lazy.nvim requires Neovim &gt;= 0.8.0&quot;</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">log</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">levels</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">ERROR</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span> <span class="ahl-variable">title</span> <span class="ahl-operator">=</span> <span class="ahl-string">&quot;lazy.nvim&quot;</span> <span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-function">)</span></span>
  <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">if</span> <span class="ahl-keyword ahl-operator">not</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">pcall</span><span class="ahl-function">(</span><span class="ahl-variable">require</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string">&quot;ffi&quot;</span><span class="ahl-function">)</span> <span class="ahl-keyword ahl-operator">and</span> <span class="ahl-variable">jit</span> <span class="ahl-keyword ahl-operator">and</span> <span class="ahl-variable">jit</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">version</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">then</span>
    <span class="ahl-keyword">return <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">notify</span><span class="ahl-function">(</span><span class="ahl-string">&quot;lazy.nvim requires Neovim built with LuaJIT&quot;</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">log</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">levels</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">ERROR</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span> <span class="ahl-variable">title</span> <span class="ahl-operator">=</span> <span class="ahl-string">&quot;lazy.nvim&quot;</span> <span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-function">)</span></span>
  <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">local</span> <span class="ahl-variable">start</span> <span class="ahl-operator">=</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">uv</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">hrtime</span><span class="ahl-function">(</span><span class="ahl-function">)</span>

  <span class="ahl-comment">-- use the Neovim cache if available</span>
  <span class="ahl-keyword">if</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">loader</span> <span class="ahl-keyword ahl-operator">and</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">fn</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">has</span><span class="ahl-function">(</span><span class="ahl-string">&quot;nvim-0.9.1&quot;</span><span class="ahl-function">)</span> <span class="ahl-operator">==</span> 1 <span class="ahl-keyword">then</span>
    <span class="ahl-variable">package</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">loaded</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-string">&quot;lazy.core.cache&quot;</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">=</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">loader</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">local</span> <span class="ahl-variable">Cache</span> <span class="ahl-operator">=</span> <span class="ahl-variable">require</span><span class="ahl-function">(</span><span class="ahl-string">&quot;lazy.core.cache&quot;</span><span class="ahl-function">)</span>

  <span class="ahl-keyword">local</span> <span class="ahl-variable">enable_cache</span> <span class="ahl-operator">=</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">tbl_get</span><span class="ahl-function">(</span><span class="ahl-variable">opts</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string">&quot;performance&quot;</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string">&quot;cache&quot;</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string">&quot;enabled&quot;</span><span class="ahl-function">)</span> <span class="ahl-operator">~=</span> false
  <span class="ahl-comment">-- load module cache before anything else</span>
  <span class="ahl-keyword">if</span> <span class="ahl-variable">enable_cache</span> <span class="ahl-keyword">then</span>
    <span class="ahl-variable">Cache</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">enable</span><span class="ahl-function">(</span><span class="ahl-function">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">if</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">tbl_get</span><span class="ahl-function">(</span><span class="ahl-variable">opts</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string">&quot;profiling&quot;</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string">&quot;require&quot;</span><span class="ahl-function">)</span> <span class="ahl-keyword">then</span>
    <span class="ahl-variable">profile_require</span><span class="ahl-function">(</span><span class="ahl-function">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-variable">require</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-string">&quot;lazy.stats&quot;</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">track</span><span class="ahl-function">(</span><span class="ahl-string">&quot;LazyStart&quot;</span><span class="ahl-function">)</span>

  <span class="ahl-keyword">local</span> <span class="ahl-variable">Util</span> <span class="ahl-operator">=</span> <span class="ahl-variable">require</span><span class="ahl-function">(</span><span class="ahl-string">&quot;lazy.core.util&quot;</span><span class="ahl-function">)</span>
  <span class="ahl-keyword">local</span> <span class="ahl-variable">Config</span> <span class="ahl-operator">=</span> <span class="ahl-variable">require</span><span class="ahl-function">(</span><span class="ahl-string">&quot;lazy.core.config&quot;</span><span class="ahl-function">)</span>
  <span class="ahl-keyword">local</span> <span class="ahl-variable">Loader</span> <span class="ahl-operator">=</span> <span class="ahl-variable">require</span><span class="ahl-function">(</span><span class="ahl-string">&quot;lazy.core.loader&quot;</span><span class="ahl-function">)</span>

  <span class="ahl-variable">table</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">insert</span><span class="ahl-function">(</span><span class="ahl-variable">package</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">loaders</span><span class="ahl-punctuation ahl-delimiter">,</span> 3<span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">Loader</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">loader</span><span class="ahl-function">)</span>

  <span class="ahl-keyword">if</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">tbl_get</span><span class="ahl-function">(</span><span class="ahl-variable">opts</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string">&quot;profiling&quot;</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string">&quot;loader&quot;</span><span class="ahl-function">)</span> <span class="ahl-keyword">then</span>
    <span class="ahl-keyword">if</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">loader</span> <span class="ahl-keyword">then</span>
      <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">loader</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">_profile</span><span class="ahl-function">(</span><span class="ahl-punctuation ahl-bracket">{</span> <span class="ahl-variable">loaders</span> <span class="ahl-operator">=</span> true <span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-function">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-variable">Cache</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">_profile_loaders</span><span class="ahl-function">(</span><span class="ahl-function">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-variable">Util</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">track</span><span class="ahl-function">(</span><span class="ahl-punctuation ahl-bracket">{</span> <span class="ahl-variable">plugin</span> <span class="ahl-operator">=</span> <span class="ahl-string">&quot;lazy.nvim&quot;</span> <span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-function">)</span> <span class="ahl-comment">-- setup start</span>
  <span class="ahl-variable">Util</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">track</span><span class="ahl-function">(</span><span class="ahl-string">&quot;module&quot;</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">uv</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">hrtime</span><span class="ahl-function">(</span><span class="ahl-function">)</span> <span class="ahl-operator">-</span> <span class="ahl-variable">start</span><span class="ahl-function">)</span>

  <span class="ahl-comment">-- load config</span>
  <span class="ahl-variable">Util</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">track</span><span class="ahl-function">(</span><span class="ahl-string">&quot;config&quot;</span><span class="ahl-function">)</span>
  <span class="ahl-variable">Config</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">setup</span><span class="ahl-function">(</span><span class="ahl-variable">opts</span><span class="ahl-function">)</span>
  <span class="ahl-variable">Util</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">track</span><span class="ahl-function">(</span><span class="ahl-function">)</span>

  <span class="ahl-comment">-- setup loader and handlers</span>
  <span class="ahl-variable">Loader</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">setup</span><span class="ahl-function">(</span><span class="ahl-function">)</span>

  <span class="ahl-comment">-- correct time delta and loaded</span>
  <span class="ahl-keyword">local</span> <span class="ahl-variable">delta</span> <span class="ahl-operator">=</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">uv</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">hrtime</span><span class="ahl-function">(</span><span class="ahl-function">)</span> <span class="ahl-operator">-</span> <span class="ahl-variable">start</span>
  <span class="ahl-variable">Util</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">track</span><span class="ahl-function">(</span><span class="ahl-function">)</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">time</span> <span class="ahl-operator">=</span> <span class="ahl-variable">delta</span> <span class="ahl-comment">-- end setup</span>
  <span class="ahl-keyword">if</span> <span class="ahl-variable">Config</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">plugins</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-string">&quot;lazy.nvim&quot;</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-keyword">then</span>
    <span class="ahl-variable">Config</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">plugins</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-string">&quot;lazy.nvim&quot;</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">_</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">loaded</span> <span class="ahl-operator">=</span> <span class="ahl-punctuation ahl-bracket">{</span> <span class="ahl-variable">time</span> <span class="ahl-operator">=</span> <span class="ahl-variable">delta</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">source</span> <span class="ahl-operator">=</span> <span class="ahl-string">&quot;init.lua&quot;</span> <span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">-- load plugins with lazy=false or Plugin.init</span>
  <span class="ahl-variable">Loader</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">startup</span><span class="ahl-function">(</span><span class="ahl-function">)</span>

  <span class="ahl-comment">-- all done!</span>
  <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">api</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">nvim_exec_autocmds</span><span class="ahl-function">(</span><span class="ahl-string">&quot;User&quot;</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span> <span class="ahl-variable">pattern</span> <span class="ahl-operator">=</span> <span class="ahl-string">&quot;LazyDone&quot;</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">modeline</span> <span class="ahl-operator">=</span> false <span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-function">)</span>
  <span class="ahl-variable">require</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-string">&quot;lazy.stats&quot;</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">track</span><span class="ahl-function">(</span><span class="ahl-string">&quot;LazyDone&quot;</span><span class="ahl-function">)</span>
<span class="ahl-keyword ahl-function">end</span><span class="ahl-keyword ahl-function">

function</span> <span class="ahl-variable">M</span>.<span class="ahl-variable">stats</span>()
  <span class="ahl-keyword">return <span class="ahl-variable">require</span><span class="ahl-function">(</span><span class="ahl-string">&quot;lazy.stats&quot;</span><span class="ahl-function">)</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">stats</span><span class="ahl-function">(</span><span class="ahl-function">)</span></span>
<span class="ahl-keyword ahl-function">end</span><span class="ahl-keyword ahl-function">

function</span> <span class="ahl-variable">M</span>.<span class="ahl-variable">bootstrap</span>()
  <span class="ahl-keyword">local</span> <span class="ahl-variable">lazypath</span> <span class="ahl-operator">=</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">fn</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">stdpath</span><span class="ahl-function">(</span><span class="ahl-string">&quot;data&quot;</span><span class="ahl-function">)</span> <span class="ahl-operator">..</span> <span class="ahl-string">&quot;&#x2f;lazy&#x2f;lazy.nvim&quot;</span>
  <span class="ahl-keyword">if</span> <span class="ahl-keyword ahl-operator">not</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">uv</span> <span class="ahl-keyword ahl-operator">or</span> <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">loop</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">fs_stat</span><span class="ahl-function">(</span><span class="ahl-variable">lazypath</span><span class="ahl-function">)</span> <span class="ahl-keyword">then</span>
    <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">fn</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">system</span><span class="ahl-function">(</span><span class="ahl-punctuation ahl-bracket">{</span>
      <span class="ahl-string">&quot;git&quot;</span><span class="ahl-punctuation ahl-delimiter">,</span>
      <span class="ahl-string">&quot;clone&quot;</span><span class="ahl-punctuation ahl-delimiter">,</span>
      <span class="ahl-string">&quot;--filter=blob:none&quot;</span><span class="ahl-punctuation ahl-delimiter">,</span>
      <span class="ahl-string">&quot;https:&#x2f;&#x2f;github.com&#x2f;folke&#x2f;lazy.nvim.git&quot;</span><span class="ahl-punctuation ahl-delimiter">,</span>
      <span class="ahl-string">&quot;--branch=stable&quot;</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">-- latest stable release</span>
      <span class="ahl-variable">lazypath</span><span class="ahl-punctuation ahl-delimiter">,</span>
    <span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-function">)</span>
  <span class="ahl-keyword">end</span>
  <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">opt</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">rtp</span>:<span class="ahl-variable">prepend</span><span class="ahl-function">(</span><span class="ahl-variable">lazypath</span><span class="ahl-function">)</span>
<span class="ahl-keyword ahl-function">end</span><span class="ahl-comment">

---@return <span class="ahl-type"><span class="ahl-type">LazyPlugin</span>[]</span></span><span class="ahl-keyword ahl-function">
function</span> <span class="ahl-variable">M</span>.<span class="ahl-variable">plugins</span>()
  <span class="ahl-keyword">return <span class="ahl-variable">vim</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">tbl_values</span><span class="ahl-function">(</span><span class="ahl-variable">require</span><span class="ahl-function">(</span><span class="ahl-string">&quot;lazy.core.config&quot;</span><span class="ahl-function">)</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">plugins</span><span class="ahl-function">)</span></span>
<span class="ahl-keyword ahl-function">end</span><span class="ahl-variable">

setmetatable</span><span class="ahl-function">(</span><span class="ahl-variable">M</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span>
  <span class="ahl-variable">__index</span> <span class="ahl-operator">=</span> <span class="ahl-keyword ahl-function">function</span>(<span class="ahl-variable">_</span>, <span class="ahl-variable">key</span>)
    <span class="ahl-keyword">return <span class="ahl-keyword ahl-function">function</span>(<span class="ahl-constant">...</span>)
      <span class="ahl-keyword">return <span class="ahl-variable">require</span><span class="ahl-function">(</span><span class="ahl-string">&quot;lazy.view.commands&quot;</span><span class="ahl-function">)</span><span class="ahl-punctuation ahl-delimiter">.</span><span class="ahl-variable">commands</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">key</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-function">(</span><span class="ahl-constant">...</span><span class="ahl-function">)</span></span>
    <span class="ahl-keyword ahl-function">end</span></span>
  <span class="ahl-keyword ahl-function">end</span><span class="ahl-punctuation ahl-delimiter">,</span>
<span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-function">)</span><span class="ahl-keyword">

return <span class="ahl-variable">M</span></span>
</code></pre>
</body>
</html>
