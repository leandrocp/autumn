<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Autumn Sample - elixir - catppuccin_latte (inline)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap" rel="stylesheet">
  <style>
    * {
      font-family: 'JetBrains Mono', monospace;
      line-height: 1.5;
    }
    pre {
      font-size: 15px;
      margin: 20px;
      padding: 50px;
      border-radius: 10px;
    }
  </style>
  <style>
  /* catppuccin_latte */
pre.autumn-hl { background-color: #eff1f5; color: #4c4f69; }
.ahl-info { color: #04a5e5; }
.ahl-label { color: #209fb5; }
.ahl-markup.ahl-heading.ahl-marker { font-weight: bold; color: #fe640b; }
.ahl-markup.ahl-bold { font-weight: bold; }
.ahl-namespace { font-style: italic; color: #1e66f5; }
.ahl-keyword.ahl-control.ahl-conditional { font-style: italic; color: #8839ef; }
.ahl-markup.ahl-heading.ahl-1 { color: #7287fd; }
.ahl-constant.ahl-builtin { color: #fe640b; }
.ahl-markup.ahl-heading.ahl-6 { color: #179299; }
.ahl-attribute { color: #1e66f5; }
.ahl-type { color: #df8e1d; }
.ahl-diagnostic.ahl-warning { color: #df8e1d; }
.ahl-hint { color: #179299; }
.ahl-string.ahl-special { color: #1e66f5; }
.ahl-constant { color: #fe640b; }
.ahl-punctuation.ahl-special { color: #04a5e5; }
.ahl-warning { color: #df8e1d; }
.ahl-string.ahl-regexp { color: #fe640b; }
.ahl-variable { color: #4c4f69; }
.ahl-constructor { color: #209fb5; }
.ahl-markup.ahl-heading.ahl-2 { color: #8839ef; }
.ahl-keyword.ahl-storage.ahl-modifier.ahl-ref { color: #179299; }
.ahl-diagnostic.ahl-error { color: #d20f39; }
.ahl-diff.ahl-minus { color: #d20f39; }
.ahl-constant.ahl-character { color: #179299; }
.ahl-markup.ahl-raw { color: #dd7878; }
.ahl-tag { color: #8839ef; }
.ahl-comment { font-style: italic; color: #8c8fa1; }
.ahl-markup.ahl-link.ahl-text { color: #1e66f5; }
.ahl-punctuation { color: #7c7f93; }
.ahl-markup.ahl-italic { font-style: italic; }
.ahl-function.ahl-macro { color: #8839ef; }
.ahl-special { color: #1e66f5; }
.ahl-diff.ahl-plus { color: #40a02b; }
.ahl-operator { color: #04a5e5; }
.ahl-diagnostic.ahl-info { color: #04a5e5; }
.ahl-constant.ahl-character.ahl-escape { color: #ea76cb; }
.ahl-markup.ahl-link.ahl-url {  color: #dc8a78; }
.ahl-variable.ahl-builtin { color: #d20f39; }
.ahl-variable.ahl-parameter { font-style: italic; color: #e64553; }
.ahl-string { color: #40a02b; }
.ahl-diff.ahl-delta { color: #1e66f5; }
.ahl-keyword { color: #8839ef; }
.ahl-markup.ahl-heading.ahl-3 { color: #40a02b; }
.ahl-markup.ahl-heading.ahl-5 { color: #ea76cb; }
.ahl-markup.ahl-heading.ahl-4 { color: #df8e1d; }
.ahl-markup.ahl-list { color: #8839ef; }
.ahl-diagnostic.ahl-hint { color: #179299; }
.ahl-variable.ahl-other.ahl-member { color: #179299; }
.ahl-function { color: #1e66f5; }
.ahl-error { color: #d20f39; }

  </style>
</head>
<body>
  <pre class="autumn-hl"><code class="language-elixir" translate="no"><span class="ahl-keyword">defprotocol</span> <span class="ahl-namespace">Enumerable</span> <span class="ahl-keyword">do</span>
  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">moduledoc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Enumerable protocol used by `Enum` and `Stream` modules.

  When you invoke a function in the `Enum` module, the first argument
  is usually a collection that must implement this protocol.
  For example, the expression `Enum.map([1, 2, 3], &amp;(&amp;1 * 2))`
  invokes `Enumerable.reduce&#x2f;3` to perform the reducing operation that
  builds a mapped list by calling the mapping function `&amp;(&amp;1 * 2)` on
  every element in the collection and consuming the element with an
  accumulated list.

  Internally, `Enum.map&#x2f;2` is implemented as follows:

      def map(enumerable, fun) do
        reducer = fn x, acc -&gt; {:cont, [fun.(x) | acc]} end
        Enumerable.reduce(enumerable, {:cont, []}, reducer) |&gt; elem(1) |&gt; :lists.reverse()
      end

  Note that the user-supplied function is wrapped into a `t:reducer&#x2f;0` function.
  The `t:reducer&#x2f;0` function must return a tagged tuple after each step,
  as described in the `t:acc&#x2f;0` type. At the end, `Enumerable.reduce&#x2f;3`
  returns `t:result&#x2f;0`.

  This protocol uses tagged tuples to exchange information between the
  reducer function and the data type that implements the protocol. This
  allows enumeration of resources, such as files, to be done efficiently
  while also guaranteeing the resource will be closed at the end of the
  enumeration. This protocol also allows suspension of the enumeration,
  which is useful when interleaving between many enumerables is required
  (as in the `zip&#x2f;1` and `zip&#x2f;2` functions).

  This protocol requires four functions to be implemented, `reduce&#x2f;3`,
  `count&#x2f;1`, `member?&#x2f;2`, and `slice&#x2f;1`. The core of the protocol is the
  `reduce&#x2f;3` function. All other functions exist as optimizations paths
  for data structures that can implement certain properties in better
  than linear time.
  &quot;&quot;&quot;</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">typedoc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  An enumerable of elements of type `element`.

  This type is equivalent to `t:t&#x2f;0` but is especially useful for documentation.

  For example, imagine you define a function that expects an enumerable of
  integers and returns an enumerable of strings:

      @spec integers_to_strings(Enumerable.t(integer())) :: Enumerable.t(String.t())
      def integers_to_strings(integers) do
        Stream.map(integers, &amp;Integer.to_string&#x2f;1)
      end

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">typedoc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.14.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">type</span> <span class="ahl-function">t</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_element</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-function">t</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">typedoc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  The accumulator value for each step.

  It must be a tagged tuple with one of the following &quot;tags&quot;:

    * `:cont`    - the enumeration should continue
    * `:halt`    - the enumeration should halt immediately
    * `:suspend` - the enumeration should be suspended immediately

  Depending on the accumulator value, the result returned by
  `Enumerable.reduce&#x2f;3` will change. Please check the `t:result&#x2f;0`
  type documentation for more information.

  In case a `t:reducer&#x2f;0` function returns a `:suspend` accumulator,
  it must be explicitly handled by the caller and never leak.
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">type</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:suspend</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">}</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">typedoc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  The reducer function.

  Should be called with the `enumerable` element and the
  accumulator contents.

  Returns the accumulator for the next enumeration step.
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">type</span> <span class="ahl-variable">reducer</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">::</span> <span class="ahl-variable">term</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element_acc</span> <span class="ahl-operator">::</span> <span class="ahl-variable">term</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">typedoc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  The result of the reduce operation.

  It may be *done* when the enumeration is finished by reaching
  its end, or *halted*&#x2f;*suspended* when the enumeration was halted
  or suspended by the tagged accumulator.

  In case the tagged `:halt` accumulator is given, the `:halted` tuple
  with the accumulator must be returned. Functions like `Enum.take_while&#x2f;2`
  use `:halt` underneath and can be used to test halting enumerables.

  In case the tagged `:suspend` accumulator is given, the caller must
  return the `:suspended` tuple with the accumulator and a continuation.
  The caller is then responsible of managing the continuation and the
  caller must always call the continuation, eventually halting or continuing
  until the end. `Enum.zip&#x2f;2` uses suspension, so it can be used to test
  whether your implementation handles suspension correctly. You can also use
  `Stream.zip&#x2f;2` with `Enum.take_while&#x2f;2` to test the combination of
  `:suspend` with `:halt`.
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">type</span> <span class="ahl-variable">result</span> <span class="ahl-operator">::</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:done</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">}</span>
          <span class="ahl-operator">|</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halted</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">}</span>
          <span class="ahl-operator">|</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:suspended</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">term</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">continuation</span><span class="ahl-punctuation ahl-bracket">}</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">typedoc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  A partially applied reduce function.

  The continuation is the closure returned as a result when
  the enumeration is suspended. When invoked, it expects
  a new accumulator and it returns the result.

  A continuation can be trivially implemented as long as the reduce
  function is defined in a tail recursive fashion. If the function
  is tail recursive, all the state is passed as arguments, so
  the continuation is the reducing function partially applied.
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">type</span> <span class="ahl-variable">continuation</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">result</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">typedoc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  A slicing function that receives the initial position,
  the number of elements in the slice, and the step.

  The `start` position is a number `&gt;= 0` and guaranteed to
  exist in the `enumerable`. The length is a number `&gt;= 1`
  in a way that `start + length * step &lt;= count`, where
  `count` is the maximum amount of elements in the enumerable.

  The function should return a non empty list where
  the amount of elements is equal to `length`.
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">type</span> <span class="ahl-variable">slicing_fun</span> <span class="ahl-operator">::</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start</span> <span class="ahl-operator">::</span> <span class="ahl-variable">non_neg_integer</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">length</span> <span class="ahl-operator">::</span> <span class="ahl-variable">pos_integer</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span> <span class="ahl-operator">::</span> <span class="ahl-variable">pos_integer</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-function">term</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">typedoc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Receives an enumerable and returns a list.
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">type</span> <span class="ahl-variable">to_list_fun</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-function">term</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Reduces the `enumerable` into an element.

  Most of the operations in `Enum` are implemented in terms of reduce.
  This function should apply the given `t:reducer&#x2f;0` function to each
  element in the `enumerable` and proceed as expected by the returned
  accumulator.

  See the documentation of the types `t:result&#x2f;0` and `t:acc&#x2f;0` for
  more information.

  ## Examples

  As an example, here is the implementation of `reduce` for lists:

      def reduce(_list, {:halt, acc}, _fun), do: {:halted, acc}
      def reduce(list, {:suspend, acc}, fun), do: {:suspended, acc, &amp;reduce(list, &amp;1, fun)}
      def reduce([], {:cont, acc}, _fun), do: {:done, acc}
      def reduce([head | tail], {:cont, acc}, fun), do: reduce(tail, fun.(head, acc), fun)

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reducer</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">result</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Retrieves the number of elements in the `enumerable`.

  It should return `{:ok, count}` if you can count the number of elements
  in `enumerable` in a faster way than fully traversing it.

  Otherwise it should return `{:error, __MODULE__}` and a default algorithm
  built on top of `reduce&#x2f;3` that runs in linear time will be used.
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">non_neg_integer</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:error</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Checks if an `element` exists within the `enumerable`.

  It should return `{:ok, boolean}` if you can check the membership of a
  given element in `enumerable` with `===&#x2f;2` without traversing the whole
  of it.

  Otherwise it should return `{:error, __MODULE__}` and a default algorithm
  built on top of `reduce&#x2f;3` that runs in linear time will be used.

  When called outside guards, the [`in`](`in&#x2f;2`) and [`not in`](`in&#x2f;2`)
  operators work by using this function.
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">member?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">boolean</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:error</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">member?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns a function that slices the data structure contiguously.

  It should return either:

    * `{:ok, size, slicing_fun}` - if the `enumerable` has a known
      bound and can access a position in the `enumerable` without
      traversing all previous elements. The `slicing_fun` will receive
      a `start` position, the `amount` of elements to fetch, and a
      `step`.

    * `{:ok, size, to_list_fun}` - if the `enumerable` has a known bound
      and can access a position in the `enumerable` by first converting
      it to a list via `to_list_fun`.

    * `{:error, __MODULE__}` - the enumerable cannot be sliced efficiently
      and a default algorithm built on top of `reduce&#x2f;3` that runs in
      linear time will be used.

  ## Differences to `count&#x2f;1`

  The `size` value returned by this function is used for boundary checks,
  therefore it is extremely important that this function only returns `:ok`
  if retrieving the `size` of the `enumerable` is cheap, fast, and takes
  constant time. Otherwise the simplest of operations, such as
  `Enum.at(enumerable, 0)`, will become too expensive.

  On the other hand, the `count&#x2f;1` function in this protocol should be
  implemented whenever you can count the number of elements in the collection
  without traversing it.
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">size</span> <span class="ahl-operator">::</span> <span class="ahl-function">non_neg_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">slicing_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-function">to_list_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>
          <span class="ahl-operator">|</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:error</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">module</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
<span class="ahl-keyword">end</span>

<span class="ahl-keyword">defmodule</span> <span class="ahl-namespace">Enum</span> <span class="ahl-keyword">do</span>
  <span class="ahl-keyword">import</span> <span class="ahl-namespace">Kernel</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">except: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-string ahl-special ahl-symbol">max: </span><span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">min: </span><span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">moduledoc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Functions for working with collections (known as enumerables).

  In Elixir, an enumerable is any data type that implements the
  `Enumerable` protocol. `List`s (`[1, 2, 3]`), `Map`s (`%{foo: 1, bar: 2}`)
  and `Range`s (`1..3`) are common data types used as enumerables:

      iex&gt; Enum.map([1, 2, 3], fn x -&gt; x * 2 end)
      [2, 4, 6]

      iex&gt; Enum.sum([1, 2, 3])
      6

      iex&gt; Enum.map(1..3, fn x -&gt; x * 2 end)
      [2, 4, 6]

      iex&gt; Enum.sum(1..3)
      6

      iex&gt; map = %{&quot;a&quot; =&gt; 1, &quot;b&quot; =&gt; 2}
      iex&gt; Enum.map(map, fn {k, v} -&gt; {k, v * 2} end)
      [{&quot;a&quot;, 2}, {&quot;b&quot;, 4}]

  Many other enumerables exist in the language, such as `MapSet`s
  and the data type returned by `File.stream!&#x2f;3` which allows a file to be
  traversed as if it was an enumerable.

  For a general overview of all functions in the `Enum` module, see
  [the `Enum` cheatsheet](enum-cheat.cheatmd).

  The functions in this module work in linear time. This means that, the
  time it takes to perform an operation grows at the same rate as the length
  of the enumerable. This is expected on operations such as `Enum.map&#x2f;2`.
  After all, if we want to traverse every element on a list, the longer the
  list, the more elements we need to traverse, and the longer it will take.

  This linear behavior should also be expected on operations like `count&#x2f;1`,
  `member?&#x2f;2`, `at&#x2f;2` and similar. While Elixir does allow data types to
  provide performant variants for such operations, you should not expect it
  to always be available, since the `Enum` module is meant to work with a
  large variety of data types and not all data types can provide optimized
  behavior.

  Finally, note the functions in the `Enum` module are eager: they will
  traverse the enumerable as soon as they are invoked. This is particularly
  dangerous when working with infinite enumerables. In such cases, you should
  use the `Stream` module, which allows you to lazily express computations,
  without traversing collections, and work with possibly infinite collections.
  See the `Stream` module for examples and documentation.
  &quot;&quot;&quot;</span>

  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">compile</span> <span class="ahl-string ahl-special ahl-symbol">:inline_list_funcs</span>

  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">type</span> <span class="ahl-variable">t</span> <span class="ahl-operator">::</span> <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">t</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">type</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">::</span> <span class="ahl-variable">any</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">type</span> <span class="ahl-variable">element</span> <span class="ahl-operator">::</span> <span class="ahl-variable">any</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">typedoc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;Zero-based index. It can also be a negative integer.&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">type</span> <span class="ahl-variable">index</span> <span class="ahl-operator">::</span> <span class="ahl-variable">integer</span>

  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">type</span> <span class="ahl-variable">default</span> <span class="ahl-operator">::</span> <span class="ahl-variable">any</span>

  <span class="ahl-keyword">require</span> <span class="ahl-namespace">Stream.Reducers</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">as: </span><span class="ahl-namespace">R</span>

  <span class="ahl-keyword">defmacrop</span> <span class="ahl-function">skip</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">acc</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defmacrop</span> <span class="ahl-function">next</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">quote</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-keyword">unquote</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-keyword">unquote</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defmacrop</span> <span class="ahl-function">acc</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">state</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">quote</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-keyword">unquote</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">unquote</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">state</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defmacrop</span> <span class="ahl-function">next_with_acc</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">head</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">state</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">quote</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-keyword">unquote</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-keyword">unquote</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">unquote</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">state</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns `true` if all elements in `enumerable` are truthy.

  When an element has a falsy value (`false` or `nil`) iteration stops immediately
  and `false` is returned. In all other cases `true` is returned.

  ## Examples

      iex&gt; Enum.all?([1, 2, 3])
      true

      iex&gt; Enum.all?([1, nil, 3])
      false

      iex&gt; Enum.all?([])
      true

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">all?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">boolean</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">all?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">all_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">all?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-keyword">if</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">else: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns `true` if `fun.(element)` is truthy for all elements in `enumerable`.

  Iterates over `enumerable` and invokes `fun` on each element. If `fun` ever
  returns a falsy value (`false` or `nil`), iteration stops immediately and
  `false` is returned. Otherwise, `true` is returned.

  ## Examples

      iex&gt; Enum.all?([2, 4, 6], fn x -&gt; rem(x, 2) == 0 end)
      true

      iex&gt; Enum.all?([2, 3, 4], fn x -&gt; rem(x, 2) == 0 end)
      false

      iex&gt; Enum.all?([], fn _ -&gt; nil end)
      true

  As the last example shows, `Enum.all?&#x2f;2` returns `true` if `enumerable` is
  empty, regardless of `fun`. In an empty enumerable there is no element for
  which `fun` returns a falsy value, so the result must be `true`. This is a
  well-defined logical argument for empty collections.

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">all?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-function">as_boolean</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">boolean</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">all?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">predicate_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">all?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-operator">..</span><span class="ahl-variable">last</span><span class="ahl-operator">&#x2f;&#x2f;</span><span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">predicate_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">all?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-keyword">if</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">else: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns `true` if at least one element in `enumerable` is truthy.

  When an element has a truthy value (neither `false` nor `nil`) iteration stops
  immediately and `true` is returned. In all other cases `false` is returned.

  ## Examples

      iex&gt; Enum.any?([false, false, false])
      false

      iex&gt; Enum.any?([false, true, false])
      true

      iex&gt; Enum.any?([])
      false

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">any?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">boolean</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">any?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">any_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">any?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-keyword">if</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">else: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns `true` if `fun.(element)` is truthy for at least one element in `enumerable`.

  Iterates over the `enumerable` and invokes `fun` on each element. When an invocation
  of `fun` returns a truthy value (neither `false` nor `nil`) iteration stops
  immediately and `true` is returned. In all other cases `false` is returned.

  ## Examples

      iex&gt; Enum.any?([2, 4, 6], fn x -&gt; rem(x, 2) == 1 end)
      false

      iex&gt; Enum.any?([2, 3, 4], fn x -&gt; rem(x, 2) == 1 end)
      true

      iex&gt; Enum.any?([], fn x -&gt; x &gt; 0 end)
      false

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">any?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-function">as_boolean</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">boolean</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">any?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">predicate_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">any?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-operator">..</span><span class="ahl-variable">last</span><span class="ahl-operator">&#x2f;&#x2f;</span><span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">predicate_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">any?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-keyword">if</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">else: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Finds the element at the given `index` (zero-based).

  Returns `default` if `index` is out of bounds.

  A negative `index` can be passed, which means the `enumerable` is
  enumerated once and the `index` is counted from the end (for example,
  `-1` finds the last element).

  ## Examples

      iex&gt; Enum.at([2, 4, 6], 0)
      2

      iex&gt; Enum.at([2, 4, 6], 2)
      6

      iex&gt; Enum.at([2, 4, 6], 4)
      nil

      iex&gt; Enum.at([2, 4, 6], 4, :none)
      :none

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">at</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">element</span> <span class="ahl-operator">|</span> <span class="ahl-variable">default</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">at</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span> <span class="ahl-operator">\\</span> <span class="ahl-constant ahl-builtin">nil</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">index</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">case</span> <span class="ahl-function">slice_forward</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">value</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">value</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">default</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">false</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">deprecated</span> <span class="ahl-string">&quot;Use Enum.chunk_every&#x2f;2 instead&quot;</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">chunk</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">chunk</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin">nil</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">false</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">deprecated</span> <span class="ahl-string">&quot;Use Enum.chunk_every&#x2f;3 instead&quot;</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">chunk</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enum</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">n</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">chunk_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enum</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">n</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:discard</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">false</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">deprecated</span> <span class="ahl-string">&quot;Use Enum.chunk_every&#x2f;4 instead&quot;</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">chunk</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">leftover</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">chunk_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">leftover</span> <span class="ahl-operator">||</span> <span class="ahl-string ahl-special ahl-symbol">:discard</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Shortcut to `chunk_every(enumerable, count, count)`.
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.5.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">chunk_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">pos_integer</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">chunk_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">chunk_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns list of lists containing `count` elements each, where
  each new chunk starts `step` elements into the `enumerable`.

  `step` is optional and, if not passed, defaults to `count`, i.e.
  chunks do not overlap. Chunking will stop as soon as the collection
  ends or when we emit an incomplete chunk.

  If the last chunk does not have `count` elements to fill the chunk,
  elements are taken from `leftover` to fill in the chunk. If `leftover`
  does not have enough elements to fill the chunk, then a partial chunk
  is returned with less than `count` elements.

  If `:discard` is given in `leftover`, the last chunk is discarded
  unless it has exactly `count` elements.

  ## Examples

      iex&gt; Enum.chunk_every([1, 2, 3, 4, 5, 6], 2)
      [[1, 2], [3, 4], [5, 6]]

      iex&gt; Enum.chunk_every([1, 2, 3, 4, 5, 6], 3, 2, :discard)
      [[1, 2, 3], [3, 4, 5]]

      iex&gt; Enum.chunk_every([1, 2, 3, 4, 5, 6], 3, 2, [7])
      [[1, 2, 3], [3, 4, 5], [5, 6, 7]]

      iex&gt; Enum.chunk_every([1, 2, 3, 4], 3, 3, [])
      [[1, 2, 3], [4]]

      iex&gt; Enum.chunk_every([1, 2, 3, 4], 10)
      [[1, 2, 3, 4]]

      iex&gt; Enum.chunk_every([1, 2, 3, 4, 5], 2, 3, [])
      [[1, 2], [4, 5]]

      iex&gt; Enum.chunk_every([1, 2, 3, 4], 3, 3, Stream.cycle([0]))
      [[1, 2, 3], [4, 0, 0]]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.5.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">chunk_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">pos_integer</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">pos_integer</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t</span> <span class="ahl-operator">|</span> <span class="ahl-string ahl-special ahl-symbol">:discard</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">chunk_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">leftover</span> <span class="ahl-operator">\\</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">count</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">step</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">R</span><span class="ahl-operator">.</span><span class="ahl-function">chunk_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-function">chunk_while</span><span class="ahl-operator">&#x2f;</span><span class="ahl-operator">4</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">leftover</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Chunks the `enumerable` with fine grained control when every chunk is emitted.

  `chunk_fun` receives the current element and the accumulator and must return:

    * `{:cont, chunk, acc}` to emit a chunk and continue with the accumulator
    * `{:cont, acc}` to not emit any chunk and continue with the accumulator
    * `{:halt, acc}` to halt chunking over the `enumerable`.

  `after_fun` is invoked with the final accumulator when iteration is
  finished (or `halt`ed) to handle any trailing elements that were returned
  as part of an accumulator, but were not emitted as a chunk by `chunk_fun`.
  It must return:

    * `{:cont, chunk, acc}` to emit a chunk. The chunk will be appended to the
      list of already emitted chunks.
    * `{:cont, acc}` to not emit a chunk

  The `acc` in `after_fun` is required in order to mirror the tuple format
  from `chunk_fun` but it will be discarded since the traversal is complete.

  Returns a list of emitted chunks.

  ## Examples

      iex&gt; chunk_fun = fn element, acc -&gt;
      ...&gt;   if rem(element, 2) == 0 do
      ...&gt;     {:cont, Enum.reverse([element | acc]), []}
      ...&gt;   else
      ...&gt;     {:cont, [element | acc]}
      ...&gt;   end
      ...&gt; end
      iex&gt; after_fun = fn
      ...&gt;   [] -&gt; {:cont, []}
      ...&gt;   acc -&gt; {:cont, Enum.reverse(acc), []}
      ...&gt; end
      iex&gt; Enum.chunk_while(1..10, [], chunk_fun, after_fun)
      [[1, 2], [3, 4], [5, 6], [7, 8], [9, 10]]
      iex&gt; Enum.chunk_while([1, 2, 3, 5, 7], [], chunk_fun, after_fun)
      [[1, 2], [3, 5, 7]]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.5.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">chunk_while</span><span class="ahl-punctuation ahl-bracket">(</span>
          <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">chunk</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">chunk</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">t</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">chunk: </span><span class="ahl-variable">any</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">chunk_while</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">chunk_fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">after_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">res</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span>
      <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">buffer</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-keyword">case</span> <span class="ahl-variable">chunk_fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">chunk</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">chunk</span> <span class="ahl-operator">|</span> <span class="ahl-variable">buffer</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">buffer</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">buffer</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">end</span>
      <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-keyword">case</span> <span class="ahl-variable">after_fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">res</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">chunk</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">chunk</span> <span class="ahl-operator">|</span> <span class="ahl-variable">res</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Splits enumerable on every element for which `fun` returns a new
  value.

  Returns a list of lists.

  ## Examples

      iex&gt; Enum.chunk_by([1, 2, 2, 3, 4, 4, 6, 7, 7], &amp;(rem(&amp;1, 2) == 1))
      [[1], [2, 2], [3], [4, 4, 6], [7, 7]]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">chunk_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">chunk_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">R</span><span class="ahl-operator">.</span><span class="ahl-function">chunk_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-function">chunk_while</span><span class="ahl-operator">&#x2f;</span><span class="ahl-operator">4</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Given an enumerable of enumerables, concatenates the `enumerables` into
  a single list.

  ## Examples

      iex&gt; Enum.concat([1..3, 4..6, 7..9])
      [1, 2, 3, 4, 5, 6, 7, 8, 9]

      iex&gt; Enum.concat([[1, [2], 3], [4], [5, 6]])
      [1, [2], 3, 4, 5, 6]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">concat</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">t</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">concat</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerables</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">concat</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">concat_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">concat</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enums</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">concat_enum</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enums</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Concatenates the enumerable on the `right` with the enumerable on the
  `left`.

  This function produces the same result as the `++&#x2f;2` operator
  for lists.

  ## Examples

      iex&gt; Enum.concat(1..3, 4..6)
      [1, 2, 3, 4, 5, 6]

      iex&gt; Enum.concat([1, 2, 3], [4, 5, 6])
      [1, 2, 3, 4, 5, 6]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">concat</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">t</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">concat</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">left</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">right</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">left</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">right</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">left</span> <span class="ahl-operator">++</span> <span class="ahl-variable">right</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">concat</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">left</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">right</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">concat_enum</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">left</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">right</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns the size of the `enumerable`.

  ## Examples

      iex&gt; Enum.count([1, 2, 3])
      3

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">non_neg_integer</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">length</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">case</span> <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">value</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">value</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">value</span>

      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:error</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">enumerable</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-variable">module</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns the count of elements in the `enumerable` for which `fun` returns
  a truthy value.

  ## Examples

      iex&gt; Enum.count([1, 2, 3, 4, 5], fn x -&gt; rem(x, 2) == 0 end)
      2

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-function">as_boolean</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">non_neg_integer</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-keyword">if</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">acc</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">else: </span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Counts the enumerable stopping at `limit`.

  This is useful for checking certain properties of the count of an enumerable
  without having to actually count the entire enumerable. For example, if you
  wanted to check that the count was exactly, at least, or more than a value.

  If the enumerable implements `c:Enumerable.count&#x2f;1`, the enumerable is
  not traversed and we return the lower of the two numbers. To force
  enumeration, use `count_until&#x2f;3` with `fn _ -&gt; true end` as the second
  argument.

  ## Examples

      iex&gt; Enum.count_until(1..20, 5)
      5
      iex&gt; Enum.count_until(1..20, 50)
      20
      iex&gt; Enum.count_until(1..10, 10) == 10 # At least 10
      true
      iex&gt; Enum.count_until(1..11, 10 + 1) &gt; 10 # More than 10
      true
      iex&gt; Enum.count_until(1..5, 10) &lt; 10 # Less than 10
      true
      iex&gt; Enum.count_until(1..10, 10 + 1) == 10 # Exactly ten
      true

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.12.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">count_until</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">pos_integer</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">non_neg_integer</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">count_until</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">limit</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">limit</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">limit</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">stop_at</span> <span class="ahl-operator">=</span> <span class="ahl-variable">limit</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span>

    <span class="ahl-keyword">case</span> <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">value</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">value</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">limit</span><span class="ahl-punctuation ahl-bracket">)</span>

      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:error</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">enumerable</span>
        <span class="ahl-operator">|&gt;</span> <span class="ahl-variable">module</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-keyword">fn</span>
            <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">^</span><span class="ahl-variable">stop_at</span> <span class="ahl-operator">-&gt;</span>
              <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">limit</span><span class="ahl-punctuation ahl-bracket">}</span>

            <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span>
              <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">}</span>
          <span class="ahl-keyword">end</span>
        <span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Counts the elements in the enumerable for which `fun` returns a truthy value, stopping at `limit`.

  See `count&#x2f;2` and `count_until&#x2f;2` for more information.

  ## Examples

      iex&gt; Enum.count_until(1..20, fn x -&gt; rem(x, 2) == 0 end, 7)
      7
      iex&gt; Enum.count_until(1..20, fn x -&gt; rem(x, 2) == 0 end, 11)
      10
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.12.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">count_until</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-function">as_boolean</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">pos_integer</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">non_neg_integer</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">count_until</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">limit</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">limit</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">limit</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">stop_at</span> <span class="ahl-operator">=</span> <span class="ahl-variable">limit</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span>

    <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span>
      <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">^</span><span class="ahl-variable">stop_at</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-keyword">if</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">limit</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">else</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">stop_at</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">end</span>

      <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-keyword">if</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">else</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">end</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Enumerates the `enumerable`, returning a list where all consecutive
  duplicate elements are collapsed to a single element.

  Elements are compared using `===&#x2f;2`.

  If you want to remove all duplicate elements, regardless of order,
  see `uniq&#x2f;1`.

  ## Examples

      iex&gt; Enum.dedup([1, 2, 3, 3, 2, 1])
      [1, 2, 3, 2, 1]

      iex&gt; Enum.dedup([1, 1, 2, 2.0, :three, :three])
      [1, 2, 2.0, :three]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">dedup</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">dedup</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">dedup_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">dedup</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">Enum</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-keyword">case</span> <span class="ahl-variable">acc</span> <span class="ahl-keyword">do</span>
        <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-operator">^</span><span class="ahl-variable">x</span> <span class="ahl-operator">|</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">acc</span>
        <span class="ahl-comment">_</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">x</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span>
      <span class="ahl-keyword">end</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Enumerates the `enumerable`, returning a list where all consecutive
  duplicate elements are collapsed to a single element.

  The function `fun` maps every element to a term which is used to
  determine if two elements are duplicates.

  ## Examples

      iex&gt; Enum.dedup_by([{1, :a}, {2, :b}, {2, :c}, {1, :a}], fn {x, _} -&gt; x end)
      [{1, :a}, {2, :b}, {1, :a}]

      iex&gt; Enum.dedup_by([5, 1, 2, 3, 2, 1], fn x -&gt; x &gt; 2 end)
      [5, 1, 3, 2]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">dedup_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">dedup_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">R</span><span class="ahl-operator">.</span><span class="ahl-function">dedup</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Drops the `amount` of elements from the `enumerable`.

  If a negative `amount` is given, the `amount` of last values will be dropped.
  The `enumerable` will be enumerated once to retrieve the proper index and
  the remaining calculation is performed from the end.

  ## Examples

      iex&gt; Enum.drop([1, 2, 3], 2)
      [3]

      iex&gt; Enum.drop([1, 2, 3], 10)
      []

      iex&gt; Enum.drop([1, 2, 3], 0)
      [1, 2, 3]

      iex&gt; Enum.drop([1, 2, 3], -1)
      [1, 2]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">drop</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">integer</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">drop</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">drop_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">drop</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">drop</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">result</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">R</span><span class="ahl-operator">.</span><span class="ahl-function">drop</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">if</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">result</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">result</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">else: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">drop</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">&lt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">slice_count_and_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-variable">amount</span> <span class="ahl-operator">=</span> <span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span> <span class="ahl-operator">+</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-keyword">if</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
      <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns a list of every `nth` element in the `enumerable` dropped,
  starting with the first element.

  The first element is always dropped, unless `nth` is 0.

  The second argument specifying every `nth` element must be a non-negative
  integer.

  ## Examples

      iex&gt; Enum.drop_every(1..10, 2)
      [2, 4, 6, 8, 10]

      iex&gt; Enum.drop_every(1..10, 0)
      [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

      iex&gt; Enum.drop_every([1, 2, 3], 1)
      []

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">drop_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">non_neg_integer</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">drop_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">drop_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">drop_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">drop_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">drop_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">nth</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">1</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">res</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:first</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">R</span><span class="ahl-operator">.</span><span class="ahl-function">drop_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">res</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Drops elements at the beginning of the `enumerable` while `fun` returns a
  truthy value.

  ## Examples

      iex&gt; Enum.drop_while([1, 2, 3, 2, 1], fn x -&gt; x &lt; 3 end)
      [3, 2, 1]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">drop_while</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-function">as_boolean</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">drop_while</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">drop_while_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">drop_while</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">res</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">R</span><span class="ahl-operator">.</span><span class="ahl-function">drop_while</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">res</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Invokes the given `fun` for each element in the `enumerable`.

  Returns `:ok`.

  ## Examples

      Enum.each([&quot;some&quot;, &quot;example&quot;], fn x -&gt; IO.puts(x) end)
      &quot;some&quot;
      &quot;example&quot;
      #=&gt; :ok

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">each</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-string ahl-special ahl-symbol">:ok</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">each</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">foreach</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">each</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin">nil</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-constant ahl-builtin">nil</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-string ahl-special ahl-symbol">:ok</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Determines if the `enumerable` is empty.

  Returns `true` if `enumerable` is empty, otherwise `false`.

  ## Examples

      iex&gt; Enum.empty?([])
      true

      iex&gt; Enum.empty?([1, 2, 3])
      false

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">empty?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">boolean</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">empty?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">enumerable</span> <span class="ahl-operator">==</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">empty?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">case</span> <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">value</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">value</span> <span class="ahl-operator">==</span> <span class="ahl-constant ahl-numeric integer">0</span>

      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:error</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">enumerable</span>
        <span class="ahl-operator">|&gt;</span> <span class="ahl-variable">module</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Finds the element at the given `index` (zero-based).

  Returns `{:ok, element}` if found, otherwise `:error`.

  A negative `index` can be passed, which means the `enumerable` is
  enumerated once and the `index` is counted from the end (for example,
  `-1` fetches the last element).

  ## Examples

      iex&gt; Enum.fetch([2, 4, 6], 0)
      {:ok, 2}

      iex&gt; Enum.fetch([2, 4, 6], -3)
      {:ok, 2}

      iex&gt; Enum.fetch([2, 4, 6], 2)
      {:ok, 6}

      iex&gt; Enum.fetch([2, 4, 6], 4)
      :error

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">fetch</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">index</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-string ahl-special ahl-symbol">:error</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">fetch</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">index</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">index</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">case</span> <span class="ahl-function">slice_forward</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">value</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">value</span><span class="ahl-punctuation ahl-bracket">}</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-string ahl-special ahl-symbol">:error</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Finds the element at the given `index` (zero-based).

  Raises `OutOfBoundsError` if the given `index` is outside the range of
  the `enumerable`.

  ## Examples

      iex&gt; Enum.fetch!([2, 4, 6], 0)
      2

      iex&gt; Enum.fetch!([2, 4, 6], 2)
      6

      iex&gt; Enum.fetch!([2, 4, 6], 4)
      ** (Enum.OutOfBoundsError) out of bounds error

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">fetch!</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">index</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">element</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">fetch!</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">index</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">index</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">case</span> <span class="ahl-function">slice_forward</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">value</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">value</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-keyword">raise</span> <span class="ahl-namespace">Enum.OutOfBoundsError</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Filters the `enumerable`, i.e. returns only those elements
  for which `fun` returns a truthy value.

  See also `reject&#x2f;2` which discards all elements where the
  function returns a truthy value.

  ## Examples

      iex&gt; Enum.filter([1, 2, 3], fn x -&gt; rem(x, 2) == 0 end)
      [2]
      iex&gt; Enum.filter([&quot;apple&quot;, &quot;pear&quot;, &quot;banana&quot;], fn fruit -&gt; String.contains?(fruit, &quot;a&quot;) end)
      [&quot;apple&quot;, &quot;pear&quot;, &quot;banana&quot;]
      iex&gt; Enum.filter([4, 21, 24, 904], fn seconds -&gt; seconds &gt; 1000 end)
      []

  Keep in mind that `filter` is not capable of filtering and
  transforming an element at the same time. If you would like
  to do so, consider using `flat_map&#x2f;2`. For example, if you
  want to convert all strings that represent an integer and
  discard the invalid one in one pass:

      strings = [&quot;1234&quot;, &quot;abc&quot;, &quot;12ab&quot;]

      Enum.flat_map(strings, fn string -&gt;
        case Integer.parse(string) do
          # transform to integer
          {int, _rest} -&gt; [int]
          # skip the value
          :error -&gt; []
        end
      end)

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">filter</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-function">as_boolean</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">filter</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">filter_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">filter</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">R</span><span class="ahl-operator">.</span><span class="ahl-function">filter</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">false</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">deprecated</span> <span class="ahl-string">&quot;Use Enum.filter&#x2f;2 + Enum.map&#x2f;2 or for comprehensions instead&quot;</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">filter_map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">filter</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">mapper</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">for</span> <span class="ahl-variable">element</span> <span class="ahl-operator">&lt;-</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">filter</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">mapper</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">filter_map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">filter</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">mapper</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">enumerable</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">R</span><span class="ahl-operator">.</span><span class="ahl-function">filter_map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">filter</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">mapper</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns the first element for which `fun` returns a truthy value.
  If no such element is found, returns `default`.

  ## Examples

      iex&gt; Enum.find([2, 3, 4], fn x -&gt; rem(x, 2) == 1 end)
      3

      iex&gt; Enum.find([2, 4, 6], fn x -&gt; rem(x, 2) == 1 end)
      nil
      iex&gt; Enum.find([2, 4, 6], 0, fn x -&gt; rem(x, 2) == 1 end)
      0

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">find</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">element</span> <span class="ahl-operator">|</span> <span class="ahl-variable">default</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">find</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span> <span class="ahl-operator">\\</span> <span class="ahl-constant ahl-builtin">nil</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">find</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">find_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">find</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-keyword">if</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">else: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Similar to `find&#x2f;3`, but returns the index (zero-based)
  of the element instead of the element itself.

  ## Examples

      iex&gt; Enum.find_index([2, 4, 6], fn x -&gt; rem(x, 2) == 1 end)
      nil

      iex&gt; Enum.find_index([2, 3, 4], fn x -&gt; rem(x, 2) == 1 end)
      1

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">find_index</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">non_neg_integer</span> <span class="ahl-operator">|</span> <span class="ahl-constant ahl-builtin">nil</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">find_index</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">find_index_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">find_index</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">result</span> <span class="ahl-operator">=</span>
      <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:not_found</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">index</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-keyword">if</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:found</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">index</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">else: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:not_found</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">index</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>
      <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-keyword">case</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">result</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:found</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">index</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">index</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:not_found</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-constant ahl-builtin">nil</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Similar to `find&#x2f;3`, but returns the value of the function
  invocation instead of the element itself.

  The return value is considered to be found when the result is truthy
  (neither `nil` nor `false`).

  ## Examples

      iex&gt; Enum.find_value([2, 3, 4], fn x -&gt;
      ...&gt;   if x &gt; 2, do: x * x
      ...&gt; end)
      9

      iex&gt; Enum.find_value([2, 4, 6], fn x -&gt; rem(x, 2) == 1 end)
      nil

      iex&gt; Enum.find_value([2, 3, 4], fn x -&gt; rem(x, 2) == 1 end)
      true

      iex&gt; Enum.find_value([1, 2, 3], &quot;no bools!&quot;, &amp;is_boolean&#x2f;1)
      &quot;no bools!&quot;

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">find_value</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">found_value</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">found_value</span> <span class="ahl-operator">|</span> <span class="ahl-variable">default</span>
        <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">found_value: </span><span class="ahl-variable">term</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">find_value</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span> <span class="ahl-operator">\\</span> <span class="ahl-constant ahl-builtin">nil</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">find_value</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">find_value_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">find_value</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-variable">fun_entry</span> <span class="ahl-operator">=</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">if</span> <span class="ahl-variable">fun_entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun_entry</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">else: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Maps the given `fun` over `enumerable` and flattens the result.

  This function returns a new enumerable built by appending the result of invoking `fun`
  on each element of `enumerable` together; conceptually, this is similar to a
  combination of `map&#x2f;2` and `concat&#x2f;1`.

  ## Examples

      iex&gt; Enum.flat_map([:a, :b, :c], fn x -&gt; [x, x] end)
      [:a, :a, :b, :b, :c, :c]

      iex&gt; Enum.flat_map([{1, 3}, {4, 6}], fn {x, y} -&gt; x..y end)
      [1, 2, 3, 4, 5, 6]

      iex&gt; Enum.flat_map([:a, :b, :c], fn x -&gt; [[x]] end)
      [[:a], [:b], [:c]]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">flat_map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">flat_map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">flat_map_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">flat_map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-keyword">case</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
        <span class="ahl-variable">list</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">list</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span>
        <span class="ahl-variable">other</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">other</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span>
      <span class="ahl-keyword">end</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">flat_reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">flat_reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">flat_reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">h</span> <span class="ahl-operator">++</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">flat_reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">acc</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Maps and reduces an `enumerable`, flattening the given results (only one level deep).

  It expects an accumulator and a function that receives each enumerable
  element, and must return a tuple containing a new enumerable (often a list)
  with the new accumulator or a tuple with `:halt` as first element and
  the accumulator as second.

  ## Examples

      iex&gt; enumerable = 1..100
      iex&gt; n = 3
      iex&gt; Enum.flat_map_reduce(enumerable, 0, fn x, acc -&gt;
      ...&gt;   if acc &lt; n, do: {[x], acc + 1}, else: {:halt, acc}
      ...&gt; end)
      {[1, 2, 3], 3}

      iex&gt; Enum.flat_map_reduce(1..5, 0, fn x, acc -&gt; {[[x]], acc + x} end)
      {[[1], [2], [3], [4], [5]], 15}

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">flat_map_reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">fun: </span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">flat_map_reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span>
      <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-keyword">case</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
            <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>

          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
            <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>

          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
            <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>

          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">entries</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
            <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entries</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span> <span class="ahl-operator">|</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">end</span>
      <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns a map with keys as unique elements of `enumerable` and values
  as the count of every element.

  ## Examples

      iex&gt; Enum.frequencies(~w{ant buffalo ant ant buffalo dingo})
      %{&quot;ant&quot; =&gt; 3, &quot;buffalo&quot; =&gt; 2, &quot;dingo&quot; =&gt; 1}

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.10.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">frequencies</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">map</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">frequencies</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">key</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-keyword">case</span> <span class="ahl-variable">acc</span> <span class="ahl-keyword">do</span>
        <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-operator">^</span><span class="ahl-variable">key</span> <span class="ahl-operator">=&gt;</span> <span class="ahl-variable">value</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">acc</span> <span class="ahl-operator">|</span> <span class="ahl-variable">key</span> <span class="ahl-operator">=&gt;</span> <span class="ahl-variable">value</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-namespace">Map</span><span class="ahl-operator">.</span><span class="ahl-function">put</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">key</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">end</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns a map with keys as unique elements given by `key_fun` and values
  as the count of every element.

  ## Examples

      iex&gt; Enum.frequencies_by(~w{aa aA bb cc}, &amp;String.downcase&#x2f;1)
      %{&quot;aa&quot; =&gt; 2, &quot;bb&quot; =&gt; 1, &quot;cc&quot; =&gt; 1}

      iex&gt; Enum.frequencies_by(~w{aaa aA bbb cc c}, &amp;String.length&#x2f;1)
      %{3 =&gt; 2, 2 =&gt; 2, 1 =&gt; 1}

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.10.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">frequencies_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">map</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">frequencies_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">key_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">key_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-variable">key</span> <span class="ahl-operator">=</span> <span class="ahl-variable">key_fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span>

      <span class="ahl-keyword">case</span> <span class="ahl-variable">acc</span> <span class="ahl-keyword">do</span>
        <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-operator">^</span><span class="ahl-variable">key</span> <span class="ahl-operator">=&gt;</span> <span class="ahl-variable">value</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">acc</span> <span class="ahl-operator">|</span> <span class="ahl-variable">key</span> <span class="ahl-operator">=&gt;</span> <span class="ahl-variable">value</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-namespace">Map</span><span class="ahl-operator">.</span><span class="ahl-function">put</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">key</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">end</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Splits the `enumerable` into groups based on `key_fun`.

  The result is a map where each key is given by `key_fun`
  and each value is a list of elements given by `value_fun`.
  The order of elements within each list is preserved from the `enumerable`.
  However, like all maps, the resulting map is unordered.

  ## Examples

      iex&gt; Enum.group_by(~w{ant buffalo cat dingo}, &amp;String.length&#x2f;1)
      %{3 =&gt; [&quot;ant&quot;, &quot;cat&quot;], 5 =&gt; [&quot;dingo&quot;], 7 =&gt; [&quot;buffalo&quot;]}

      iex&gt; Enum.group_by(~w{ant buffalo cat dingo}, &amp;String.length&#x2f;1, &amp;String.first&#x2f;1)
      %{3 =&gt; [&quot;a&quot;, &quot;c&quot;], 5 =&gt; [&quot;d&quot;], 7 =&gt; [&quot;b&quot;]}

  The key can be any Elixir value. For example, you may use a tuple
  to group by multiple keys:

      iex&gt; collection = [
      ...&gt;   %{id: 1, lang: &quot;Elixir&quot;, seq: 1},
      ...&gt;   %{id: 1, lang: &quot;Java&quot;, seq: 1},
      ...&gt;   %{id: 1, lang: &quot;Ruby&quot;, seq: 2},
      ...&gt;   %{id: 2, lang: &quot;Python&quot;, seq: 1},
      ...&gt;   %{id: 2, lang: &quot;C#&quot;, seq: 2},
      ...&gt;   %{id: 2, lang: &quot;Haskell&quot;, seq: 2},
      ...&gt; ]
      iex&gt; Enum.group_by(collection, &amp;{&amp;1.id, &amp;1.seq})
      %{
        {1, 1} =&gt; [%{id: 1, lang: &quot;Elixir&quot;, seq: 1}, %{id: 1, lang: &quot;Java&quot;, seq: 1}],
        {1, 2} =&gt; [%{id: 1, lang: &quot;Ruby&quot;, seq: 2}],
        {2, 1} =&gt; [%{id: 2, lang: &quot;Python&quot;, seq: 1}],
        {2, 2} =&gt; [%{id: 2, lang: &quot;C#&quot;, seq: 2}, %{id: 2, lang: &quot;Haskell&quot;, seq: 2}]
      }
      iex&gt; Enum.group_by(collection, &amp;{&amp;1.id, &amp;1.seq}, &amp;{&amp;1.id, &amp;1.lang})
      %{
        {1, 1} =&gt; [{1, &quot;Elixir&quot;}, {1, &quot;Java&quot;}],
        {1, 2} =&gt; [{1, &quot;Ruby&quot;}],
        {2, 1} =&gt; [{2, &quot;Python&quot;}],
        {2, 2} =&gt; [{2, &quot;C#&quot;}, {2, &quot;Haskell&quot;}]
      }

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">group_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">map</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">group_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">key_fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">value_fun</span> <span class="ahl-operator">\\</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">x</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">x</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">group_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">key_fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">value_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">key_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-variable">key</span> <span class="ahl-operator">=</span> <span class="ahl-variable">key_fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-variable">value</span> <span class="ahl-operator">=</span> <span class="ahl-variable">value_fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span>

      <span class="ahl-keyword">case</span> <span class="ahl-variable">acc</span> <span class="ahl-keyword">do</span>
        <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-operator">^</span><span class="ahl-variable">key</span> <span class="ahl-operator">=&gt;</span> <span class="ahl-variable">existing</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">acc</span> <span class="ahl-operator">|</span> <span class="ahl-variable">key</span> <span class="ahl-operator">=&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">value</span> <span class="ahl-operator">|</span> <span class="ahl-variable">existing</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-namespace">Map</span><span class="ahl-operator">.</span><span class="ahl-function">put</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">key</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">value</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">end</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">group_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">dict</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">IO</span><span class="ahl-operator">.</span><span class="ahl-function">warn</span><span class="ahl-punctuation ahl-bracket">(</span>
      <span class="ahl-string">&quot;Enum.group_by&#x2f;3 with a map&#x2f;dictionary as second element is deprecated. &quot;</span> <span class="ahl-operator">&lt;&gt;</span>
        <span class="ahl-string">&quot;A map is used by default and it is no longer required to pass one to this function&quot;</span>
    <span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-comment"># Avoid warnings about Dict</span>
    <span class="ahl-variable">dict_module</span> <span class="ahl-operator">=</span> <span class="ahl-namespace">Dict</span>

    <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">dict</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">categories</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-variable">dict_module</span><span class="ahl-operator">.</span><span class="ahl-function">update</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">categories</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Intersperses `separator` between each element of the enumeration.

  ## Examples

      iex&gt; Enum.intersperse([1, 2, 3], 0)
      [1, 0, 2, 0, 3]

      iex&gt; Enum.intersperse([1], 0)
      [1]

      iex&gt; Enum.intersperse([], 0)
      []

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">intersperse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">intersperse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">separator</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">case</span> <span class="ahl-variable">enumerable</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
      <span class="ahl-variable">list</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-function">intersperse_non_empty_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">separator</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">intersperse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">separator</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">list</span> <span class="ahl-operator">=</span>
      <span class="ahl-variable">enumerable</span>
      <span class="ahl-operator">|&gt;</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">separator</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-comment"># Head is a superfluous separator</span>
    <span class="ahl-keyword">case</span> <span class="ahl-variable">list</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-comment">_</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">t</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Inserts the given `enumerable` into a `collectable`.

  Note that passing a non-empty list as the `collectable` is deprecated.
  If you&#x27;re collecting into a non-empty keyword list, consider using
  `Keyword.merge(collectable, Enum.to_list(enumerable))`. If you&#x27;re collecting
  into a non-empty list, consider something like `Enum.to_list(enumerable) ++ collectable`.

  ## Examples

      iex&gt; Enum.into([1, 2], [])
      [1, 2]

      iex&gt; Enum.into([a: 1, b: 2], %{})
      %{a: 1, b: 2}

      iex&gt; Enum.into(%{a: 1}, %{b: 2})
      %{a: 1, b: 2}

      iex&gt; Enum.into([a: 1, a: 2], %{})
      %{a: 2}

      iex&gt; Enum.into([a: 2], %{a: 1, b: 3})
      %{a: 2, b: 3}

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">into</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">t</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">Collectable</span><span class="ahl-operator">.</span><span class="ahl-function">t</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-namespace">Collectable</span><span class="ahl-operator">.</span><span class="ahl-function">t</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">into</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">into</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">into</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation">%</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">into_protocol</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">into</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation">%</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">into_protocol</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">into</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">if</span> <span class="ahl-function">map_size</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">==</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
      <span class="ahl-function">into_map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-function">into_map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">into</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">into_protocol</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">into_map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">enumerable</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">into_map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-namespace">:maps</span><span class="ahl-operator">.</span><span class="ahl-function">from_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">into_map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">enumerable</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">Enum</span><span class="ahl-operator">.</span><span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:maps</span><span class="ahl-operator">.</span><span class="ahl-function">from_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">into_map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-namespace">Map</span><span class="ahl-operator">.</span><span class="ahl-function">merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">into_map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
    <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-namespace">Map</span><span class="ahl-operator">.</span><span class="ahl-function">merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">:maps</span><span class="ahl-operator">.</span><span class="ahl-function">from_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">into_map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
    <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-namespace">Enum</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">key</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">val</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-namespace">Map</span><span class="ahl-operator">.</span><span class="ahl-function">put</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">key</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">val</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">into_protocol</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-namespace">Collectable</span><span class="ahl-operator">.</span><span class="ahl-function">into</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-keyword">try</span> <span class="ahl-keyword">do</span>
      <span class="ahl-function">reduce_into_protocol</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">catch</span>
      <span class="ahl-variable">kind</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reason</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-namespace">:erlang</span><span class="ahl-operator">.</span><span class="ahl-function">raise</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">kind</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reason</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin">__STACKTRACE__</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:done</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reduce_into_protocol</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">foldl</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-keyword">fn</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reduce_into_protocol</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">enumerable</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Inserts the given `enumerable` into a `collectable` according to the
  transformation function.

  ## Examples

      iex&gt; Enum.into([1, 2, 3], [], fn x -&gt; x * 3 end)
      [3, 6, 9]

      iex&gt; Enum.into(%{a: 1, b: 2}, %{c: 3}, fn {k, v} -&gt; {k, v * 2} end)
      %{a: 2, b: 4, c: 3}

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">into</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">t</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">Collectable</span><span class="ahl-operator">.</span><span class="ahl-function">t</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">term</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-namespace">Collectable</span><span class="ahl-operator">.</span><span class="ahl-function">t</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">into</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">transform</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">Enum</span><span class="ahl-operator">.</span><span class="ahl-function">map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">transform</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">into</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation">%</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">transform</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">into_protocol</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">transform</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">into</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation">%</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">transform</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">into_protocol</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">transform</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">into</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">transform</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">if</span> <span class="ahl-function">map_size</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">==</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
      <span class="ahl-variable">enumerable</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">Enum</span><span class="ahl-operator">.</span><span class="ahl-function">map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">transform</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:maps</span><span class="ahl-operator">.</span><span class="ahl-function">from_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-namespace">Enum</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">key</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">val</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-variable">transform</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-namespace">Map</span><span class="ahl-operator">.</span><span class="ahl-function">put</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">key</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">val</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">into</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">transform</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">into_protocol</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">transform</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">into_protocol</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">transform</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-namespace">Collectable</span><span class="ahl-operator">.</span><span class="ahl-function">into</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">collectable</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-keyword">try</span> <span class="ahl-keyword">do</span>
      <span class="ahl-function">reduce_into_protocol</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">transform</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">catch</span>
      <span class="ahl-variable">kind</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reason</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-namespace">:erlang</span><span class="ahl-operator">.</span><span class="ahl-function">raise</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">kind</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reason</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin">__STACKTRACE__</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:done</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reduce_into_protocol</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">transform</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">foldl</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-keyword">fn</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">transform</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">x</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reduce_into_protocol</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">transform</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">enumerable</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">transform</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">x</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Joins the given `enumerable` into a string using `joiner` as a
  separator.

  If `joiner` is not passed at all, it defaults to an empty string.

  All elements in the `enumerable` must be convertible to a string
  or be a binary, otherwise an error is raised.

  ## Examples

      iex&gt; Enum.join([1, 2, 3])
      &quot;123&quot;

      iex&gt; Enum.join([1, 2, 3], &quot; = &quot;)
      &quot;1 = 2 = 3&quot;

      iex&gt; Enum.join([[&quot;a&quot;, &quot;b&quot;], [&quot;c&quot;, &quot;d&quot;, &quot;e&quot;, [&quot;f&quot;, &quot;g&quot;]], &quot;h&quot;, &quot;i&quot;], &quot; &quot;)
      &quot;ab cdefg h i&quot;

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">join</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">binary</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-function">binary</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">join</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">joiner</span> <span class="ahl-operator">\\</span> <span class="ahl-string">&quot;&quot;</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">join</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string">&quot;&quot;</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">enumerable</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-function">entry_to_string</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">IO</span><span class="ahl-operator">.</span><span class="ahl-function">iodata_to_binary</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">join</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">joiner</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_binary</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">joiner</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">join_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">joiner</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">join</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">joiner</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_binary</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">joiner</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">reduced</span> <span class="ahl-operator">=</span>
      <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span>
        <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:first</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-function">entry_to_string</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">joiner</span> <span class="ahl-operator">|</span> <span class="ahl-function">entry_to_string</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>
      <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-keyword">if</span> <span class="ahl-variable">reduced</span> <span class="ahl-operator">==</span> <span class="ahl-string ahl-special ahl-symbol">:first</span> <span class="ahl-keyword">do</span>
      <span class="ahl-string">&quot;&quot;</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-namespace">IO</span><span class="ahl-operator">.</span><span class="ahl-function">iodata_to_binary</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">reduced</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns a list where each element is the result of invoking
  `fun` on each corresponding element of `enumerable`.

  For maps, the function expects a key-value tuple.

  ## Examples

      iex&gt; Enum.map([1, 2, 3], fn x -&gt; x * 2 end)
      [2, 4, 6]

      iex&gt; Enum.map([a: 1, b: 2], fn {k, v} -&gt; {k, -v} end)
      [a: -1, b: -2]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-operator">..</span><span class="ahl-variable">last</span><span class="ahl-operator">&#x2f;&#x2f;</span><span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">map_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">R</span><span class="ahl-operator">.</span><span class="ahl-function">map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns a list of results of invoking `fun` on every `nth`
  element of `enumerable`, starting with the first element.

  The first element is always passed to the given function, unless `nth` is `0`.

  The second argument specifying every `nth` element must be a non-negative
  integer.

  If `nth` is `0`, then `enumerable` is directly converted to a list,
  without `fun` being ever applied.

  ## Examples

      iex&gt; Enum.map_every(1..10, 2, fn x -&gt; x + 1000 end)
      [1001, 2, 1003, 4, 1005, 6, 1007, 8, 1009, 10]

      iex&gt; Enum.map_every(1..10, 3, fn x -&gt; x + 1000 end)
      [1001, 2, 3, 1004, 5, 6, 1007, 8, 9, 1010]

      iex&gt; Enum.map_every(1..5, 0, fn x -&gt; x + 1000 end)
      [1, 2, 3, 4, 5]

      iex&gt; Enum.map_every([1, 2, 3], 1, fn x -&gt; x + 1000 end)
      [1001, 1002, 1003]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.4.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">map_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">non_neg_integer</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">map_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">map_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">map_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">map_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">nth</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">map_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">nth</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">1</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">res</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:first</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">R</span><span class="ahl-operator">.</span><span class="ahl-function">map_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">res</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Maps and intersperses the given enumerable in one pass.

  ## Examples

      iex&gt; Enum.map_intersperse([1, 2, 3], :a, &amp;(&amp;1 * 2))
      [2, :a, 4, :a, 6]
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.10.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">map_intersperse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">element</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-function">any</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-function">list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">map_intersperse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">separator</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">mapper</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">map_intersperse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">separator</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">mapper</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">map_intersperse_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">separator</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">mapper</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">map_intersperse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">separator</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">mapper</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">reduced</span> <span class="ahl-operator">=</span>
      <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span>
        <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:first</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">mapper</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>
        <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">mapper</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">separator</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span>
      <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-keyword">if</span> <span class="ahl-variable">reduced</span> <span class="ahl-operator">==</span> <span class="ahl-string ahl-special ahl-symbol">:first</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">reduced</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Maps and joins the given `enumerable` in one pass.

  If `joiner` is not passed at all, it defaults to an empty string.

  All elements returned from invoking the `mapper` must be convertible to
  a string, otherwise an error is raised.

  ## Examples

      iex&gt; Enum.map_join([1, 2, 3], &amp;(&amp;1 * 2))
      &quot;246&quot;

      iex&gt; Enum.map_join([1, 2, 3], &quot; = &quot;, &amp;(&amp;1 * 2))
      &quot;2 = 4 = 6&quot;

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">map_join</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">String</span><span class="ahl-operator">.</span><span class="ahl-function">t</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-namespace">String.Chars</span><span class="ahl-operator">.</span><span class="ahl-function">t</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-namespace">String</span><span class="ahl-operator">.</span><span class="ahl-function">t</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">map_join</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">joiner</span> <span class="ahl-operator">\\</span> <span class="ahl-string">&quot;&quot;</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">mapper</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_binary</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">joiner</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">enumerable</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">map_intersperse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">joiner</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-function">entry_to_string</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">mapper</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">IO</span><span class="ahl-operator">.</span><span class="ahl-function">iodata_to_binary</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Invokes the given function to each element in the `enumerable` to reduce
  it to a single element, while keeping an accumulator.

  Returns a tuple where the first element is the mapped enumerable and
  the second one is the final accumulator.

  The function, `fun`, receives two arguments: the first one is the
  element, and the second one is the accumulator. `fun` must return
  a tuple with two elements in the form of `{result, accumulator}`.

  For maps, the first tuple element must be a `{key, value}` tuple.

  ## Examples

      iex&gt; Enum.map_reduce([1, 2, 3], 0, fn x, acc -&gt; {x * 2, x + acc} end)
      {[2, 4, 6], 6}

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">map_reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">map_reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">mapfoldl</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">map_reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span>
      <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">new_entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">new_entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span>
      <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">false</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span> <span class="ahl-operator">=</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-comment">_</span> <span class="ahl-operator">|</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">false</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span> <span class="ahl-operator">=</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-comment">_</span> <span class="ahl-operator">|</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">false</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">-&gt;</span> <span class="ahl-variable">empty_result</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">element</span> <span class="ahl-operator">|</span> <span class="ahl-variable">empty_result</span> <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">empty_result: </span><span class="ahl-variable">any</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">&gt;=</span><span class="ahl-operator">&#x2f;</span><span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns the maximal element in the `enumerable` according
  to Erlang&#x27;s term ordering.

  By default, the comparison is done with the `&gt;=` sorter function.
  If multiple elements are considered maximal, the first one that
  was found is returned. If you want the last element considered
  maximal to be returned, the sorter function should not return true
  for equal elements.

  If the enumerable is empty, the provided `empty_fallback` is called.
  The default `empty_fallback` raises `Enum.EmptyError`.

  ## Examples

      iex&gt; Enum.max([1, 2, 3])
      3

  The fact this function uses Erlang&#x27;s term ordering means that the comparison
  is structural and not semantic. For example:

      iex&gt; Enum.max([~D[2017-03-31], ~D[2017-04-01]])
      ~D[2017-03-31]

  In the example above, `max&#x2f;2` returned March 31st instead of April 1st
  because the structural comparison compares the day before the year.
  For this reason, most structs provide a &quot;compare&quot; function, such as
  `Date.compare&#x2f;2`, which receives two structs and returns `:lt` (less-than),
  `:eq` (equal to), and `:gt` (greater-than). If you pass a module as the
  sorting function, Elixir will automatically use the `compare&#x2f;2` function
  of said module:

      iex&gt; Enum.max([~D[2017-03-31], ~D[2017-04-01]], Date)
      ~D[2017-04-01]

  Finally, if you don&#x27;t want to raise on empty enumerables, you can pass
  the empty fallback:

      iex&gt; Enum.max([], &amp;&gt;=&#x2f;2, fn -&gt; 0 end)
      0

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">boolean</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-function">module</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span>
          <span class="ahl-variable">element</span> <span class="ahl-operator">|</span> <span class="ahl-variable">empty_result</span>
        <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">empty_result: </span><span class="ahl-variable">any</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">boolean</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-function">module</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">-&gt;</span> <span class="ahl-variable">empty_result</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span>
          <span class="ahl-variable">element</span> <span class="ahl-operator">|</span> <span class="ahl-variable">empty_result</span>
        <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">empty_result: </span><span class="ahl-variable">any</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sorter</span> <span class="ahl-operator">\\</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">&gt;=</span><span class="ahl-operator">&#x2f;</span><span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span> <span class="ahl-operator">\\</span> <span class="ahl-keyword">fn</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-keyword">raise</span> <span class="ahl-namespace">Enum.EmptyError</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">aggregate</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">max_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">max_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">sorter</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">max_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_atom</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">module</span><span class="ahl-operator">.</span><span class="ahl-function">compare</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">!=</span> <span class="ahl-string ahl-special ahl-symbol">:lt</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">false</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">max_by</span><span class="ahl-punctuation ahl-bracket">(</span>
          <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">-&gt;</span> <span class="ahl-variable">empty_result</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">boolean</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-function">module</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">element</span> <span class="ahl-operator">|</span> <span class="ahl-variable">empty_result</span>
        <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">empty_result: </span><span class="ahl-variable">any</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">max_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">max_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">&gt;=</span><span class="ahl-operator">&#x2f;</span><span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns the maximal element in the `enumerable` as calculated
  by the given `fun`.

  By default, the comparison is done with the `&gt;=` sorter function.
  If multiple elements are considered maximal, the first one that
  was found is returned. If you want the last element considered
  maximal to be returned, the sorter function should not return true
  for equal elements.

  Calls the provided `empty_fallback` function and returns its value if
  `enumerable` is empty. The default `empty_fallback` raises `Enum.EmptyError`.

  ## Examples

      iex&gt; Enum.max_by([&quot;a&quot;, &quot;aa&quot;, &quot;aaa&quot;], fn x -&gt; String.length(x) end)
      &quot;aaa&quot;

      iex&gt; Enum.max_by([&quot;a&quot;, &quot;aa&quot;, &quot;aaa&quot;, &quot;b&quot;, &quot;bbb&quot;], &amp;String.length&#x2f;1)
      &quot;aaa&quot;

  The fact this function uses Erlang&#x27;s term ordering means that the
  comparison is structural and not semantic. Therefore, if you want
  to compare structs, most structs provide a &quot;compare&quot; function, such as
  `Date.compare&#x2f;2`, which receives two structs and returns `:lt` (less-than),
  `:eq` (equal to), and `:gt` (greater-than). If you pass a module as the
  sorting function, Elixir will automatically use the `compare&#x2f;2` function
  of said module:

      iex&gt; users = [
      ...&gt;   %{name: &quot;Ellis&quot;, birthday: ~D[1943-05-11]},
      ...&gt;   %{name: &quot;Lovelace&quot;, birthday: ~D[1815-12-10]},
      ...&gt;   %{name: &quot;Turing&quot;, birthday: ~D[1912-06-23]}
      ...&gt; ]
      iex&gt; Enum.max_by(users, &amp;(&amp;1.birthday), Date)
      %{name: &quot;Ellis&quot;, birthday: ~D[1943-05-11]}

  Finally, if you don&#x27;t want to raise on empty enumerables, you can pass
  the empty fallback:

      iex&gt; Enum.max_by([], &amp;String.length&#x2f;1, fn -&gt; nil end)
      nil

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">max_by</span><span class="ahl-punctuation ahl-bracket">(</span>
          <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">boolean</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-function">module</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">-&gt;</span> <span class="ahl-variable">empty_result</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">element</span> <span class="ahl-operator">|</span> <span class="ahl-variable">empty_result</span>
        <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">empty_result: </span><span class="ahl-variable">any</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">max_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sorter</span> <span class="ahl-operator">\\</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">&gt;=</span><span class="ahl-operator">&#x2f;</span><span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span> <span class="ahl-operator">\\</span> <span class="ahl-keyword">fn</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-keyword">raise</span> <span class="ahl-namespace">Enum.EmptyError</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">aggregate_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">max_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Checks if `element` exists within the `enumerable`.

  Membership is tested with the match (`===&#x2f;2`) operator.

  ## Examples

      iex&gt; Enum.member?(1..10, 5)
      true
      iex&gt; Enum.member?(1..10, 5.0)
      false

      iex&gt; Enum.member?([1.0, 2.0, 3.0], 2)
      false
      iex&gt; Enum.member?([1.0, 2.0, 3.0], 2.000)
      true

      iex&gt; Enum.member?([:a, :b, :c], :d)
      false


  When called outside guards, the [`in`](`in&#x2f;2`) and [`not in`](`in&#x2f;2`)
  operators work by using this function.
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">member?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">boolean</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">member?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">member</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">member?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">case</span> <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">member?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_boolean</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">element</span>

      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:error</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">module</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span>
          <span class="ahl-variable">v</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">v</span> <span class="ahl-operator">===</span> <span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">}</span>
          <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">false</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span> <span class="ahl-operator">=</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-comment">_</span> <span class="ahl-operator">|</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">false</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span> <span class="ahl-operator">=</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-comment">_</span> <span class="ahl-operator">|</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">false</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">-&gt;</span> <span class="ahl-variable">empty_result</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">element</span> <span class="ahl-operator">|</span> <span class="ahl-variable">empty_result</span> <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">empty_result: </span><span class="ahl-variable">any</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">&lt;=</span><span class="ahl-operator">&#x2f;</span><span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns the minimal element in the `enumerable` according
  to Erlang&#x27;s term ordering.

  By default, the comparison is done with the `&lt;=` sorter function.
  If multiple elements are considered minimal, the first one that
  was found is returned. If you want the last element considered
  minimal to be returned, the sorter function should not return true
  for equal elements.

  If the enumerable is empty, the provided `empty_fallback` is called.
  The default `empty_fallback` raises `Enum.EmptyError`.

  ## Examples

      iex&gt; Enum.min([1, 2, 3])
      1

  The fact this function uses Erlang&#x27;s term ordering means that the comparison
  is structural and not semantic. For example:

      iex&gt; Enum.min([~D[2017-03-31], ~D[2017-04-01]])
      ~D[2017-04-01]

  In the example above, `min&#x2f;2` returned April 1st instead of March 31st
  because the structural comparison compares the day before the year.
  For this reason, most structs provide a &quot;compare&quot; function, such as
  `Date.compare&#x2f;2`, which receives two structs and returns `:lt` (less-than),
  `:eq` (equal to), and `:gt` (greater-than). If you pass a module as the
  sorting function, Elixir will automatically use the `compare&#x2f;2` function
  of said module:

      iex&gt; Enum.min([~D[2017-03-31], ~D[2017-04-01]], Date)
      ~D[2017-03-31]

  Finally, if you don&#x27;t want to raise on empty enumerables, you can pass
  the empty fallback:

      iex&gt; Enum.min([], fn -&gt; 0 end)
      0

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">boolean</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-function">module</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span>
          <span class="ahl-variable">element</span> <span class="ahl-operator">|</span> <span class="ahl-variable">empty_result</span>
        <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">empty_result: </span><span class="ahl-variable">any</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">boolean</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-function">module</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">-&gt;</span> <span class="ahl-variable">empty_result</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span>
          <span class="ahl-variable">element</span> <span class="ahl-operator">|</span> <span class="ahl-variable">empty_result</span>
        <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">empty_result: </span><span class="ahl-variable">any</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sorter</span> <span class="ahl-operator">\\</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">&lt;=</span><span class="ahl-operator">&#x2f;</span><span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span> <span class="ahl-operator">\\</span> <span class="ahl-keyword">fn</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-keyword">raise</span> <span class="ahl-namespace">Enum.EmptyError</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">aggregate</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">min_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">min_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">sorter</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">min_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_atom</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">module</span><span class="ahl-operator">.</span><span class="ahl-function">compare</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">!=</span> <span class="ahl-string ahl-special ahl-symbol">:gt</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">false</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">min_by</span><span class="ahl-punctuation ahl-bracket">(</span>
          <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">-&gt;</span> <span class="ahl-variable">empty_result</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">boolean</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-function">module</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">element</span> <span class="ahl-operator">|</span> <span class="ahl-variable">empty_result</span>
        <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">empty_result: </span><span class="ahl-variable">any</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">min_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">min_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">&lt;=</span><span class="ahl-operator">&#x2f;</span><span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns the minimal element in the `enumerable` as calculated
  by the given `fun`.

  By default, the comparison is done with the `&lt;=` sorter function.
  If multiple elements are considered minimal, the first one that
  was found is returned. If you want the last element considered
  minimal to be returned, the sorter function should not return true
  for equal elements.

  Calls the provided `empty_fallback` function and returns its value if
  `enumerable` is empty. The default `empty_fallback` raises `Enum.EmptyError`.

  ## Examples

      iex&gt; Enum.min_by([&quot;a&quot;, &quot;aa&quot;, &quot;aaa&quot;], fn x -&gt; String.length(x) end)
      &quot;a&quot;

      iex&gt; Enum.min_by([&quot;a&quot;, &quot;aa&quot;, &quot;aaa&quot;, &quot;b&quot;, &quot;bbb&quot;], &amp;String.length&#x2f;1)
      &quot;a&quot;

  The fact this function uses Erlang&#x27;s term ordering means that the
  comparison is structural and not semantic. Therefore, if you want
  to compare structs, most structs provide a &quot;compare&quot; function, such as
  `Date.compare&#x2f;2`, which receives two structs and returns `:lt` (less-than),
  `:eq` (equal to), and `:gt` (greater-than). If you pass a module as the
  sorting function, Elixir will automatically use the `compare&#x2f;2` function
  of said module:

      iex&gt; users = [
      ...&gt;   %{name: &quot;Ellis&quot;, birthday: ~D[1943-05-11]},
      ...&gt;   %{name: &quot;Lovelace&quot;, birthday: ~D[1815-12-10]},
      ...&gt;   %{name: &quot;Turing&quot;, birthday: ~D[1912-06-23]}
      ...&gt; ]
      iex&gt; Enum.min_by(users, &amp;(&amp;1.birthday), Date)
      %{name: &quot;Lovelace&quot;, birthday: ~D[1815-12-10]}

  Finally, if you don&#x27;t want to raise on empty enumerables, you can pass
  the empty fallback:

      iex&gt; Enum.min_by([], &amp;String.length&#x2f;1, fn -&gt; nil end)
      nil

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">min_by</span><span class="ahl-punctuation ahl-bracket">(</span>
          <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">boolean</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-function">module</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">-&gt;</span> <span class="ahl-variable">empty_result</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">element</span> <span class="ahl-operator">|</span> <span class="ahl-variable">empty_result</span>
        <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">empty_result: </span><span class="ahl-variable">any</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">min_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sorter</span> <span class="ahl-operator">\\</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">&lt;=</span><span class="ahl-operator">&#x2f;</span><span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span> <span class="ahl-operator">\\</span> <span class="ahl-keyword">fn</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-keyword">raise</span> <span class="ahl-namespace">Enum.EmptyError</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">aggregate_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">min_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns a tuple with the minimal and the maximal elements in the
  enumerable according to Erlang&#x27;s term ordering.

  If multiple elements are considered maximal or minimal, the first one
  that was found is returned.

  Calls the provided `empty_fallback` function and returns its value if
  `enumerable` is empty. The default `empty_fallback` raises `Enum.EmptyError`.

  ## Examples

      iex&gt; Enum.min_max([2, 3, 1])
      {1, 3}

      iex&gt; Enum.min_max([], fn -&gt; {nil, nil} end)
      {nil, nil}

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">min_max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">-&gt;</span> <span class="ahl-variable">empty_result</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-variable">empty_result</span>
        <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">empty_result: </span><span class="ahl-variable">any</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">min_max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span> <span class="ahl-operator">\\</span> <span class="ahl-keyword">fn</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-keyword">raise</span> <span class="ahl-namespace">Enum.EmptyError</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">min_max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-operator">..</span><span class="ahl-variable">last</span><span class="ahl-operator">&#x2f;&#x2f;</span><span class="ahl-variable">step</span> <span class="ahl-operator">=</span> <span class="ahl-variable">range</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">case</span> <span class="ahl-namespace">Range</span><span class="ahl-operator">.</span><span class="ahl-function">size</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">range</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">empty_fallback</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>

      <span class="ahl-comment">_</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">last</span> <span class="ahl-operator">=</span> <span class="ahl-variable">last</span> <span class="ahl-operator">-</span> <span class="ahl-function">rem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">last</span> <span class="ahl-operator">-</span> <span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">min_max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">first_fun</span> <span class="ahl-operator">=</span> <span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span> <span class="ahl-operator">|</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-bracket">]</span>

    <span class="ahl-variable">reduce_fun</span> <span class="ahl-operator">=</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">min</span> <span class="ahl-operator">|</span> <span class="ahl-variable">max</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">min</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">max</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>
    <span class="ahl-keyword">end</span>

    <span class="ahl-keyword">case</span> <span class="ahl-function">reduce_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first_fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reduce_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-string ahl-special ahl-symbol">:empty</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">min</span> <span class="ahl-operator">|</span> <span class="ahl-variable">max</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">min</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">max</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">false</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">min_max_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">-&gt;</span> <span class="ahl-variable">empty_result</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-variable">empty_result</span>
        <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">empty_result: </span><span class="ahl-variable">any</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">min_max_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">min_max_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">&lt;</span><span class="ahl-operator">&#x2f;</span><span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns a tuple with the minimal and the maximal elements in the
  enumerable as calculated by the given function.

  If multiple elements are considered maximal or minimal, the first one
  that was found is returned.

  ## Examples

      iex&gt; Enum.min_max_by([&quot;aaa&quot;, &quot;bb&quot;, &quot;c&quot;], fn x -&gt; String.length(x) end)
      {&quot;c&quot;, &quot;aaa&quot;}

      iex&gt; Enum.min_max_by([&quot;aaa&quot;, &quot;a&quot;, &quot;bb&quot;, &quot;c&quot;, &quot;ccc&quot;], &amp;String.length&#x2f;1)
      {&quot;a&quot;, &quot;aaa&quot;}

      iex&gt; Enum.min_max_by([], &amp;String.length&#x2f;1, fn -&gt; {nil, nil} end)
      {nil, nil}

  The fact this function uses Erlang&#x27;s term ordering means that the
  comparison is structural and not semantic. Therefore, if you want
  to compare structs, most structs provide a &quot;compare&quot; function, such as
  `Date.compare&#x2f;2`, which receives two structs and returns `:lt` (less-than),
  `:eq` (equal to), and `:gt` (greater-than). If you pass a module as the
  sorting function, Elixir will automatically use the `compare&#x2f;2` function
  of said module:

      iex&gt; users = [
      ...&gt;   %{name: &quot;Ellis&quot;, birthday: ~D[1943-05-11]},
      ...&gt;   %{name: &quot;Lovelace&quot;, birthday: ~D[1815-12-10]},
      ...&gt;   %{name: &quot;Turing&quot;, birthday: ~D[1912-06-23]}
      ...&gt; ]
      iex&gt; Enum.min_max_by(users, &amp;(&amp;1.birthday), Date)
      {
        %{name: &quot;Lovelace&quot;, birthday: ~D[1815-12-10]},
        %{name: &quot;Ellis&quot;, birthday: ~D[1943-05-11]}
      }

  Finally, if you don&#x27;t want to raise on empty enumerables, you can pass
  the empty fallback:

      iex&gt; Enum.min_max_by([], &amp;String.length&#x2f;1, fn -&gt; nil end)
      nil

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">min_max_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">boolean</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-function">module</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-variable">empty_result</span>
        <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">empty_result: </span><span class="ahl-variable">any</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">min_max_by</span><span class="ahl-punctuation ahl-bracket">(</span>
          <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">boolean</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-function">module</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">-&gt;</span> <span class="ahl-variable">empty_result</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-variable">empty_result</span>
        <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">empty_result: </span><span class="ahl-variable">any</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">min_max_by</span><span class="ahl-punctuation ahl-bracket">(</span>
        <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span>
        <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span>
        <span class="ahl-variable">sorter_or_empty_fallback</span> <span class="ahl-operator">\\</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">&lt;</span><span class="ahl-operator">&#x2f;</span><span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-delimiter">,</span>
        <span class="ahl-variable">empty_fallback</span> <span class="ahl-operator">\\</span> <span class="ahl-keyword">fn</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-keyword">raise</span> <span class="ahl-namespace">Enum.EmptyError</span> <span class="ahl-keyword">end</span>
      <span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">min_max_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_atom</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">min_max_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">min_max_by_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">min_max_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">first_fun</span> <span class="ahl-operator">=</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-variable">fun_entry</span> <span class="ahl-operator">=</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun_entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun_entry</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span>

    <span class="ahl-variable">reduce_fun</span> <span class="ahl-operator">=</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">prev_min</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">prev_max</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun_min</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun_max</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-variable">fun_entry</span> <span class="ahl-operator">=</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span>

      <span class="ahl-keyword">cond</span> <span class="ahl-keyword">do</span>
        <span class="ahl-variable">sorter</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun_entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun_min</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-&gt;</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">prev_max</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun_entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun_max</span><span class="ahl-punctuation ahl-bracket">}</span>

        <span class="ahl-variable">sorter</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun_max</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun_entry</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-&gt;</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">prev_min</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun_min</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun_entry</span><span class="ahl-punctuation ahl-bracket">}</span>

        <span class="ahl-constant ahl-builtin boolean">true</span> <span class="ahl-operator">-&gt;</span>
          <span class="ahl-variable">acc</span>
      <span class="ahl-keyword">end</span>
    <span class="ahl-keyword">end</span>

    <span class="ahl-keyword">case</span> <span class="ahl-function">reduce_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first_fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reduce_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-string ahl-special ahl-symbol">:empty</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">min</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">max</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">min</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">max</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">min_max_by_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_atom</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">module</span><span class="ahl-operator">.</span><span class="ahl-function">compare</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">==</span> <span class="ahl-string ahl-special ahl-symbol">:lt</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Splits the `enumerable` in two lists according to the given function `fun`.

  Splits the given `enumerable` in two lists by calling `fun` with each element
  in the `enumerable` as its only argument. Returns a tuple with the first list
  containing all the elements in `enumerable` for which applying `fun` returned
  a truthy value, and a second list with all the elements for which applying
  `fun` returned a falsy value (`false` or `nil`).

  The elements in both the returned lists are in the same relative order as they
  were in the original enumerable (if such enumerable was ordered, like a
  list). See the examples below.

  ## Examples

      iex&gt; Enum.split_with([5, 4, 3, 2, 1, 0], fn x -&gt; rem(x, 2) == 0 end)
      {[4, 2, 0], [5, 3, 1]}

      iex&gt; Enum.split_with([a: 1, b: -2, c: 1, d: -3], fn {_k, v} -&gt; v &lt; 0 end)
      {[b: -2, d: -3], [a: 1, c: 1]}

      iex&gt; Enum.split_with([a: 1, b: -2, c: 1, d: -3], fn {_k, v} -&gt; v &gt; 50 end)
      {[], [a: 1, b: -2, c: 1, d: -3]}

      iex&gt; Enum.split_with([], fn {_k, v} -&gt; v &gt; 50 end)
      {[], []}

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.4.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">split_with</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-function">as_boolean</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">split_with</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">acc1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc2</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span>
      <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">acc1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc2</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-keyword">if</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc1</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc2</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">else</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">acc1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">end</span>
      <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc2</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">false</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">deprecated</span> <span class="ahl-string">&quot;Use Enum.split_with&#x2f;2 instead&quot;</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">partition</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">split_with</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns a random element of an `enumerable`.

  Raises `Enum.EmptyError` if `enumerable` is empty.

  This function uses Erlang&#x27;s [`:rand` module](`:rand`) to calculate
  the random value. Check its documentation for setting a
  different random algorithm or a different seed.

  If a range is passed into the function, this function will pick a
  random value between the range limits, without traversing the whole
  range (thus executing in constant time and constant memory).

  ## Examples

  The examples below use the `:exsss` pseudorandom algorithm since it&#x27;s
  the default from Erlang&#x2f;OTP 22:

      # Although not necessary, let&#x27;s seed the random algorithm
      iex&gt; :rand.seed(:exsss, {100, 101, 102})
      iex&gt; Enum.random([1, 2, 3])
      2
      iex&gt; Enum.random([1, 2, 3])
      1
      iex&gt; Enum.random(1..1_000)
      309

  ## Implementation

  The random functions in this module implement reservoir sampling,
  which allows them to sample infinite collections. In particular,
  we implement Algorithm L, as described in by Kim-Hung Li in
  &quot;Reservoir-Sampling Algorithms of Time Complexity O(n(1+log(N&#x2f;n)))&quot;.
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">random</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">element</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">random</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">random</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">case</span> <span class="ahl-function">length</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-keyword">raise</span> <span class="ahl-namespace">Enum.EmptyError</span>
      <span class="ahl-variable">length</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">enumerable</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">drop_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-function">random_count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">length</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">hd</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">random</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-operator">..</span><span class="ahl-comment">_</span><span class="ahl-operator">&#x2f;&#x2f;</span><span class="ahl-variable">step</span> <span class="ahl-operator">=</span> <span class="ahl-variable">range</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">case</span> <span class="ahl-namespace">Range</span><span class="ahl-operator">.</span><span class="ahl-function">size</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">range</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-keyword">raise</span> <span class="ahl-namespace">Enum.EmptyError</span>
      <span class="ahl-variable">size</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">first</span> <span class="ahl-operator">+</span> <span class="ahl-function">random_count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">size</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">*</span> <span class="ahl-variable">step</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">random</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">result</span> <span class="ahl-operator">=</span>
      <span class="ahl-keyword">case</span> <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
          <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-&gt;</span>
          <span class="ahl-function">slice_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">random_count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>

        <span class="ahl-comment"># TODO: Deprecate me in Elixir v1.18.</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-&gt;</span>
          <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-function">random_count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>

        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">3</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-&gt;</span>
          <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-function">random_count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>

        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:error</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
          <span class="ahl-function">take_random</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">end</span>

    <span class="ahl-keyword">case</span> <span class="ahl-variable">result</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-keyword">raise</span> <span class="ahl-namespace">Enum.EmptyError</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">elem</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">elem</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">random_count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">:rand</span><span class="ahl-operator">.</span><span class="ahl-function">uniform</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Invokes `fun` for each element in the `enumerable` with the
  accumulator.

  Raises `Enum.EmptyError` if `enumerable` is empty.

  The first element of the `enumerable` is used as the initial value
  of the accumulator. Then, the function is invoked with the next
  element and the accumulator. The result returned by the function
  is used as the accumulator for the next iteration, recursively.
  When the `enumerable` is done, the last accumulator is returned.

  Since the first element of the enumerable is used as the initial
  value of the accumulator, `fun` will only be executed `n - 1` times
  where `n` is the length of the enumerable. This function won&#x27;t call
  the specified function for enumerables that are one-element long.

  If you wish to use another value for the accumulator, use
  `Enum.reduce&#x2f;3`.

  ## Examples

      iex&gt; Enum.reduce([1, 2, 3, 4], fn x, acc -&gt; x * acc end)
      24

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">acc</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">h</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">raise</span> <span class="ahl-namespace">Enum.EmptyError</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:first</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span>
      <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>
      <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:first</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-keyword">case</span> <span class="ahl-keyword">do</span>
      <span class="ahl-string ahl-special ahl-symbol">:first</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-keyword">raise</span> <span class="ahl-namespace">Enum.EmptyError</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">acc</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Invokes `fun` for each element in the `enumerable` with the accumulator.

  The initial value of the accumulator is `acc`. The function is invoked for
  each element in the enumerable with the accumulator. The result returned
  by the function is used as the accumulator for the next iteration.
  The function returns the last accumulator.

  ## Examples

      iex&gt; Enum.reduce([1, 2, 3], 0, fn x, acc -&gt; x + acc end)
      6

      iex&gt; Enum.reduce(%{a: 2, b: 3, c: 4}, 0, fn {_key, val}, acc -&gt; acc + val end)
      9

  ## Reduce as a building block

  Reduce (sometimes called `fold`) is a basic building block in functional
  programming. Almost all of the functions in the `Enum` module can be
  implemented on top of reduce. Those functions often rely on other operations,
  such as `Enum.reverse&#x2f;1`, which are optimized by the runtime.

  For example, we could implement `map&#x2f;2` in terms of `reduce&#x2f;3` as follows:

      def my_map(enumerable, fun) do
        enumerable
        |&gt; Enum.reduce([], fn x, acc -&gt; [fun.(x) | acc] end)
        |&gt; Enum.reverse()
      end

  In the example above, `Enum.reduce&#x2f;3` accumulates the result of each call
  to `fun` into a list in reverse order, which is correctly ordered at the
  end by calling `Enum.reverse&#x2f;1`.

  Implementing functions like `map&#x2f;2`, `filter&#x2f;2` and others are a good
  exercise for understanding the power behind `Enum.reduce&#x2f;3`. When an
  operation cannot be expressed by any of the functions in the `Enum`
  module, developers will most likely resort to `reduce&#x2f;3`.
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">acc</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">foldl</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-operator">..</span><span class="ahl-variable">last</span><span class="ahl-operator">&#x2f;&#x2f;</span><span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation">%</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce_enumerable</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">:maps</span><span class="ahl-operator">.</span><span class="ahl-function">fold</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-keyword">fn</span> <span class="ahl-variable">k</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">v</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">k</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">v</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce_enumerable</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Reduces `enumerable` until `fun` returns `{:halt, term}`.

  The return value for `fun` is expected to be

    * `{:cont, acc}` to continue the reduction with `acc` as the new
      accumulator or
    * `{:halt, acc}` to halt the reduction

  If `fun` returns `{:halt, acc}` the reduction is halted and the function
  returns `acc`. Otherwise, if the enumerable is exhausted, the function returns
  the accumulator of the last `{:cont, acc}`.

  ## Examples

      iex&gt; Enum.reduce_while(1..100, 0, fn x, acc -&gt;
      ...&gt;   if x &lt; 5 do
      ...&gt;     {:cont, acc + x}
      ...&gt;   else
      ...&gt;     {:halt, acc}
      ...&gt;   end
      ...&gt; end)
      10
      iex&gt; Enum.reduce_while(1..100, 0, fn x, acc -&gt;
      ...&gt;   if x &gt; 0 do
      ...&gt;     {:cont, acc + x}
      ...&gt;   else
      ...&gt;     {:halt, acc}
      ...&gt;   end
      ...&gt; end)
      5050

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">reduce_while</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">any</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">any</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce_while</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns a list of elements in `enumerable` excluding those for which the function `fun` returns
  a truthy value.

  See also `filter&#x2f;2`.

  ## Examples

      iex&gt; Enum.reject([1, 2, 3], fn x -&gt; rem(x, 2) == 0 end)
      [1, 3]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">reject</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-function">as_boolean</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">reject</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reject_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">reject</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">R</span><span class="ahl-operator">.</span><span class="ahl-function">reject</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns a list of elements in `enumerable` in reverse order.

  ## Examples

      iex&gt; Enum.reverse([1, 2, 3])
      [3, 2, 1]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">=</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">element1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">element2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element1</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">element1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element2</span> <span class="ahl-operator">|</span> <span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">element2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element1</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span> <span class="ahl-operator">|</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Reverses the elements in `enumerable`, appends the `tail`, and returns
  it as a list.

  This is an optimization for
  `enumerable |&gt; Enum.reverse() |&gt; Enum.concat(tail)`.

  ## Examples

      iex&gt; Enum.reverse([1, 2, 3], [4, 5, 6])
      [3, 2, 1, 4, 5, 6]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Reverses the `enumerable` in the range from initial `start_index`
  through `count` elements.

  If `count` is greater than the size of the rest of the `enumerable`,
  then this function will reverse the rest of the enumerable.

  ## Examples

      iex&gt; Enum.reverse_slice([1, 2, 3, 4, 5, 6], 2, 4)
      [1, 2, 6, 5, 4, 3]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">reverse_slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">non_neg_integer</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">non_neg_integer</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">reverse_slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start_index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start_index</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">start_index</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">count</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">list</span> <span class="ahl-operator">=</span> <span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-variable">length</span> <span class="ahl-operator">=</span> <span class="ahl-function">length</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-variable">count</span> <span class="ahl-operator">=</span> <span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">length</span> <span class="ahl-operator">-</span> <span class="ahl-variable">start_index</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-keyword">if</span> <span class="ahl-variable">count</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
      <span class="ahl-function">reverse_slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">length</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start_index</span> <span class="ahl-operator">+</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Slides a single or multiple elements given by `range_or_single_index` from `enumerable`
  to `insertion_index`.

  The semantics of the range to be moved match the semantics of `Enum.slice&#x2f;2`.
  Specifically, that means:

   * Indices are normalized, meaning that negative indexes will be counted from the end
      (for example, -1 means the last element of the enumerable). This will result in *two*
      traversals of your enumerable on types like lists that don&#x27;t provide a constant-time count.

    * If the normalized index range&#x27;s `last` is out of bounds, the range is truncated to the last element.

    * If the normalized index range&#x27;s `first` is out of bounds, the selected range for sliding
      will be empty, so you&#x27;ll get back your input list.

    * Decreasing ranges (such as `5..0&#x2f;&#x2f;1`) also select an empty range to be moved,
      so you&#x27;ll get back your input list.

    * Ranges with any step but 1 will raise an error.

  ## Examples

      # Slide a single element
      iex&gt; Enum.slide([:a, :b, :c, :d, :e, :f, :g], 5, 1)
      [:a, :f, :b, :c, :d, :e, :g]

      # Slide a range of elements backward
      iex&gt; Enum.slide([:a, :b, :c, :d, :e, :f, :g], 3..5, 1)
      [:a, :d, :e, :f, :b, :c, :g]

      # Slide a range of elements forward
      iex&gt; Enum.slide([:a, :b, :c, :d, :e, :f, :g], 1..3, 5)
      [:a, :e, :f, :b, :c, :d, :g]

      # Slide with negative indices (counting from the end)
      iex&gt; Enum.slide([:a, :b, :c, :d, :e, :f, :g], 3..-1&#x2f;&#x2f;1, 2)
      [:a, :b, :d, :e, :f, :g, :c]
      iex&gt; Enum.slide([:a, :b, :c, :d, :e, :f, :g], -4..-2, 1)
      [:a, :d, :e, :f, :b, :c, :g]

      # Insert at negative indices (counting from the end)
      iex&gt; Enum.slide([:a, :b, :c, :d, :e, :f, :g], 3, -1)
      [:a, :b, :c, :e, :f, :g, :d]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.13.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">slide</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">Range</span><span class="ahl-operator">.</span><span class="ahl-function">t</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-variable">index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">index</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">slide</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">range_or_single_index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">insertion_index</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">slide</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">single_index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">insertion_index</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">single_index</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">slide</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">single_index</span><span class="ahl-operator">..</span><span class="ahl-variable">single_index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">insertion_index</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment"># This matches the behavior of Enum.slice&#x2f;2</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">slide</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-operator">..</span><span class="ahl-comment">_</span><span class="ahl-operator">&#x2f;&#x2f;</span><span class="ahl-variable">step</span> <span class="ahl-operator">=</span> <span class="ahl-variable">index_range</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_insertion_index</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">step</span> <span class="ahl-operator">!=</span> <span class="ahl-constant ahl-numeric integer">1</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">raise</span> <span class="ahl-namespace">ArgumentError</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-string">&quot;Enum.slide&#x2f;3 does not accept ranges with custom steps, got: <span class="ahl-punctuation ahl-special">#{</span><span class="ahl-function">inspect</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">index_range</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-special">}</span>&quot;</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment"># Normalize negative input ranges like Enum.slice&#x2f;2</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">slide</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first</span><span class="ahl-operator">..</span><span class="ahl-variable">last</span><span class="ahl-operator">&#x2f;&#x2f;</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">insertion_index</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">when</span> <span class="ahl-variable">first</span> <span class="ahl-operator">&lt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">or</span> <span class="ahl-variable">last</span> <span class="ahl-operator">&lt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">or</span> <span class="ahl-variable">insertion_index</span> <span class="ahl-operator">&lt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">count</span> <span class="ahl-operator">=</span> <span class="ahl-namespace">Enum</span><span class="ahl-operator">.</span><span class="ahl-function">count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-variable">normalized_first</span> <span class="ahl-operator">=</span> <span class="ahl-keyword">if</span> <span class="ahl-variable">first</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">else: </span><span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span> <span class="ahl-operator">+</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-variable">normalized_last</span> <span class="ahl-operator">=</span> <span class="ahl-keyword">if</span> <span class="ahl-variable">last</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">else: </span><span class="ahl-variable">last</span> <span class="ahl-operator">+</span> <span class="ahl-variable">count</span>

    <span class="ahl-variable">normalized_insertion_index</span> <span class="ahl-operator">=</span>
      <span class="ahl-keyword">if</span> <span class="ahl-variable">insertion_index</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">insertion_index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">else: </span><span class="ahl-variable">insertion_index</span> <span class="ahl-operator">+</span> <span class="ahl-variable">count</span>

    <span class="ahl-keyword">if</span> <span class="ahl-variable">normalized_first</span> <span class="ahl-operator">&lt;</span> <span class="ahl-variable">count</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">normalized_first</span> <span class="ahl-operator">!=</span> <span class="ahl-variable">normalized_insertion_index</span> <span class="ahl-keyword">do</span>
      <span class="ahl-variable">normalized_range</span> <span class="ahl-operator">=</span> <span class="ahl-variable">normalized_first</span><span class="ahl-operator">..</span><span class="ahl-variable">normalized_last</span><span class="ahl-operator">&#x2f;&#x2f;</span><span class="ahl-constant ahl-numeric integer">1</span>
      <span class="ahl-function">slide</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">normalized_range</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">normalized_insertion_index</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-namespace">Enum</span><span class="ahl-operator">.</span><span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">slide</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">insertion_index</span><span class="ahl-operator">..</span><span class="ahl-comment">_</span><span class="ahl-operator">&#x2f;&#x2f;</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">insertion_index</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">Enum</span><span class="ahl-operator">.</span><span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">slide</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first</span><span class="ahl-operator">..</span><span class="ahl-variable">last</span><span class="ahl-operator">&#x2f;&#x2f;</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">insertion_index</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">when</span> <span class="ahl-variable">insertion_index</span> <span class="ahl-operator">&gt;</span> <span class="ahl-variable">first</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">insertion_index</span> <span class="ahl-operator">&lt;=</span> <span class="ahl-variable">last</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">raise</span> <span class="ahl-namespace">ArgumentError</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-string">&quot;insertion index for slide must be outside the range being moved &quot;</span> <span class="ahl-operator">&lt;&gt;</span>
            <span class="ahl-string">&quot;(tried to insert <span class="ahl-punctuation ahl-special">#{</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-special">}</span>..<span class="ahl-punctuation ahl-special">#{</span><span class="ahl-variable">last</span><span class="ahl-punctuation ahl-special">}</span> at <span class="ahl-punctuation ahl-special">#{</span><span class="ahl-variable">insertion_index</span><span class="ahl-punctuation ahl-special">}</span>)&quot;</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">slide</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first</span><span class="ahl-operator">..</span><span class="ahl-variable">last</span><span class="ahl-operator">&#x2f;&#x2f;</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_insertion_index</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">first</span> <span class="ahl-operator">&gt;</span> <span class="ahl-variable">last</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">Enum</span><span class="ahl-operator">.</span><span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment"># Guarantees at this point: step size == 1 and first &lt;= last and (insertion_index &lt; first or insertion_index &gt; last)</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">slide</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first</span><span class="ahl-operator">..</span><span class="ahl-variable">last</span><span class="ahl-operator">&#x2f;&#x2f;</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">insertion_index</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">impl</span> <span class="ahl-operator">=</span> <span class="ahl-keyword">if</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-operator">&amp;</span><span class="ahl-function">slide_list_start</span><span class="ahl-operator">&#x2f;</span><span class="ahl-operator">4</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">else: </span><span class="ahl-operator">&amp;</span><span class="ahl-function">slide_any</span><span class="ahl-operator">&#x2f;</span><span class="ahl-operator">4</span>

    <span class="ahl-keyword">cond</span> <span class="ahl-keyword">do</span>
      <span class="ahl-variable">insertion_index</span> <span class="ahl-operator">&lt;=</span> <span class="ahl-variable">first</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">impl</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">insertion_index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-variable">insertion_index</span> <span class="ahl-operator">&gt;</span> <span class="ahl-variable">last</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">impl</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">insertion_index</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment"># Takes the range from middle..last and moves it to be in front of index start</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">slide_any</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">middle</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-comment"># We&#x27;re going to deal with 4 &quot;chunks&quot; of the enumerable:</span>
    <span class="ahl-comment"># 0. &quot;Head,&quot; before the start index</span>
    <span class="ahl-comment"># 1. &quot;Slide back,&quot; between start (inclusive) and middle (exclusive)</span>
    <span class="ahl-comment"># 2. &quot;Slide front,&quot; between middle (inclusive) and last (inclusive)</span>
    <span class="ahl-comment"># 3. &quot;Tail,&quot; after last</span>
    <span class="ahl-comment">#</span>
    <span class="ahl-comment"># But, we&#x27;re going to accumulate these into only two lists: pre and post.</span>
    <span class="ahl-comment"># We&#x27;ll reverse-accumulate the head into our pre list, then &quot;slide back&quot; into post,</span>
    <span class="ahl-comment"># then &quot;slide front&quot; into pre, then &quot;tail&quot; into post.</span>
    <span class="ahl-comment">#</span>
    <span class="ahl-comment"># Then at the end, we&#x27;re going to reassemble and reverse them, and end up with the</span>
    <span class="ahl-comment"># chunks in the correct order.</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-comment">_size</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">pre</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">post</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span>
      <span class="ahl-namespace">Enum</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">item</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">pre</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">post</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">pre</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">post</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span>
          <span class="ahl-keyword">cond</span> <span class="ahl-keyword">do</span>
            <span class="ahl-variable">index</span> <span class="ahl-operator">&lt;</span> <span class="ahl-variable">start</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">item</span> <span class="ahl-operator">|</span> <span class="ahl-variable">pre</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">post</span><span class="ahl-punctuation ahl-bracket">}</span>
            <span class="ahl-variable">index</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-variable">start</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">index</span> <span class="ahl-operator">&lt;</span> <span class="ahl-variable">middle</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">pre</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">item</span> <span class="ahl-operator">|</span> <span class="ahl-variable">post</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span>
            <span class="ahl-variable">index</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-variable">middle</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">index</span> <span class="ahl-operator">&lt;=</span> <span class="ahl-variable">last</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">item</span> <span class="ahl-operator">|</span> <span class="ahl-variable">pre</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">post</span><span class="ahl-punctuation ahl-bracket">}</span>
            <span class="ahl-constant ahl-builtin boolean">true</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">pre</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">item</span> <span class="ahl-operator">|</span> <span class="ahl-variable">post</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span>
          <span class="ahl-keyword">end</span>

        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">index</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">pre</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">post</span><span class="ahl-punctuation ahl-bracket">}</span>
      <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">pre</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">post</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment"># Like slide_any&#x2f;4 above, this optimized implementation of slide for lists depends</span>
  <span class="ahl-comment"># on the indices being sorted such that we&#x27;re moving middle..last to be in front of start.</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">slide_list_start</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">middle</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-bracket">)</span>
       <span class="ahl-keyword">when</span> <span class="ahl-variable">start</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">start</span> <span class="ahl-operator">&lt;=</span> <span class="ahl-variable">middle</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">middle</span> <span class="ahl-operator">&lt;=</span> <span class="ahl-variable">last</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h</span> <span class="ahl-operator">|</span> <span class="ahl-function">slide_list_start</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">middle</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slide_list_start</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">middle</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">slide_list_middle</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">middle</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">slide_list_start</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_middle</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_last</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slide_list_middle</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">middle</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">middle</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">slide_list_middle</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">middle</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slide_list_middle</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start_to_middle</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">slid_range</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">slide_list_last</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-variable">slid_range</span> <span class="ahl-operator">++</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start_to_middle</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment"># You asked for a middle index off the end of the list... you get what we&#x27;ve got</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">slide_list_middle</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slide_list_last</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">last</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">slide_list_last</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slide_list_last</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slide_list_last</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Applies the given function to each element in the `enumerable`,
  storing the result in a list and passing it as the accumulator
  for the next computation. Uses the first element in the `enumerable`
  as the starting value.

  ## Examples

      iex&gt; Enum.scan(1..5, &amp;(&amp;1 + &amp;2))
      [1, 3, 6, 10, 15]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">scan</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">any</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">scan</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">scan</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">scan</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">elem</span> <span class="ahl-operator">|</span> <span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">scanned</span> <span class="ahl-operator">=</span> <span class="ahl-function">scan_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">elem</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">elem</span> <span class="ahl-operator">|</span> <span class="ahl-variable">scanned</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">scan</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">res</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:first</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">R</span><span class="ahl-operator">.</span><span class="ahl-function">scan2</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">res</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Applies the given function to each element in the `enumerable`,
  storing the result in a list and passing it as the accumulator
  for the next computation. Uses the given `acc` as the starting value.

  ## Examples

      iex&gt; Enum.scan(1..5, 0, &amp;(&amp;1 + &amp;2))
      [1, 3, 6, 10, 15]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">scan</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">any</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">scan</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">scan_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">scan</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">res</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">R</span><span class="ahl-operator">.</span><span class="ahl-function">scan3</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">res</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns a list with the elements of `enumerable` shuffled.

  This function uses Erlang&#x27;s [`:rand` module](`:rand`) to calculate
  the random value. Check its documentation for setting a
  different random algorithm or a different seed.

  ## Examples

  The examples below use the `:exsss` pseudorandom algorithm since it&#x27;s
  the default from Erlang&#x2f;OTP 22:

      # Although not necessary, let&#x27;s seed the random algorithm
      iex&gt; :rand.seed(:exsss, {11, 22, 33})
      iex&gt; Enum.shuffle([1, 2, 3])
      [2, 1, 3]
      iex&gt; Enum.shuffle([1, 2, 3])
      [2, 3, 1]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">shuffle</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">shuffle</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">randomized</span> <span class="ahl-operator">=</span>
      <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-namespace">:rand</span><span class="ahl-operator">.</span><span class="ahl-function">uniform</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span>
      <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-function">shuffle_unwrap</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">keysort</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">randomized</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">shuffle_unwrap</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">h</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h</span> <span class="ahl-operator">|</span> <span class="ahl-function">shuffle_unwrap</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">shuffle_unwrap</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns a subset list of the given `enumerable` by `index_range`.

  `index_range` must be a `Range`. Given an `enumerable`, it drops
  elements before `index_range.first` (zero-base), then it takes elements
  until element `index_range.last` (inclusively).

  Indexes are normalized, meaning that negative indexes will be counted
  from the end (for example, `-1` means the last element of the `enumerable`).

  If `index_range.last` is out of bounds, then it is assigned as the index
  of the last element.

  If the normalized `index_range.first` is out of bounds of the given
  `enumerable`, or this one is greater than the normalized `index_range.last`,
  then `[]` is returned.

  If a step `n` (other than `1`) is used in `index_range`, then it takes
  every `n`th element from `index_range.first` to `index_range.last`
  (according to the same rules described above).

  ## Examples

      iex&gt; Enum.slice([1, 2, 3, 4, 5], 1..3)
      [2, 3, 4]

      iex&gt; Enum.slice([1, 2, 3, 4, 5], 3..10)
      [4, 5]

      # Last three elements (negative indexes)
      iex&gt; Enum.slice([1, 2, 3, 4, 5], -3..-1)
      [3, 4, 5]

  For ranges where `start &gt; stop`, you need to explicit
  mark them as increasing:

      iex&gt; Enum.slice([1, 2, 3, 4, 5], 1..-2&#x2f;&#x2f;1)
      [2, 3, 4]

  The step can be any positive number. For example, to
  get every 2 elements of the collection:

      iex&gt; Enum.slice([1, 2, 3, 4, 5], 0..-1&#x2f;&#x2f;2)
      [1, 3, 5]

  To get every third element of the first ten elements:

      iex&gt; integers = Enum.to_list(1..20)
      iex&gt; Enum.slice(integers, 0..9&#x2f;&#x2f;3)
      [1, 4, 7, 10]

  If the first position is after the end of the enumerable
  or after the last position of the range, it returns an
  empty list:

      iex&gt; Enum.slice([1, 2, 3, 4, 5], 6..10)
      []

      # first is greater than last
      iex&gt; Enum.slice([1, 2, 3, 4, 5], 6..5&#x2f;&#x2f;1)
      []

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.6.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">Range</span><span class="ahl-operator">.</span><span class="ahl-function">t</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first</span><span class="ahl-operator">..</span><span class="ahl-variable">last</span><span class="ahl-operator">&#x2f;&#x2f;</span><span class="ahl-variable">step</span> <span class="ahl-operator">=</span> <span class="ahl-variable">index_range</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-comment"># TODO: Support negative steps as a reverse on Elixir v2.0.</span>
    <span class="ahl-keyword">cond</span> <span class="ahl-keyword">do</span>
      <span class="ahl-variable">step</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-function">slice_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span>

      <span class="ahl-variable">step</span> <span class="ahl-operator">==</span> <span class="ahl-operator">-</span><span class="ahl-constant ahl-numeric integer">1</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">first</span> <span class="ahl-operator">&gt;</span> <span class="ahl-variable">last</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-namespace">IO</span><span class="ahl-operator">.</span><span class="ahl-function">warn</span><span class="ahl-punctuation ahl-bracket">(</span>
          <span class="ahl-string">&quot;negative steps are not supported in Enum.slice&#x2f;2, pass <span class="ahl-punctuation ahl-special">#{</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-special">}</span>..<span class="ahl-punctuation ahl-special">#{</span><span class="ahl-variable">last</span><span class="ahl-punctuation ahl-special">}</span>&#x2f;&#x2f;1 instead&quot;</span>
        <span class="ahl-punctuation ahl-bracket">)</span>

        <span class="ahl-function">slice_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>

      <span class="ahl-constant ahl-builtin boolean">true</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-keyword">raise</span> <span class="ahl-namespace">ArgumentError</span><span class="ahl-punctuation ahl-delimiter">,</span>
              <span class="ahl-string">&quot;Enum.slice&#x2f;2 does not accept ranges with negative steps, got: <span class="ahl-punctuation ahl-special">#{</span><span class="ahl-function">inspect</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">index_range</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-special">}</span>&quot;</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment"># TODO: Remove me on v2.0</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">__struct__: </span><span class="ahl-namespace">Range</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">first: </span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">last: </span><span class="ahl-variable">last</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-variable">index_range</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">step</span> <span class="ahl-operator">=</span> <span class="ahl-keyword">if</span> <span class="ahl-variable">first</span> <span class="ahl-operator">&lt;=</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">else: </span><span class="ahl-operator">-</span><span class="ahl-constant ahl-numeric integer">1</span>
    <span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">Map</span><span class="ahl-operator">.</span><span class="ahl-function">put</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">index_range</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slice_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">-</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">first</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">if</span> <span class="ahl-variable">step</span> <span class="ahl-operator">==</span> <span class="ahl-constant ahl-numeric integer">1</span> <span class="ahl-keyword">do</span>
      <span class="ahl-function">drop</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-variable">enumerable</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">drop</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">take_every_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">step</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slice_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span>
       <span class="ahl-keyword">when</span> <span class="ahl-variable">last</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-variable">first</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">last</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">first</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">slice_forward</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span> <span class="ahl-operator">-</span> <span class="ahl-variable">first</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slice_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">slice_count_and_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-variable">first</span> <span class="ahl-operator">=</span> <span class="ahl-keyword">if</span> <span class="ahl-variable">first</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">else: </span><span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span> <span class="ahl-operator">+</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-variable">last</span> <span class="ahl-operator">=</span> <span class="ahl-keyword">if</span> <span class="ahl-variable">last</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">else: </span><span class="ahl-variable">last</span> <span class="ahl-operator">+</span> <span class="ahl-variable">count</span>
    <span class="ahl-variable">amount</span> <span class="ahl-operator">=</span> <span class="ahl-variable">last</span> <span class="ahl-operator">-</span> <span class="ahl-variable">first</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span>

    <span class="ahl-keyword">if</span> <span class="ahl-variable">first</span> <span class="ahl-operator">&lt;</span> <span class="ahl-variable">count</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
      <span class="ahl-variable">amount</span> <span class="ahl-operator">=</span> <span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span> <span class="ahl-operator">-</span> <span class="ahl-variable">first</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-variable">amount</span> <span class="ahl-operator">=</span> <span class="ahl-function">amount_with_step</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">amount_with_step</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">amount</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">amount_with_step</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">div</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns a subset list of the given `enumerable`, from `start_index` (zero-based)
  with `amount` number of elements if available.

  Given an `enumerable`, it drops elements right before element `start_index`;
  then, it takes `amount` of elements, returning as many elements as possible if
  there are not enough elements.

  A negative `start_index` can be passed, which means the `enumerable` is
  enumerated once and the index is counted from the end (for example,
  `-1` starts slicing from the last element).

  It returns `[]` if `amount` is `0` or if `start_index` is out of bounds.

  ## Examples

      iex&gt; Enum.slice(1..100, 5, 10)
      [6, 7, 8, 9, 10, 11, 12, 13, 14, 15]

      # amount to take is greater than the number of elements
      iex&gt; Enum.slice(1..10, 5, 100)
      [6, 7, 8, 9, 10]

      iex&gt; Enum.slice(1..10, 5, 0)
      []

      # using a negative start index
      iex&gt; Enum.slice(1..10, -6, 3)
      [5, 6, 7]
      iex&gt; Enum.slice(1..10, -11, 5)
      [1, 2, 3, 4, 5]

      # out of bound start index
      iex&gt; Enum.slice(1..10, 10, 5)
      []

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">non_neg_integer</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start_index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start_index</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start_index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start_index</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">start_index</span> <span class="ahl-operator">&lt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">slice_count_and_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-variable">start_index</span> <span class="ahl-operator">=</span> <span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">count</span> <span class="ahl-operator">+</span> <span class="ahl-variable">start_index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-variable">amount</span> <span class="ahl-operator">=</span> <span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span> <span class="ahl-operator">-</span> <span class="ahl-variable">start_index</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-keyword">if</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
      <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start_index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start_index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start_index</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">slice_forward</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start_index</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Sorts the `enumerable` according to Erlang&#x27;s term ordering.

  This function uses the merge sort algorithm. Do not use this
  function to sort structs, see `sort&#x2f;2` for more information.

  ## Examples

      iex&gt; Enum.sort([3, 2, 1])
      [1, 2, 3]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">sort</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">sort</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">sort</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">sort</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">sort</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span> <span class="ahl-operator">&lt;=</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Sorts the `enumerable` by the given function.

  This function uses the merge sort algorithm. The given function should compare
  two arguments, and return `true` if the first argument precedes or is in the
  same place as the second one.

  ## Examples

      iex&gt; Enum.sort([1, 2, 3], &amp;(&amp;1 &gt;= &amp;2))
      [3, 2, 1]

  The sorting algorithm will be stable as long as the given function
  returns `true` for values considered equal:

      iex&gt; Enum.sort([&quot;some&quot;, &quot;kind&quot;, &quot;of&quot;, &quot;monster&quot;], &amp;(byte_size(&amp;1) &lt;= byte_size(&amp;2)))
      [&quot;of&quot;, &quot;some&quot;, &quot;kind&quot;, &quot;monster&quot;]

  If the function does not return `true` for equal values, the sorting
  is not stable and the order of equal terms may be shuffled.
  For example:

      iex&gt; Enum.sort([&quot;some&quot;, &quot;kind&quot;, &quot;of&quot;, &quot;monster&quot;], &amp;(byte_size(&amp;1) &lt; byte_size(&amp;2)))
      [&quot;of&quot;, &quot;kind&quot;, &quot;some&quot;, &quot;monster&quot;]

  ## Ascending and descending (since v1.10.0)

  `sort&#x2f;2` allows a developer to pass `:asc` or `:desc` as the sorter, which is a convenience for
  [`&amp;&lt;=&#x2f;2`](`&lt;=&#x2f;2`) and [`&amp;&gt;=&#x2f;2`](`&gt;=&#x2f;2`) respectively.

      iex&gt; Enum.sort([2, 3, 1], :asc)
      [1, 2, 3]
      iex&gt; Enum.sort([2, 3, 1], :desc)
      [3, 2, 1]

  ## Sorting structs

  Do not use `&lt;&#x2f;2`, `&lt;=&#x2f;2`, `&gt;&#x2f;2`, `&gt;=&#x2f;2` and friends when sorting structs.
  That&#x27;s because the built-in operators above perform structural comparison
  and not a semantic one. Imagine we sort the following list of dates:

      iex&gt; dates = [~D[2019-01-01], ~D[2020-03-02], ~D[2019-06-06]]
      iex&gt; Enum.sort(dates)
      [~D[2019-01-01], ~D[2020-03-02], ~D[2019-06-06]]

  Note that the returned result is incorrect, because `sort&#x2f;1` by default uses
  `&lt;=&#x2f;2`, which will compare their structure. When comparing structures, the
  fields are compared in alphabetical order, which means the dates above will
  be compared by `day`, `month` and then `year`, which is the opposite of what
  we want.

  For this reason, most structs provide a &quot;compare&quot; function, such as
  `Date.compare&#x2f;2`, which receives two structs and returns `:lt` (less-than),
  `:eq` (equal to), and `:gt` (greater-than). If you pass a module as the
  sorting function, Elixir will automatically use the `compare&#x2f;2` function
  of said module:

      iex&gt; dates = [~D[2019-01-01], ~D[2020-03-02], ~D[2019-06-06]]
      iex&gt; Enum.sort(dates, Date)
      [~D[2019-01-01], ~D[2019-06-06], ~D[2020-03-02]]

  To retrieve all dates in descending order, you can wrap the module in
  a tuple with `:asc` or `:desc` as first element:

      iex&gt; dates = [~D[2019-01-01], ~D[2020-03-02], ~D[2019-06-06]]
      iex&gt; Enum.sort(dates, {:asc, Date})
      [~D[2019-01-01], ~D[2019-06-06], ~D[2020-03-02]]
      iex&gt; dates = [~D[2019-01-01], ~D[2020-03-02], ~D[2019-06-06]]
      iex&gt; Enum.sort(dates, {:desc, Date})
      [~D[2020-03-02], ~D[2019-06-06], ~D[2019-01-01]]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">sort</span><span class="ahl-punctuation ahl-bracket">(</span>
          <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">boolean</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-string ahl-special ahl-symbol">:asc</span> <span class="ahl-operator">|</span> <span class="ahl-string ahl-special ahl-symbol">:desc</span> <span class="ahl-operator">|</span> <span class="ahl-function">module</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:asc</span> <span class="ahl-operator">|</span> <span class="ahl-string ahl-special ahl-symbol">:desc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">module</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">sort</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">case</span> <span class="ahl-variable">sorter</span> <span class="ahl-keyword">do</span>
      <span class="ahl-string ahl-special ahl-symbol">:asc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">sort</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-string ahl-special ahl-symbol">:desc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">sort</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-comment">_</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">sort</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-function">to_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">sort</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">fun</span> <span class="ahl-operator">=</span> <span class="ahl-function">to_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-function">sort_reducer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">sort_terminator</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">to_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">sorter</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">to_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-string ahl-special ahl-symbol">:asc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-operator">&amp;</span><span class="ahl-operator">&lt;=</span><span class="ahl-operator">&#x2f;</span><span class="ahl-constant ahl-numeric integer">2</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">to_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-string ahl-special ahl-symbol">:desc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-operator">&amp;</span><span class="ahl-operator">&gt;=</span><span class="ahl-operator">&#x2f;</span><span class="ahl-constant ahl-numeric integer">2</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">to_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_atom</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">module</span><span class="ahl-operator">.</span><span class="ahl-function">compare</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">!=</span> <span class="ahl-string ahl-special ahl-symbol">:gt</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">to_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:asc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_atom</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">module</span><span class="ahl-operator">.</span><span class="ahl-function">compare</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">!=</span> <span class="ahl-string ahl-special ahl-symbol">:gt</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">to_sort_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:desc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_atom</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">module</span><span class="ahl-operator">.</span><span class="ahl-function">compare</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">!=</span> <span class="ahl-string ahl-special ahl-symbol">:lt</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Sorts the mapped results of the `enumerable` according to the provided `sorter`
  function.

  This function maps each element of the `enumerable` using the
  provided `mapper` function. The enumerable is then sorted by
  the mapped elements using the `sorter`, which defaults to `:asc`
  and sorts the elements ascendingly.

  `sort_by&#x2f;3` differs from `sort&#x2f;2` in that it only calculates the
  comparison value for each element in the enumerable once instead of
  once for each element in each comparison. If the same function is
  being called on both elements, it&#x27;s more efficient to use `sort_by&#x2f;3`.

  ## Ascending and descending (since v1.10.0)

  `sort_by&#x2f;3` allows a developer to pass `:asc` or `:desc` as the sorter,
  which is a convenience for [`&amp;&lt;=&#x2f;2`](`&lt;=&#x2f;2`) and [`&amp;&gt;=&#x2f;2`](`&gt;=&#x2f;2`) respectively:
      iex&gt; Enum.sort_by([2, 3, 1], &amp;(&amp;1), :asc)
      [1, 2, 3]

      iex&gt; Enum.sort_by([2, 3, 1], &amp;(&amp;1), :desc)
      [3, 2, 1]

  ## Examples

  Using the default `sorter` of `:asc` :

      iex&gt; Enum.sort_by([&quot;some&quot;, &quot;kind&quot;, &quot;of&quot;, &quot;monster&quot;], &amp;byte_size&#x2f;1)
      [&quot;of&quot;, &quot;some&quot;, &quot;kind&quot;, &quot;monster&quot;]

  Sorting by multiple properties - first by size, then by first letter
  (this takes advantage of the fact that tuples are compared element-by-element):

      iex&gt; Enum.sort_by([&quot;some&quot;, &quot;kind&quot;, &quot;of&quot;, &quot;monster&quot;], &amp;{byte_size(&amp;1), String.first(&amp;1)})
      [&quot;of&quot;, &quot;kind&quot;, &quot;some&quot;, &quot;monster&quot;]

  Similar to `sort&#x2f;2`, you can pass a custom sorter:

      iex&gt; Enum.sort_by([&quot;some&quot;, &quot;kind&quot;, &quot;of&quot;, &quot;monster&quot;], &amp;byte_size&#x2f;1, :desc)
      [&quot;monster&quot;, &quot;some&quot;, &quot;kind&quot;, &quot;of&quot;]

  As in `sort&#x2f;2`, avoid using the default sorting function to sort
  structs, as by default it performs structural comparison instead of
  a semantic one. In such cases, you shall pass a sorting function as
  third element or any module that implements a `compare&#x2f;2` function.
  For example, to sort users by their birthday in both ascending and
  descending order respectively:

      iex&gt; users = [
      ...&gt;   %{name: &quot;Ellis&quot;, birthday: ~D[1943-05-11]},
      ...&gt;   %{name: &quot;Lovelace&quot;, birthday: ~D[1815-12-10]},
      ...&gt;   %{name: &quot;Turing&quot;, birthday: ~D[1912-06-23]}
      ...&gt; ]
      iex&gt; Enum.sort_by(users, &amp;(&amp;1.birthday), Date)
      [
        %{name: &quot;Lovelace&quot;, birthday: ~D[1815-12-10]},
        %{name: &quot;Turing&quot;, birthday: ~D[1912-06-23]},
        %{name: &quot;Ellis&quot;, birthday: ~D[1943-05-11]}
      ]
      iex&gt; Enum.sort_by(users, &amp;(&amp;1.birthday), {:desc, Date})
      [
        %{name: &quot;Ellis&quot;, birthday: ~D[1943-05-11]},
        %{name: &quot;Turing&quot;, birthday: ~D[1912-06-23]},
        %{name: &quot;Lovelace&quot;, birthday: ~D[1815-12-10]}
      ]

  ## Performance characteristics

  As detailed in the initial section, `sort_by&#x2f;3` calculates the comparison
  value for each element in the enumerable once instead of once for each
  element in each comparison. This implies `sort_by&#x2f;3` must do an initial
  pass on the data to compute those values.

  However, if those values are cheap to compute, for example, you have
  already extracted the field you want to sort by into a tuple, then those
  extra passes become overhead. In such cases, consider using `List.keysort&#x2f;3`
  instead.

  Let&#x27;s see an example. Imagine you have a list of products and you have a
  list of IDs. You want to keep all products that are in the given IDs and
  return their names sorted by their price. You could write it like this:

      for(
        product &lt;- products,
        product.id in ids,
        do: product
      )
      |&gt; Enum.sort_by(&amp; &amp;1.price)
      |&gt; Enum.map(&amp; &amp;1.name)

  However, you could also write it like this:

      for(
        product &lt;- products,
        product.id in ids,
        do: {product.name, product.price}
      )
      |&gt; List.keysort(1)
      |&gt; Enum.map(&amp;elem(&amp;1, 0))

  Using `List.keysort&#x2f;3` will be a better choice for performance sensitive
  code as it avoids additional traversals.
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">sort_by</span><span class="ahl-punctuation ahl-bracket">(</span>
          <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">mapped_element</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
          <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">boolean</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-string ahl-special ahl-symbol">:asc</span> <span class="ahl-operator">|</span> <span class="ahl-string ahl-special ahl-symbol">:desc</span> <span class="ahl-operator">|</span> <span class="ahl-function">module</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:asc</span> <span class="ahl-operator">|</span> <span class="ahl-string ahl-special ahl-symbol">:desc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">module</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span>
          <span class="ahl-variable">list</span>
        <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">mapped_element: </span><span class="ahl-variable">element</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">sort_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">mapper</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sorter</span> <span class="ahl-operator">\\</span> <span class="ahl-string ahl-special ahl-symbol">:asc</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">sort_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">mapper</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:desc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">mapper</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">enumerable</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">Enum</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">mapper</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">List</span><span class="ahl-operator">.</span><span class="ahl-function">keysort</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:asc</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">List</span><span class="ahl-operator">.</span><span class="ahl-function">foldl</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">sort_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">mapper</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">mapper</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">enumerable</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">mapper</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">List</span><span class="ahl-operator">.</span><span class="ahl-function">keysort</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">map</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Splits the `enumerable` into two enumerables, leaving `count`
  elements in the first one.

  If `count` is a negative number, it starts counting from the
  back to the beginning of the `enumerable`.

  Be aware that a negative `count` implies the `enumerable`
  will be enumerated twice: once to calculate the position, and
  a second time to do the actual splitting.

  ## Examples

      iex&gt; Enum.split([1, 2, 3], 2)
      {[1, 2], [3]}

      iex&gt; Enum.split([1, 2, 3], 10)
      {[1, 2, 3], []}

      iex&gt; Enum.split([1, 2, 3], 0)
      {[], [1, 2, 3]}

      iex&gt; Enum.split([1, 2, 3], -1)
      {[1, 2], [3]}

      iex&gt; Enum.split([1, 2, 3], -5)
      {[], [1, 2, 3]}

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">split</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">integer</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">split</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">count</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">split_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">split</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">count</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list2</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span>
      <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">counter</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc2</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-keyword">if</span> <span class="ahl-variable">counter</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">counter</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc1</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc2</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">else</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">counter</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">end</span>
      <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list2</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">split</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">count</span> <span class="ahl-operator">&lt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">split_reverse_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">-</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Splits enumerable in two at the position of the element for which
  `fun` returns a falsy value (`false` or `nil`) for the first time.

  It returns a two-element tuple with two lists of elements.
  The element that triggered the split is part of the second list.

  ## Examples

      iex&gt; Enum.split_while([1, 2, 3, 4], fn x -&gt; x &lt; 3 end)
      {[1, 2], [3, 4]}

      iex&gt; Enum.split_while([1, 2, 3, 4], fn x -&gt; x &lt; 0 end)
      {[], [1, 2, 3, 4]}

      iex&gt; Enum.split_while([1, 2, 3, 4], fn x -&gt; x &gt; 0 end)
      {[1, 2, 3, 4], []}

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">split_while</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-function">as_boolean</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">split_while</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">split_while_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">split_while</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list2</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span>
      <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span>
        <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">acc1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
          <span class="ahl-keyword">if</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc1</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">else: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">acc1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">)</span>

        <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">acc1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc2</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">acc1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span>
      <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list2</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns the sum of all elements.

  Raises `ArithmeticError` if `enumerable` contains a non-numeric value.

  ## Examples

      iex&gt; Enum.sum([1, 2, 3])
      6

      iex&gt; Enum.sum(1..10)
      55

      iex&gt; Enum.sum(1..10&#x2f;&#x2f;2)
      25

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">sum</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">number</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">sum</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">sum</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-operator">..</span><span class="ahl-variable">last</span><span class="ahl-operator">&#x2f;&#x2f;</span><span class="ahl-variable">step</span> <span class="ahl-operator">=</span> <span class="ahl-variable">range</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">range</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">Range</span><span class="ahl-operator">.</span><span class="ahl-function">size</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-operator">*</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span> <span class="ahl-operator">+</span> <span class="ahl-variable">last</span> <span class="ahl-operator">-</span> <span class="ahl-function">rem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">last</span> <span class="ahl-operator">-</span> <span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">div</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">sum</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">+</span><span class="ahl-operator">&#x2f;</span><span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns the product of all elements.

  Raises `ArithmeticError` if `enumerable` contains a non-numeric value.

  ## Examples

      iex&gt; Enum.product([])
      1
      iex&gt; Enum.product([2, 3, 4])
      24
      iex&gt; Enum.product([2.0, 3.0, 4.0])
      24.0

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.12.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">product</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">number</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">product</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">*</span><span class="ahl-operator">&#x2f;</span><span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Takes an `amount` of elements from the beginning or the end of the `enumerable`.

  If a positive `amount` is given, it takes the `amount` elements from the
  beginning of the `enumerable`.

  If a negative `amount` is given, the `amount` of elements will be taken from the end.
  The `enumerable` will be enumerated once to retrieve the proper index and
  the remaining calculation is performed from the end.

  If amount is `0`, it returns `[]`.

  ## Examples

      iex&gt; Enum.take([1, 2, 3], 2)
      [1, 2]

      iex&gt; Enum.take([1, 2, 3], 10)
      [1, 2, 3]

      iex&gt; Enum.take([1, 2, 3], 0)
      []

      iex&gt; Enum.take([1, 2, 3], -1)
      [3]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">take</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">integer</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">take</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">take</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">take</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">take_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">take</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">res</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span>
      <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">n</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-keyword">case</span> <span class="ahl-variable">n</span> <span class="ahl-keyword">do</span>
          <span class="ahl-constant ahl-numeric integer">1</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">n</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>
          <span class="ahl-comment">_</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">n</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">end</span>
      <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">res</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">take</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">&lt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">slice_count_and_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-variable">first</span> <span class="ahl-operator">=</span> <span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">max</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span> <span class="ahl-operator">+</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span> <span class="ahl-operator">-</span> <span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns a list of every `nth` element in the `enumerable`,
  starting with the first element.

  The first element is always included, unless `nth` is 0.

  The second argument specifying every `nth` element must be a non-negative
  integer.

  ## Examples

      iex&gt; Enum.take_every(1..10, 2)
      [1, 3, 5, 7, 9]

      iex&gt; Enum.take_every(1..10, 0)
      []

      iex&gt; Enum.take_every([1, 2, 3], 1)
      [1, 2, 3]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">take_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">non_neg_integer</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">take_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">take_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">take_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">take_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">nth</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">1</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">take_every_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">nth</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">take_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">nth</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">1</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">res</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:first</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">R</span><span class="ahl-operator">.</span><span class="ahl-function">take_every</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">nth</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">res</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Takes `count` random elements from `enumerable`.

  Note that this function will traverse the whole `enumerable` to
  get the random sublist.

  See `random&#x2f;1` for notes on implementation and random seed.

  ## Examples

      # Although not necessary, let&#x27;s seed the random algorithm
      iex&gt; :rand.seed(:exsss, {1, 2, 3})
      iex&gt; Enum.take_random(1..10, 2)
      [6, 1]
      iex&gt; Enum.take_random(?a..?z, 5)
      ~c&quot;bkzmt&quot;

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">take_random</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">non_neg_integer</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">take_random</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">take_random</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">take_random</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">take_random</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">enumerable</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric float">1.0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin">nil</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span>
      <span class="ahl-variable">elem</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_current</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">take_jdx_w</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">elem</span><span class="ahl-punctuation ahl-bracket">}</span>

      <span class="ahl-comment">_elem</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">current</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">current</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-keyword">case</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric float">1.0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin">nil</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-comment">_idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">current</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">current</span><span class="ahl-punctuation ahl-bracket">]</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">take_random</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">count</span> <span class="ahl-keyword">in</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-operator">..</span><span class="ahl-constant ahl-numeric integer">128</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">sample</span> <span class="ahl-operator">=</span> <span class="ahl-namespace">Tuple</span><span class="ahl-operator">.</span><span class="ahl-function">duplicate</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-builtin">nil</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-variable">reducer</span> <span class="ahl-operator">=</span> <span class="ahl-keyword">fn</span>
      <span class="ahl-variable">elem</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">idx</span> <span class="ahl-operator">&lt;</span> <span class="ahl-variable">count</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">rand</span> <span class="ahl-operator">=</span> <span class="ahl-function">take_index</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-variable">sample</span> <span class="ahl-operator">=</span> <span class="ahl-variable">sample</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">put_elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">rand</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">put_elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">rand</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">elem</span><span class="ahl-punctuation ahl-bracket">)</span>

        <span class="ahl-keyword">if</span> <span class="ahl-variable">idx</span> <span class="ahl-operator">==</span> <span class="ahl-variable">jdx</span> <span class="ahl-keyword">do</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">take_jdx_w</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">else</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">end</span>

      <span class="ahl-variable">elem</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">pos</span> <span class="ahl-operator">=</span> <span class="ahl-namespace">:rand</span><span class="ahl-operator">.</span><span class="ahl-function">uniform</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">take_jdx_w</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">put_elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">pos</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">elem</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>

      <span class="ahl-comment">_elem</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span>

    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">size</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric float">1.0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reducer</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-keyword">if</span> <span class="ahl-variable">count</span> <span class="ahl-operator">&lt;</span> <span class="ahl-variable">size</span> <span class="ahl-keyword">do</span>
      <span class="ahl-namespace">Tuple</span><span class="ahl-operator">.</span><span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-function">take_tupled</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">size</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">take_random</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">count</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">reducer</span> <span class="ahl-operator">=</span> <span class="ahl-keyword">fn</span>
      <span class="ahl-variable">elem</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">idx</span> <span class="ahl-operator">&lt;</span> <span class="ahl-variable">count</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">rand</span> <span class="ahl-operator">=</span> <span class="ahl-function">take_index</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-variable">sample</span> <span class="ahl-operator">=</span> <span class="ahl-variable">sample</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">Map</span><span class="ahl-operator">.</span><span class="ahl-function">put</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">Map</span><span class="ahl-operator">.</span><span class="ahl-function">get</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">rand</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">Map</span><span class="ahl-operator">.</span><span class="ahl-function">put</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">rand</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">elem</span><span class="ahl-punctuation ahl-bracket">)</span>

        <span class="ahl-keyword">if</span> <span class="ahl-variable">idx</span> <span class="ahl-operator">==</span> <span class="ahl-variable">jdx</span> <span class="ahl-keyword">do</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">take_jdx_w</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">else</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">end</span>

      <span class="ahl-variable">elem</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">pos</span> <span class="ahl-operator">=</span> <span class="ahl-namespace">:rand</span><span class="ahl-operator">.</span><span class="ahl-function">uniform</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">take_jdx_w</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">sample</span> <span class="ahl-operator">|</span> <span class="ahl-variable">pos</span> <span class="ahl-operator">=&gt;</span> <span class="ahl-variable">elem</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>

      <span class="ahl-comment">_elem</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">idx</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span>

    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">size</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric float">1.0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reducer</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-function">take_mapped</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">size</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">compile</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:inline</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">take_jdx_w: </span><span class="ahl-constant ahl-numeric integer">3</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">take_index: </span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_jdx_w</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">w</span> <span class="ahl-operator">=</span> <span class="ahl-variable">w</span> <span class="ahl-operator">*</span> <span class="ahl-namespace">:math</span><span class="ahl-operator">.</span><span class="ahl-function">exp</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-namespace">:math</span><span class="ahl-operator">.</span><span class="ahl-function">log</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-namespace">:rand</span><span class="ahl-operator">.</span><span class="ahl-function">uniform</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">&#x2f;</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-variable">jdx</span> <span class="ahl-operator">=</span> <span class="ahl-variable">idx</span> <span class="ahl-operator">+</span> <span class="ahl-function">floor</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-namespace">:math</span><span class="ahl-operator">.</span><span class="ahl-function">log</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-namespace">:rand</span><span class="ahl-operator">.</span><span class="ahl-function">uniform</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">&#x2f;</span> <span class="ahl-namespace">:math</span><span class="ahl-operator">.</span><span class="ahl-function">log</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span> <span class="ahl-operator">-</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">jdx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">w</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_index</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-constant ahl-numeric integer">0</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_index</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-namespace">:rand</span><span class="ahl-operator">.</span><span class="ahl-function">uniform</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">idx</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_tupled</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_sample</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">acc</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_tupled</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">position</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">position</span> <span class="ahl-operator">=</span> <span class="ahl-variable">position</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span>
    <span class="ahl-function">take_tupled</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">position</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">position</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_mapped</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_sample</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">acc</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_mapped</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">position</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">position</span> <span class="ahl-operator">=</span> <span class="ahl-variable">position</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span>
    <span class="ahl-function">take_mapped</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">position</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-namespace">Map</span><span class="ahl-operator">.</span><span class="ahl-function">fetch!</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">sample</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">position</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Takes the elements from the beginning of the `enumerable` while `fun` returns
  a truthy value.

  ## Examples

      iex&gt; Enum.take_while([1, 2, 3], fn x -&gt; x &lt; 3 end)
      [1, 2]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">take_while</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-function">as_boolean</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">take_while</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">take_while_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">take_while</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">res</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span>
      <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-keyword">if</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">else</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">end</span>
      <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">res</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Converts `enumerable` to a list.

  ## Examples

      iex&gt; Enum.to_list(1..3)
      [1, 2, 3]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">enumerable</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">__struct__: </span><span class="ahl-namespace">Range</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-variable">range</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-namespace">Range</span><span class="ahl-operator">.</span><span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">range</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation">%</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-namespace">Map</span><span class="ahl-operator">.</span><span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Enumerates the `enumerable`, removing all duplicate elements.

  ## Examples

      iex&gt; Enum.uniq([1, 2, 3, 3, 2, 1])
      [1, 2, 3]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">uniq</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">uniq</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">uniq_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">x</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">x</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">false</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">deprecated</span> <span class="ahl-string">&quot;Use Enum.uniq_by&#x2f;2 instead&quot;</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">uniq</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">uniq_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Enumerates the `enumerable`, by removing the elements for which
  function `fun` returned duplicate elements.

  The function `fun` maps every element to a term. Two elements are
  considered duplicates if the return value of `fun` is equal for
  both of them.

  The first occurrence of each element is kept.

  ## Example

      iex&gt; Enum.uniq_by([{1, :x}, {2, :y}, {1, :z}], fn {x, _} -&gt; x end)
      [{1, :x}, {2, :y}]

      iex&gt; Enum.uniq_by([a: {:tea, 2}, b: {:tea, 2}, c: {:coffee, 1}], fn {_, y} -&gt; y end)
      [a: {:tea, 2}, c: {:coffee, 1}]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">uniq_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">list</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">uniq_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">uniq_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">uniq_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">R</span><span class="ahl-operator">.</span><span class="ahl-function">uniq_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Opposite of `zip&#x2f;2`. Extracts two-element tuples from the
  given `enumerable` and groups them together.

  It takes an `enumerable` with elements being two-element tuples and returns
  a tuple with two lists, each of which is formed by the first and
  second element of each tuple, respectively.

  This function fails unless `enumerable` is or can be converted into a
  list of tuples with *exactly* two elements in each tuple.

  ## Examples

      iex&gt; Enum.unzip([{:a, 1}, {:b, 2}, {:c, 3}])
      {[:a, :b, :c], [1, 2, 3]}

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">unzip</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">unzip</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-comment">_</span> <span class="ahl-operator">|</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">=</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">unzip</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">unzip</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">unzip</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list2</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span>
      <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">el1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">el2</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list2</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">el1</span> <span class="ahl-operator">|</span> <span class="ahl-variable">list1</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">el2</span> <span class="ahl-operator">|</span> <span class="ahl-variable">list2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span>
      <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list2</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">unzip</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">el1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">el2</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-variable">reversed_list</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">unzip</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">reversed_list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">el1</span> <span class="ahl-operator">|</span> <span class="ahl-variable">list1</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">el2</span> <span class="ahl-operator">|</span> <span class="ahl-variable">list2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">unzip</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list2</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Returns the `enumerable` with each element wrapped in a tuple
  alongside its index or according to a given function.

  May receive a function or an integer offset.

  If an `offset` is given, it will index from the given offset instead of from
  zero.

  If a `function` is given, it will index by invoking the function for each
  element and index (zero-based) of the enumerable.

  ## Examples

      iex&gt; Enum.with_index([:a, :b, :c])
      [a: 0, b: 1, c: 2]

      iex&gt; Enum.with_index([:a, :b, :c], 3)
      [a: 3, b: 4, c: 5]

      iex&gt; Enum.with_index([:a, :b, :c], fn element, index -&gt; {index, element} end)
      [{0, :a}, {1, :b}, {2, :c}]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">with_index</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">integer</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">term</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">integer</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">with_index</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">index</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">value</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">value</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">value: </span><span class="ahl-variable">any</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">with_index</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun_or_offset</span> <span class="ahl-operator">\\</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">with_index</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">offset</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">offset</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">with_index_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">offset</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">with_index</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">with_index_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">with_index</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">offset</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_integer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">offset</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">enumerable</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">map_reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">offset</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">i</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">i</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">i</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">with_index</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">enumerable</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">map_reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">i</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">i</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">i</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Zips corresponding elements from two enumerables into a list
  of tuples.

  Because a list of two-element tuples with atoms as the first
  tuple element is a keyword list (`Keyword`), zipping a first list
  of atoms with a second list of any kind creates a keyword list.

  The zipping finishes as soon as either enumerable completes.

  ## Examples

      iex&gt; Enum.zip([1, 2, 3], [:a, :b, :c])
      [{1, :a}, {2, :b}, {3, :c}]

      iex&gt; Enum.zip([:a, :b, :c], [1, 2, 3])
      [a: 1, b: 2, c: 3]

      iex&gt; Enum.zip([1, 2, 3, 4, 5], [:a, :b, :c])
      [{1, :a}, {2, :b}, {3, :c}]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">zip</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">any</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">any</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">zip</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">zip_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">zip</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">zip</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">enumerable1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Zips corresponding elements from a finite collection of enumerables
  into a list of tuples.

  The zipping finishes as soon as any enumerable in the given collection completes.

  ## Examples

      iex&gt; Enum.zip([[1, 2, 3], [:a, :b, :c], [&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;]])
      [{1, :a, &quot;foo&quot;}, {2, :b, &quot;bar&quot;}, {3, :c, &quot;baz&quot;}]

      iex&gt; Enum.zip([[1, 2, 3, 4, 5], [:a, :b, :c]])
      [{1, :a}, {2, :b}, {3, :c}]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.4.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">zip</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerables</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-function">tuple</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">enumerables: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-function">t</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">|</span> <span class="ahl-function">t</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">zip</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">zip</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerables</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">zip_reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerables</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-namespace">List</span><span class="ahl-operator">.</span><span class="ahl-function">to_tuple</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Zips corresponding elements from two enumerables into a list, transforming them with
  the `zip_fun` function as it goes.

  The corresponding elements from each collection are passed to the provided two-arity `zip_fun`
  function in turn. Returns a list that contains the result of calling `zip_fun` for each pair of
  elements.

  The zipping finishes as soon as either enumerable runs out of elements.

  ## Zipping Maps

  It&#x27;s important to remember that zipping inherently relies on order.
  If you zip two lists you get the element at the index from each list in turn.
  If we zip two maps together it&#x27;s tempting to think that you will get the given
  key in the left map and the matching key in the right map, but there is no such
  guarantee because map keys are not ordered! Consider the following:

      left =  %{:a =&gt; 1, 1 =&gt; 3}
      right = %{:a =&gt; 1, :b =&gt; :c}
      Enum.zip(left, right)
      # [{{1, 3}, {:a, 1}}, {{:a, 1}, {:b, :c}}]

  As you can see `:a` does not get paired with `:a`. If this is what you want,
  you should use `Map.merge&#x2f;3`.

  ## Examples

      iex&gt; Enum.zip_with([1, 2], [3, 4], fn x, y -&gt; x + y end)
      [4, 6]

      iex&gt; Enum.zip_with([1, 2], [3, 4, 5, 6], fn x, y -&gt; x + y end)
      [4, 6]

      iex&gt; Enum.zip_with([1, 2, 5, 6], [3, 4], fn x, y -&gt; x + y end)
      [4, 6]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.12.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">zip_with</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enum1_elem</span> <span class="ahl-operator">::</span> <span class="ahl-variable">term</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enum2_elem</span> <span class="ahl-operator">::</span> <span class="ahl-variable">term</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">zip_with</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">zip_fun</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">zip_fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">zip_with_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">zip_fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">zip_with</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">zip_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">zip_fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">zip_reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enumerable2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">l</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">r</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">zip_fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">l</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">r</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Zips corresponding elements from a finite collection of enumerables
  into list, transforming them with the `zip_fun` function as it goes.

  The first element from each of the enums in `enumerables` will be put
  into a list which is then passed to the one-arity `zip_fun` function.
  Then, the second elements from each of the enums are put into a list
  and passed to `zip_fun`, and so on until any one of the enums in
  `enumerables` runs out of elements.

  Returns a list with all the results of calling `zip_fun`.

  ## Examples

      iex&gt; Enum.zip_with([[1, 2], [3, 4], [5, 6]], fn [x, y, z] -&gt; x + y + z end)
      [9, 12]

      iex&gt; Enum.zip_with([[1, 2], [3, 4]], fn [x, y] -&gt; x + y end)
      [4, 6]

  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.12.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">zip_with</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">zip_with</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">zip_with</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerables</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">zip_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">zip_reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerables</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">values</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">zip_fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">values</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Reduces over two enumerables halting as soon as either enumerable is empty.

  In practice, the behavior provided by this function can be achieved with:

      Enum.reduce(Stream.zip(left, right), acc, reducer)

  But `zip_reduce&#x2f;4` exists for convenience purposes.

  ## Examples

      iex&gt; Enum.zip_reduce([1, 2], [3, 4], 0, fn x, y, acc -&gt; x + y + acc end)
      10

      iex&gt; Enum.zip_reduce([1, 2], [3, 4], [], fn x, y, acc -&gt; [x + y | acc] end)
      [6, 4]
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.12.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">zip_reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enum1_elem</span> <span class="ahl-operator">::</span> <span class="ahl-variable">term</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">enum2_elem</span> <span class="ahl-operator">::</span> <span class="ahl-variable">term</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">acc</span>
        <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">acc: </span><span class="ahl-variable">term</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">zip_reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">left</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">right</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reducer</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">left</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">right</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">and</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">reducer</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">3</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">zip_reduce_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">left</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">right</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reducer</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">zip_reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">left</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">right</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reducer</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">reducer</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">3</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">reduce</span> <span class="ahl-operator">=</span> <span class="ahl-keyword">fn</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">l</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">r</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reducer</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">l</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">r</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">end</span>
    <span class="ahl-namespace">Stream</span><span class="ahl-operator">.</span><span class="ahl-function">zip_with</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">left</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">right</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reduce</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment ahl-block ahl-documentation">@</span><span class="ahl-comment ahl-block ahl-documentation">doc</span> <span class="ahl-comment ahl-block ahl-documentation">&quot;&quot;&quot;
  Reduces over all of the given enumerables, halting as soon as any enumerable is
  empty.

  The reducer will receive 2 args: a list of elements (one from each enum) and the
  accumulator.

  In practice, the behavior provided by this function can be achieved with:

      Enum.reduce(Stream.zip(enums), acc, reducer)

  But `zip_reduce&#x2f;3` exists for convenience purposes.

  ## Examples

      iex&gt; enums = [[1, 1], [2, 2], [3, 3]]
      ...&gt;  Enum.zip_reduce(enums, [], fn elements, acc -&gt;
      ...&gt;    [List.to_tuple(elements) | acc]
      ...&gt; end)
      [{1, 2, 3}, {1, 2, 3}]

      iex&gt; enums = [[1, 2], [a: 3, b: 4], [5, 6]]
      ...&gt; Enum.zip_reduce(enums, [], fn elements, acc -&gt;
      ...&gt;   [List.to_tuple(elements) | acc]
      ...&gt; end)
      [{2, {:b, 4}, 6}, {1, {:a, 3}, 5}]
  &quot;&quot;&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">doc</span> <span class="ahl-string ahl-special ahl-symbol">since: </span><span class="ahl-string">&quot;1.12.0&quot;</span>
  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">spec</span> <span class="ahl-function">zip_reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">term</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">::</span> <span class="ahl-variable">acc</span> <span class="ahl-keyword">when</span> <span class="ahl-string ahl-special ahl-symbol">acc: </span><span class="ahl-variable">term</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">zip_reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reducer</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">reducer</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">acc</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">zip_reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enums</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reducer</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">reducer</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">Stream</span><span class="ahl-operator">.</span><span class="ahl-function">zip_with</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enums</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reducer</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## Helpers</span>

  <span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">compile</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:inline</span><span class="ahl-punctuation ahl-delimiter">,</span>
            <span class="ahl-string ahl-special ahl-symbol">entry_to_string: </span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span>
            <span class="ahl-string ahl-special ahl-symbol">reduce: </span><span class="ahl-constant ahl-numeric integer">3</span><span class="ahl-punctuation ahl-delimiter">,</span>
            <span class="ahl-string ahl-special ahl-symbol">reduce_by: </span><span class="ahl-constant ahl-numeric integer">3</span><span class="ahl-punctuation ahl-delimiter">,</span>
            <span class="ahl-string ahl-special ahl-symbol">reduce_enumerable: </span><span class="ahl-constant ahl-numeric integer">3</span><span class="ahl-punctuation ahl-delimiter">,</span>
            <span class="ahl-string ahl-special ahl-symbol">reduce_range: </span><span class="ahl-constant ahl-numeric integer">5</span><span class="ahl-punctuation ahl-delimiter">,</span>
            <span class="ahl-string ahl-special ahl-symbol">map_range: </span><span class="ahl-constant ahl-numeric integer">4</span><span class="ahl-punctuation ahl-bracket">}</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">entry_to_string</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_binary</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">entry</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">entry_to_string</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-namespace">String.Chars</span><span class="ahl-operator">.</span><span class="ahl-function">to_string</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">aggregate</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_empty</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">aggregate_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">head</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">aggregate</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">empty</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">aggregate</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-operator">..</span><span class="ahl-variable">last</span><span class="ahl-operator">&#x2f;&#x2f;</span><span class="ahl-variable">step</span> <span class="ahl-operator">=</span> <span class="ahl-variable">range</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">case</span> <span class="ahl-namespace">Range</span><span class="ahl-operator">.</span><span class="ahl-function">size</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">range</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">empty</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>

      <span class="ahl-comment">_</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">last</span> <span class="ahl-operator">=</span> <span class="ahl-variable">last</span> <span class="ahl-operator">-</span> <span class="ahl-function">rem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">last</span> <span class="ahl-operator">-</span> <span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span>

        <span class="ahl-keyword">case</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
          <span class="ahl-constant ahl-builtin boolean">true</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">first</span>
          <span class="ahl-constant ahl-builtin boolean">false</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">last</span>
        <span class="ahl-keyword">end</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">aggregate</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">ref</span> <span class="ahl-operator">=</span> <span class="ahl-function">make_ref</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-variable">enumerable</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">ref</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span>
      <span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">^</span><span class="ahl-variable">ref</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">element</span>

      <span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-keyword">case</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
          <span class="ahl-constant ahl-builtin boolean">true</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">acc</span>
          <span class="ahl-constant ahl-builtin boolean">false</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">element</span>
        <span class="ahl-keyword">end</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-keyword">case</span> <span class="ahl-keyword">do</span>
      <span class="ahl-operator">^</span><span class="ahl-variable">ref</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">empty</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-variable">result</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">result</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">aggregate_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">acc</span> <span class="ahl-operator">=</span>
      <span class="ahl-keyword">case</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">head</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
        <span class="ahl-constant ahl-builtin boolean">true</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">acc</span>
        <span class="ahl-constant ahl-builtin boolean">false</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">head</span>
      <span class="ahl-keyword">end</span>

    <span class="ahl-function">aggregate_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">aggregate_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">acc</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">aggregate_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">sorter</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">first_fun</span> <span class="ahl-operator">=</span> <span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span> <span class="ahl-operator">|</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>

    <span class="ahl-variable">reduce_fun</span> <span class="ahl-operator">=</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-comment">_</span> <span class="ahl-operator">|</span> <span class="ahl-variable">fun_ref</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">=</span> <span class="ahl-variable">old</span> <span class="ahl-operator">-&gt;</span>
      <span class="ahl-variable">fun_entry</span> <span class="ahl-operator">=</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span>

      <span class="ahl-keyword">case</span> <span class="ahl-variable">sorter</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun_ref</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun_entry</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
        <span class="ahl-constant ahl-builtin boolean">true</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">old</span>
        <span class="ahl-constant ahl-builtin boolean">false</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">fun_entry</span><span class="ahl-punctuation ahl-bracket">]</span>
      <span class="ahl-keyword">end</span>
    <span class="ahl-keyword">end</span>

    <span class="ahl-keyword">case</span> <span class="ahl-function">reduce_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first_fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">reduce_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-string ahl-special ahl-symbol">:empty</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">empty_fallback</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">entry</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reduce_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">foldl</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reduce_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-string ahl-special ahl-symbol">:empty</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reduce_by</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:empty</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span>
      <span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">:empty</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">first</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">element</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## Implementations</span>

  <span class="ahl-comment">## all?&#x2f;1</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">all_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">if</span> <span class="ahl-variable">h</span> <span class="ahl-keyword">do</span>
      <span class="ahl-function">all_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-constant ahl-builtin boolean">false</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">all_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-constant ahl-builtin boolean">true</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## any?&#x2f;1</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">any_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">if</span> <span class="ahl-variable">h</span> <span class="ahl-keyword">do</span>
      <span class="ahl-constant ahl-builtin boolean">true</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-function">any_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">any_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-constant ahl-builtin boolean">false</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## any?&#x2f;2 all?&#x2f;2</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">predicate_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">if</span> <span class="ahl-operator">!</span><span class="ahl-operator">!</span><span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">h</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">==</span> <span class="ahl-variable">initial</span> <span class="ahl-keyword">do</span>
      <span class="ahl-function">predicate_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-keyword">not</span> <span class="ahl-variable">initial</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">predicate_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">initial</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">predicate_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
       <span class="ahl-keyword">when</span> <span class="ahl-variable">step</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">first</span> <span class="ahl-operator">&lt;=</span> <span class="ahl-variable">last</span>
       <span class="ahl-keyword">when</span> <span class="ahl-variable">step</span> <span class="ahl-operator">&lt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">first</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-variable">last</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">if</span> <span class="ahl-operator">!</span><span class="ahl-operator">!</span><span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">==</span> <span class="ahl-variable">initial</span> <span class="ahl-keyword">do</span>
      <span class="ahl-function">predicate_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span> <span class="ahl-operator">+</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-keyword">not</span> <span class="ahl-variable">initial</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">predicate_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">initial</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">initial</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## concat</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">concat_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">h</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">h</span> <span class="ahl-operator">++</span> <span class="ahl-function">concat_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">concat_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">concat_enum</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">concat_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">concat_enum</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enum</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">fun</span> <span class="ahl-operator">=</span> <span class="ahl-operator">&amp;</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span> <span class="ahl-operator">|</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-bracket">]</span>
    <span class="ahl-variable">enum</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment"># dedup</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">dedup_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">value</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">acc</span> <span class="ahl-operator">=</span>
      <span class="ahl-keyword">case</span> <span class="ahl-variable">acc</span> <span class="ahl-keyword">do</span>
        <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-operator">^</span><span class="ahl-variable">value</span> <span class="ahl-operator">|</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">acc</span>
        <span class="ahl-comment">_</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">value</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span>
      <span class="ahl-keyword">end</span>

    <span class="ahl-function">dedup_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">dedup_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">acc</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## drop</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">drop_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">list</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">drop_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-comment">_</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">counter</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">drop_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">counter</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">drop_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-comment">## drop_while</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">drop_while_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">if</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-function">drop_while_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">drop_while_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## filter</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">filter_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">if</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-function">filter_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-function">filter_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">filter_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## find</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">find_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">if</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-variable">head</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-function">find_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">find_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">default</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## find_index</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">find_index_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">counter</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">if</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-variable">counter</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-function">find_index_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">counter</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">find_index_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-constant ahl-builtin">nil</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## find_value</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">find_value_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">||</span> <span class="ahl-function">find_value_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">find_value_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">default</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">default</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## flat_map</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">flat_map_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">case</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-variable">list</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">list</span> <span class="ahl-operator">++</span> <span class="ahl-function">flat_map_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-variable">other</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">other</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">++</span> <span class="ahl-function">flat_map_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">flat_map_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## intersperse</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">intersperse_non_empty_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_separator</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">intersperse_non_empty_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">separator</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">separator</span> <span class="ahl-operator">|</span> <span class="ahl-function">intersperse_non_empty_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">separator</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## join</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">join_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_joiner</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-string">&quot;&quot;</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">join_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">joiner</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">join_non_empty_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">joiner</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">IO</span><span class="ahl-operator">.</span><span class="ahl-function">iodata_to_binary</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">join_non_empty_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_joiner</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-function">entry_to_string</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">join_non_empty_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">first</span> <span class="ahl-operator">|</span> <span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">joiner</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">join_non_empty_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">joiner</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">joiner</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">entry_to_string</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## map</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">map_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
       <span class="ahl-keyword">when</span> <span class="ahl-variable">step</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">first</span> <span class="ahl-operator">&lt;=</span> <span class="ahl-variable">last</span>
       <span class="ahl-keyword">when</span> <span class="ahl-variable">step</span> <span class="ahl-operator">&lt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">first</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-variable">last</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-function">map_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span> <span class="ahl-operator">+</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">map_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## map_intersperse</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">map_intersperse_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
    <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">map_intersperse_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">last</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">mapper</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
    <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">mapper</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">last</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">map_intersperse_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">separator</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">mapper</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
    <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">mapper</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">separator</span> <span class="ahl-operator">|</span> <span class="ahl-function">map_intersperse_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">separator</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">mapper</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-comment">## reduce</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reduce_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
       <span class="ahl-keyword">when</span> <span class="ahl-variable">step</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">first</span> <span class="ahl-operator">&lt;=</span> <span class="ahl-variable">last</span>
       <span class="ahl-keyword">when</span> <span class="ahl-variable">step</span> <span class="ahl-operator">&lt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">and</span> <span class="ahl-variable">first</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-variable">last</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reduce_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span> <span class="ahl-operator">+</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reduce_range</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_first</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_last</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">acc</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reduce_enumerable</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## reject</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reject_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">if</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-function">reject_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-function">reject_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reject_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## reverse_slice</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reverse_slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">slice</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">head_slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">slice</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reverse_slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">elem</span> <span class="ahl-operator">|</span> <span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">idx</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">reverse_slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">idx</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">elem</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">head_slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-bracket">}</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">head_slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">elem</span> <span class="ahl-operator">|</span> <span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">head_slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">elem</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## scan</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">scan_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">scan_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">elem</span> <span class="ahl-operator">|</span> <span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">acc</span> <span class="ahl-operator">=</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">elem</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">acc</span> <span class="ahl-operator">|</span> <span class="ahl-function">scan_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">rest</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## slice</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slice_forward</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">start</span> <span class="ahl-operator">&lt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span> <span class="ahl-function">slice_count_and_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-variable">start</span> <span class="ahl-operator">=</span> <span class="ahl-variable">count</span> <span class="ahl-operator">+</span> <span class="ahl-variable">start</span>

    <span class="ahl-keyword">if</span> <span class="ahl-variable">start</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
      <span class="ahl-variable">amount</span> <span class="ahl-operator">=</span> <span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span> <span class="ahl-operator">-</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-variable">amount</span> <span class="ahl-operator">=</span> <span class="ahl-function">amount_with_step</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slice_forward</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">amount</span> <span class="ahl-operator">=</span> <span class="ahl-function">amount_with_step</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-function">slice_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slice_forward</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">case</span> <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">start</span> <span class="ahl-operator">&gt;=</span> <span class="ahl-variable">count</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">amount</span> <span class="ahl-operator">=</span> <span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span> <span class="ahl-operator">-</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">amount_with_step</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-variable">enumerable</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">slice_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span>

      <span class="ahl-comment"># TODO: Deprecate me in Elixir v1.18.</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">amount</span> <span class="ahl-operator">=</span> <span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span> <span class="ahl-operator">-</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-bracket">)</span>

        <span class="ahl-keyword">if</span> <span class="ahl-variable">step</span> <span class="ahl-operator">==</span> <span class="ahl-constant ahl-numeric integer">1</span> <span class="ahl-keyword">do</span>
          <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-keyword">else</span>
          <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span> <span class="ahl-operator">*</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span> <span class="ahl-operator">-</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
          <span class="ahl-operator">|&gt;</span> <span class="ahl-function">take_every_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-keyword">end</span>

      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">3</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-variable">amount</span> <span class="ahl-operator">=</span> <span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span> <span class="ahl-operator">-</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">amount_with_step</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span>
        <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span>

      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:error</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-function">slice_enum</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">module</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slice_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">if</span> <span class="ahl-variable">step</span> <span class="ahl-operator">==</span> <span class="ahl-constant ahl-numeric integer">1</span> <span class="ahl-keyword">do</span>
      <span class="ahl-variable">list</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">drop_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">take_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-variable">list</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">drop_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">take_every_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slice_enum</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">module</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">slice</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span>
      <span class="ahl-variable">module</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span>
        <span class="ahl-comment">_entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_list</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">start</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-operator">-&gt;</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">start</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>

        <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">1</span> <span class="ahl-operator">-&gt;</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>

        <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>
      <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">slice</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slice_enum</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">module</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">slice</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span>
      <span class="ahl-variable">module</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span>
        <span class="ahl-comment">_entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">to_drop</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_list</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">start</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-operator">-&gt;</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">start</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">to_drop</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>

        <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">to_drop</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">1</span> <span class="ahl-operator">-&gt;</span>
          <span class="ahl-keyword">case</span> <span class="ahl-variable">to_drop</span> <span class="ahl-keyword">do</span>
            <span class="ahl-constant ahl-numeric integer">1</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>
            <span class="ahl-comment">_</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">to_drop</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>
          <span class="ahl-keyword">end</span>

        <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">to_drop</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
          <span class="ahl-keyword">case</span> <span class="ahl-variable">to_drop</span> <span class="ahl-keyword">do</span>
            <span class="ahl-constant ahl-numeric integer">1</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">to_drop</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>
            <span class="ahl-comment">_</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">to_drop</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>
          <span class="ahl-keyword">end</span>
      <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">slice</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slice_count_and_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_step</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">length</span> <span class="ahl-operator">=</span> <span class="ahl-function">length</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">length</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-function">slice_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">3</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">length</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slice_count_and_fun</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">case</span> <span class="ahl-namespace">Enumerable</span><span class="ahl-operator">.</span><span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">3</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">}</span>

      <span class="ahl-comment"># TODO: Deprecate me in Elixir v1.18.</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-keyword">if</span> <span class="ahl-variable">step</span> <span class="ahl-operator">==</span> <span class="ahl-constant ahl-numeric integer">1</span> <span class="ahl-keyword">do</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">else</span>
          <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span>
           <span class="ahl-keyword">fn</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span> <span class="ahl-operator">-&gt;</span>
             <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">Kernel</span><span class="ahl-operator">.</span><span class="ahl-function">min</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span> <span class="ahl-operator">*</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span> <span class="ahl-operator">-</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">)</span>
             <span class="ahl-operator">|&gt;</span> <span class="ahl-function">take_every_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>
           <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">}</span>
        <span class="ahl-keyword">end</span>

      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-function">slice_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">enumerable</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">3</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>

      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:error</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">module</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">=</span>
          <span class="ahl-variable">enumerable</span>
          <span class="ahl-operator">|&gt;</span> <span class="ahl-variable">module</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-variable">elem</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span>
            <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">elem</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">}</span>
          <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">)</span>
          <span class="ahl-operator">|&gt;</span> <span class="ahl-function">elem</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>

        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">count</span><span class="ahl-punctuation ahl-delimiter">,</span>
         <span class="ahl-keyword">fn</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span> <span class="ahl-operator">-&gt;</span>
           <span class="ahl-variable">list</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">slice_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">count</span><span class="ahl-punctuation ahl-bracket">)</span>
         <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment"># Slice a list when we know the bounds</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">slice_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slice_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">size</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">start</span> <span class="ahl-operator">+</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">==</span> <span class="ahl-variable">size</span><span class="ahl-punctuation ahl-delimiter">,</span>
    <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">list</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">drop_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slice_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
    <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">list</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">drop_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">take_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">slice_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">start</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
    <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">list</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">drop_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">start</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">take_every_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">step</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">drop_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">list</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">drop_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-comment">_</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">drop_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-function">take_exact</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">amount</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-comment">## sort</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_reducer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:split</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">y</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">r</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">rs</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">cond</span> <span class="ahl-keyword">do</span>
      <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">y</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">==</span> <span class="ahl-variable">bool</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:split</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">y</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">x</span> <span class="ahl-operator">|</span> <span class="ahl-variable">r</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">rs</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">}</span>

      <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">==</span> <span class="ahl-variable">bool</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:split</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">y</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">x</span> <span class="ahl-operator">|</span> <span class="ahl-variable">r</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">rs</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">}</span>

      <span class="ahl-variable">r</span> <span class="ahl-operator">==</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:split</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">y</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">rs</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">}</span>

      <span class="ahl-constant ahl-builtin boolean">true</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:pivot</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">y</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">r</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">rs</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_reducer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:pivot</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">y</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">r</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">rs</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">s</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">cond</span> <span class="ahl-keyword">do</span>
      <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">y</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">==</span> <span class="ahl-variable">bool</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:pivot</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">y</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">x</span> <span class="ahl-operator">|</span> <span class="ahl-variable">r</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">rs</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">s</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">}</span>

      <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">==</span> <span class="ahl-variable">bool</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:pivot</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">y</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">x</span> <span class="ahl-operator">|</span> <span class="ahl-variable">r</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">rs</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">s</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">}</span>

      <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">s</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">==</span> <span class="ahl-variable">bool</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:split</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">s</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">y</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">x</span> <span class="ahl-operator">|</span> <span class="ahl-variable">r</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">|</span> <span class="ahl-variable">rs</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">}</span>

      <span class="ahl-constant ahl-builtin boolean">true</span> <span class="ahl-operator">-&gt;</span>
        <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:split</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">s</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">y</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">x</span> <span class="ahl-operator">|</span> <span class="ahl-variable">r</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">|</span> <span class="ahl-variable">rs</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_reducer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">x</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:split</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_reducer</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">entry</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">entry</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_terminator</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:split</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">y</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">r</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">rs</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">y</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">x</span> <span class="ahl-operator">|</span> <span class="ahl-variable">r</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">|</span> <span class="ahl-variable">rs</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_terminator</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:pivot</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">y</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">x</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">r</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">rs</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">s</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">s</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">y</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">x</span> <span class="ahl-operator">|</span> <span class="ahl-variable">r</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">|</span> <span class="ahl-variable">rs</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_terminator</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">acc</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">reverse_sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">t1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h2</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t2</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">|</span> <span class="ahl-variable">l</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
    <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">l</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-function">sort_merge1</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">h2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h2</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t1</span> <span class="ahl-operator">|</span> <span class="ahl-variable">l</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
    <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">l</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-function">sort_merge1</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">h2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">l</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_bool</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">l</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">l</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
    <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">reverse_sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">l</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">reverse_sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reverse_sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h2</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t1</span> <span class="ahl-operator">|</span> <span class="ahl-variable">l</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
    <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">reverse_sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">l</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-function">sort_merge1</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">h2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reverse_sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">t1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h2</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t2</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-operator">|</span> <span class="ahl-variable">l</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
    <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">reverse_sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">l</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-function">sort_merge1</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">h2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reverse_sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">l</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
    <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">l</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">reverse_sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">sort_merge</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_merge1</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h1</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t1</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">h2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">m</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">if</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">h1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">h2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">==</span> <span class="ahl-variable">bool</span> <span class="ahl-keyword">do</span>
      <span class="ahl-function">sort_merge2</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">h1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h2</span> <span class="ahl-operator">|</span> <span class="ahl-variable">m</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-function">sort_merge1</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">h2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h1</span> <span class="ahl-operator">|</span> <span class="ahl-variable">m</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_merge1</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">h2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">m</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_bool</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h2</span> <span class="ahl-operator">|</span> <span class="ahl-variable">m</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_merge2</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">h1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h2</span> <span class="ahl-operator">|</span> <span class="ahl-variable">t2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">m</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">if</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">h1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">h2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">==</span> <span class="ahl-variable">bool</span> <span class="ahl-keyword">do</span>
      <span class="ahl-function">sort_merge2</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">h1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h2</span> <span class="ahl-operator">|</span> <span class="ahl-variable">m</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-function">sort_merge1</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">h2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h1</span> <span class="ahl-operator">|</span> <span class="ahl-variable">m</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">bool</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">sort_merge2</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">h1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">t1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">m</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_bool</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">t1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">h1</span> <span class="ahl-operator">|</span> <span class="ahl-variable">m</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-comment">## split</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">split_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">counter</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">counter</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">split_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">counter</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">split_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">split_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">split_reverse_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">counter</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-variable">counter</span> <span class="ahl-operator">&gt;</span> <span class="ahl-constant ahl-numeric integer">0</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">split_reverse_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">counter</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">split_reverse_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">split_reverse_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## split_while</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">split_while_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">if</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-function">split_while_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">split_while_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## take</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">counter</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-function">take_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">counter</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_counter</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_every_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">to_drop</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
    <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">drop_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">to_drop</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">take_every_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">to_drop</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_every_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_to_drop</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_every_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_to_drop</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_every_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">counter</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">to_drop</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span>
    <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">drop_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">to_drop</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|&gt;</span> <span class="ahl-function">take_every_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">counter</span> <span class="ahl-operator">-</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">to_drop</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_every_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_counter</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_to_drop</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-comment">## take_while</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_while_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">if</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-function">take_while_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>
    <span class="ahl-keyword">else</span>
      <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">take_while_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## uniq</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">uniq_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">set</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">value</span> <span class="ahl-operator">=</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-bracket">)</span>

    <span class="ahl-keyword">case</span> <span class="ahl-variable">set</span> <span class="ahl-keyword">do</span>
      <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-operator">^</span><span class="ahl-variable">value</span> <span class="ahl-operator">=&gt;</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-function">uniq_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">set</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
      <span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-function">uniq_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-namespace">Map</span><span class="ahl-operator">.</span><span class="ahl-function">put</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">set</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">value</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">true</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>
    <span class="ahl-keyword">end</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">uniq_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_set</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-comment">## with_index</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">with_index_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">offset</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">offset</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-function">with_index_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">offset</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">with_index_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_offset</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">with_index_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">offset</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">offset</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-function">with_index_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">offset</span> <span class="ahl-operator">+</span> <span class="ahl-constant ahl-numeric integer">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">with_index_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_offset</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-comment">## zip</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">zip_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head1</span> <span class="ahl-operator">|</span> <span class="ahl-variable">next1</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head2</span> <span class="ahl-operator">|</span> <span class="ahl-variable">next2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">zip_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">next1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">next2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">head1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">head2</span><span class="ahl-punctuation ahl-bracket">}</span> <span class="ahl-operator">|</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">zip_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">zip_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-namespace">:lists</span><span class="ahl-operator">.</span><span class="ahl-function">reverse</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">zip_with_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head1</span> <span class="ahl-operator">|</span> <span class="ahl-variable">next1</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head2</span> <span class="ahl-operator">|</span> <span class="ahl-variable">next2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">head2</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-operator">|</span> <span class="ahl-function">zip_with_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">next1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">next2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">zip_with_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">zip_with_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">zip_reduce_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head1</span> <span class="ahl-operator">|</span> <span class="ahl-variable">next1</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head2</span> <span class="ahl-operator">|</span> <span class="ahl-variable">next2</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-function">zip_reduce_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">next1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">next2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">head2</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">defp</span> <span class="ahl-function">zip_reduce_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">acc</span>
  <span class="ahl-keyword">defp</span> <span class="ahl-function">zip_reduce_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">acc</span>
<span class="ahl-keyword">end</span>

<span class="ahl-keyword">defimpl</span> <span class="ahl-namespace">Enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">for: </span><span class="ahl-namespace">List</span> <span class="ahl-keyword">do</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">length</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">member?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_value</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">member?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_value</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:error</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin">__MODULE__</span><span class="ahl-punctuation ahl-bracket">}</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">0</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-keyword">fn</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_</span> <span class="ahl-operator">-&gt;</span> <span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span> <span class="ahl-keyword">end</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_list</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:error</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin">__MODULE__</span><span class="ahl-punctuation ahl-bracket">}</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halt</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:halted</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:suspend</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:suspended</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">list</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:done</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation ahl-bracket">[</span><span class="ahl-variable">head</span> <span class="ahl-operator">|</span> <span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-bracket">]</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:cont</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">tail</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">head</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
<span class="ahl-keyword">end</span>

<span class="ahl-keyword">defimpl</span> <span class="ahl-namespace">Enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">for: </span><span class="ahl-namespace">Map</span> <span class="ahl-keyword">do</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">map</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">map_size</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">map</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">member?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">map</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-variable">key</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">value</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-function">match?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-punctuation">%</span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-operator">^</span><span class="ahl-variable">key</span> <span class="ahl-operator">=&gt;</span> <span class="ahl-operator">^</span><span class="ahl-variable">value</span><span class="ahl-punctuation ahl-bracket">}</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">map</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">member?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_map</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_other</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin boolean">false</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">map</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-variable">size</span> <span class="ahl-operator">=</span> <span class="ahl-function">map_size</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">map</span><span class="ahl-punctuation ahl-bracket">)</span>
    <span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:ok</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">size</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-operator">&amp;</span><span class="ahl-namespace">:maps</span><span class="ahl-operator">.</span><span class="ahl-function">to_list</span><span class="ahl-operator">&#x2f;</span><span class="ahl-operator">1</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">end</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">map</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-namespace">Enumerable.List</span><span class="ahl-operator">.</span><span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-namespace">:maps</span><span class="ahl-operator">.</span><span class="ahl-function">to_list</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">map</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>
  <span class="ahl-keyword">end</span>
<span class="ahl-keyword">end</span>

<span class="ahl-keyword">defimpl</span> <span class="ahl-namespace">Enumerable</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">for: </span><span class="ahl-namespace">Function</span> <span class="ahl-keyword">do</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">count</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_function</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:error</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin">__MODULE__</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">member?</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_function</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_value</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:error</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin">__MODULE__</span><span class="ahl-punctuation ahl-bracket">}</span>
  <span class="ahl-keyword">def</span> <span class="ahl-function">slice</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-comment">_function</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-punctuation ahl-bracket">{</span><span class="ahl-string ahl-special ahl-symbol">:error</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-builtin">__MODULE__</span><span class="ahl-punctuation ahl-bracket">}</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">function</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">when</span> <span class="ahl-function">is_function</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">function</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-constant ahl-numeric integer">2</span><span class="ahl-punctuation ahl-bracket">)</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-string ahl-special ahl-symbol">do: </span><span class="ahl-variable">function</span><span class="ahl-operator">.</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-variable">fun</span><span class="ahl-punctuation ahl-bracket">)</span>

  <span class="ahl-keyword">def</span> <span class="ahl-function">reduce</span><span class="ahl-punctuation ahl-bracket">(</span><span class="ahl-variable">function</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_acc</span><span class="ahl-punctuation ahl-delimiter">,</span> <span class="ahl-comment">_fun</span><span class="ahl-punctuation ahl-bracket">)</span> <span class="ahl-keyword">do</span>
    <span class="ahl-keyword">raise</span> <span class="ahl-namespace">Protocol.UndefinedError</span><span class="ahl-punctuation ahl-delimiter">,</span>
      <span class="ahl-string ahl-special ahl-symbol">protocol: </span><span class="ahl-variable ahl-other ahl-member">@</span><span class="ahl-variable ahl-other ahl-member">protocol</span><span class="ahl-punctuation ahl-delimiter">,</span>
      <span class="ahl-string ahl-special ahl-symbol">value: </span><span class="ahl-variable">function</span><span class="ahl-punctuation ahl-delimiter">,</span>
      <span class="ahl-string ahl-special ahl-symbol">description: </span><span class="ahl-string">&quot;only anonymous functions of arity 2 are enumerable&quot;</span>
  <span class="ahl-keyword">end</span>
<span class="ahl-keyword">end</span>
</code></pre>
</body>
</html>
