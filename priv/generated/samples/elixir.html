<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Autumn Sample - elixir</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap" rel="stylesheet">
  <style>
    * {
      font-family: 'JetBrains Mono', monospace;
      font-size: 16px;
    }
    body {
      background-color: #282C34;
    }
  </style>
</head>
<body>
  <pre class="autumn highlight" class="background" style="background-color: #282C34; ">
<code class="language-elixir">
<span class="comment" style="font-style: italic; color: #5C6370; "># Use elixir_bootstrap module to be able to bootstrap Kernel.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "># The bootstrap module provides simpler implementations of the</span>
<span class="comment" style="font-style: italic; color: #5C6370; "># functions removed, simple enough to bootstrap.</span>
<span class="keyword" style="color: #E06C75; ">import</span> <span class="module" style="color: #61AFEF; ">Kernel</span><span class="text" style="color: #ABB2BF; ">,</span>
  <span class="string" style="color: #98C379; ">except: </span><span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">@: </span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">defmodule: </span><span class="text" style="color: #ABB2BF; ">2</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">def: </span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">def: </span><span class="text" style="color: #ABB2BF; ">2</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">defp: </span><span class="text" style="color: #ABB2BF; ">2</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">defmacro: </span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">defmacro: </span><span class="text" style="color: #ABB2BF; ">2</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">defmacrop: </span><span class="text" style="color: #ABB2BF; ">2</span><span class="text" style="color: #ABB2BF; ">]</span>

<span class="keyword" style="color: #E06C75; ">import</span> <span class="string" style="color: #98C379; ">:elixir_bootstrap</span>

<span class="keyword" style="color: #E06C75; ">defmodule</span> <span class="module" style="color: #61AFEF; ">Kernel</span> <span class="keyword" style="color: #E06C75; ">do</span>
  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">moduledoc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `Kernel` is Elixir&#39;s default environment.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It mainly consists of:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * basic language primitives, such as arithmetic operators, spawning of processes,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      data type handling, and others</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * macros for control-flow and defining new functionality (modules, functions, and the like)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * guard checks for augmenting pattern matching</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  You can invoke `Kernel` functions and macros anywhere in Elixir code</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  without the use of the `Kernel.` prefix since they have all been</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  automatically imported. For example, in IEx, you can call:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_number(13)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If you don&#39;t want to import a function or macro from `Kernel`, use the `:except`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  option and then list the function/macro by arity:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      import Kernel, except: [if: 2, unless: 2]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  See `import/2` for more information on importing.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Elixir also has special forms that are always imported and</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  cannot be skipped. These are described in `Kernel.SpecialForms`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## The standard library</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `Kernel` provides the basic capabilities the Elixir standard library</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  is built on top of. It is recommended to explore the standard library</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  for advanced functionality. Here are the main groups of modules in the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  standard library (this list is not a complete reference, see the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  documentation sidebar for all entries).</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ### Built-in types</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The following modules handle Elixir built-in data types:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Atom` - literal constants with a name (`true`, `false`, and `nil` are atoms)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Float` - numbers with floating point precision</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Function` - a reference to code chunk, created with the `fn/1` special form</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Integer` - whole numbers (not fractions)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `List` - collections of a variable number of elements (linked lists)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Map` - collections of key-value pairs</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Process` - light-weight threads of execution</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Port` - mechanisms to interact with the external world</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Tuple` - collections of a fixed number of elements</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  There are two data types without an accompanying module:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * Bitstring - a sequence of bits, created with `&lt;&lt;&gt;&gt;/1`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      When the number of bits is divisible by 8, they are called binaries and can</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      be manipulated with Erlang&#39;s `:binary` module</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * Reference - a unique value in the runtime system, created with `make_ref/0`</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ### Data types</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Elixir also provides other data types that are built on top of the types</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  listed above. Some of them are:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Date` - `year-month-day` structs in a given calendar</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `DateTime` - date and time with time zone in a given calendar</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Exception` - data raised from errors and unexpected scenarios</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `MapSet` - unordered collections of unique elements</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `NaiveDateTime` - date and time without time zone in a given calendar</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Keyword` - lists of two-element tuples, often representing optional values</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Range` - inclusive ranges between two integers</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Regex` - regular expressions</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `String` - UTF-8 encoded binaries representing characters</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Time` - `hour:minute:second` structs in a given calendar</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `URI` - representation of URIs that identify resources</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Version` - representation of versions and requirements</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ### System modules</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Modules that interface with the underlying system, such as:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `IO` - handles input and output</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `File` - interacts with the underlying file system</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Path` - manipulates file system paths</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `System` - reads and writes system information</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ### Protocols</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Protocols add polymorphic dispatch to Elixir. They are contracts</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  implementable by data types. See `Protocol` for more information on</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  protocols. Elixir provides the following protocols in the standard library:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Collectable` - collects data into a data type</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Enumerable` - handles collections in Elixir. The `Enum` module</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      provides eager functions for working with collections, the `Stream`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      module provides lazy functions</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Inspect` - converts data types into their programming language</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      representation</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `List.Chars` - converts data types to their outside world</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      representation as charlists (non-programming based)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `String.Chars` - converts data types to their outside world</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      representation as strings (non-programming based)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ### Process-based and application-centric functionality</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The following modules build on top of processes to provide concurrency,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  fault-tolerance, and more.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Agent` - a process that encapsulates mutable state</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Application` - functions for starting, stopping and configuring</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      applications</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `GenServer` - a generic client-server API</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Registry` - a key-value process-based storage</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Supervisor` - a process that is responsible for starting,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      supervising and shutting down other processes</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Task` - a process that performs computations</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `Task.Supervisor` - a supervisor for managing tasks exclusively</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ### Supporting documents</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Under the &quot;Pages&quot; section in sidebar you will find tutorials, guides,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and reference documents that outline Elixir semantics and behaviours</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  in more detail. Those are:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * [Compatibility and deprecations](compatibility-and-deprecations.md) - lists</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      compatibility between every Elixir version and Erlang/OTP, release schema;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      lists all deprecated functions, when they were deprecated and alternatives</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * [Library guidelines](library-guidelines.md) - general guidelines, anti-patterns,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      and rules for those writing libraries</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * [Naming conventions](naming-conventions.md) - naming conventions for Elixir code</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * [Operators reference](operators.md) - lists all Elixir operators and their precedences</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * [Patterns and guards](patterns-and-guards.md) - an introduction to patterns,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      guards, and extensions</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * [Syntax reference](syntax-reference.md) - the language syntax reference</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * [Typespecs reference](typespecs.md)- types and function specifications, including list of types</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * [Unicode syntax](unicode-syntax.md) - outlines Elixir support for Unicode</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Guards</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This module includes the built-in guards used by Elixir developers.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  They are a predefined set of functions and macros that augment pattern</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  matching, typically invoked after the `when` operator. For example:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      def drive(%User{age: age}) when age &gt;= 16 do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        ...</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The clause above will only be invoked if the user&#39;s age is more than</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  or equal to 16. Guards also support joining multiple conditions with</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `and` and `or`. The whole guard is true if all guard expressions will</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  evaluate to `true`. A more complete introduction to guards is available</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  in the [Patterns and guards](patterns-and-guards.md) page.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Truthy and falsy values</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Besides the booleans `true` and `false`, Elixir has the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  concept of a &quot;truthy&quot; or &quot;falsy&quot; value.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    *  a value is truthy when it is neither `false` nor `nil`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    *  a value is falsy when it is either `false` or `nil`</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Elixir has functions, like `and/2`, that *only* work with</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  booleans, but also functions that work with these</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  truthy/falsy values, like `&amp;&amp;/2` and `!/1`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Structural comparison</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The functions in this module perform structural comparison. This allows</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  different data types to be compared using comparison operators:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ```elixir</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  iex&gt; 1 &lt; :an_atom</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  true</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ```</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This is possible so Elixir developers can create collections, such as</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  dictionaries and ordered sets, that store a mixture of data types in them.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  To understand why this matters, let&#39;s discuss the two types of comparisons</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  we find in software: _structural_ and _semantic_.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Structural means we are comparing the underlying data structures and we often</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  want those operations to be as fast as possible, because it is used to power</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  several algorithms and data structures in the language. A semantic comparison</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  worries about what each data type represents. For example, semantically</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  speaking, it doesn&#39;t make sense to compare `Time` with `Date`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  One example that shows the differences between structural and semantic</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  comparisons are strings: &quot;alien&quot; sorts less than &quot;office&quot; (`&quot;alien&quot; &lt; &quot;office&quot;`)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  but &quot;Ã¡lien&quot; is greater than &quot;office&quot;. This happens because `&lt;` compares the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  underlying bytes that form the string. If you were doing alphabetical listing,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  you may want &quot;Ã¡lien&quot; to also appear before &quot;office&quot;.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This means **comparisons in Elixir are structural**, as it has the goal</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  of comparing data types as efficiently as possible to create flexible</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and performant data structures. This distinction is specially important</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  for functions that provide ordering, such as `&gt;/2`, `&lt;/2`, `&gt;=/2`,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `&lt;=/2`, `min/2`, and `max/2`. For example:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~D[2017-03-31] &gt; ~D[2017-04-01]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  will return `true` because structural comparison compares the `:day`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  field before `:month` or `:year`. In order to perform semantic comparisons,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the relevant data-types provide a `compare/2` function, such as</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `Date.compare/2`:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Date.compare(~D[2017-03-31], ~D[2017-04-01])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      :lt</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Alternatively, you can use the functions in the `Enum` module to</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  sort or compute a maximum/minimum:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Enum.sort([~D[2017-03-31], ~D[2017-04-01]], Date)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [~D[2017-03-31], ~D[2017-04-01]]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Enum.max([~D[2017-03-31], ~D[2017-04-01]], Date)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~D[2017-04-01]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The second argument is precisely the module to be used for semantic</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  comparison. Keeping this distinction is important, because if semantic</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  comparison was used by default for implementing data structures and</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  algorithms, they could become orders of magnitude slower!</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Finally, note there is an overall structural sorting order, called</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;Term Ordering&quot;, defined below. This order is provided for reference</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  purposes, it is not required by Elixir developers to know it by heart.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ### Term ordering</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ```</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  number &lt; atom &lt; reference &lt; function &lt; port &lt; pid &lt; tuple &lt; map &lt; list &lt; bitstring</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ```</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  When comparing two numbers of different types (a number being either</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  an integer or a float), a conversion to the type with greater precision</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  will always occur, unless the comparison operator used is either `===/2`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  or `!==`. A float will be considered more precise than an integer, unless</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the float is greater/less than +/-9007199254740992.0 respectively,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  at which point all the significant figures of the float are to the left</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  of the decimal point. This behavior exists so that the comparison of large</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  numbers remains transitive.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The collection types are compared using the following rules:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  * Tuples are compared by size, then element by element.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  * Maps are compared by size, then by keys in ascending term order,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    then by values in key order. In the specific case of maps&#39; key</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    ordering, integers are always considered to be less than floats.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  * Lists are compared element by element.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  * Bitstrings are compared byte by byte, incomplete bytes are compared bit by bit.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  * Atoms are compared using their string value, codepoint by codepoint.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ### Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  We can check the truthiness of a value by using the `!/1`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  function twice.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Truthy values:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; !!true</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; !!5</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; !![1,2]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; !!&quot;foo&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Falsy values (of which there are exactly two):</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; !!false</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; !!nil</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Inlining</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Some of the functions described in this module are inlined by</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the Elixir compiler into their Erlang counterparts in the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  [`:erlang`](`:erlang`) module.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Those functions are called BIFs (built-in internal functions)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  in Erlang-land and they exhibit interesting properties, as some</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  of them are allowed in guards and others are used for compiler</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  optimizations.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Most of the inlined functions can be seen in effect when</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  capturing the function:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; &amp;Kernel.is_atom/1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &amp;:erlang.is_atom/1</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Those functions will be explicitly marked in their docs as</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;inlined by the compiler&quot;.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>

  <span class="comment" style="font-style: italic; color: #5C6370; "># We need this check only for bootstrap purposes.</span>
  <span class="comment" style="font-style: italic; color: #5C6370; "># Once Kernel is loaded and we recompile, it is a no-op.</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">compile</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:inline</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">bootstrapped?: </span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">case</span> <span class="module" style="color: #61AFEF; ">:code</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">ensure_loaded</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Kernel</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
      <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">bootstrapped?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="constant" style="color: #56B6C2; ">true</span>

    <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:error</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
      <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">bootstrapped?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">:code</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">ensure_loaded</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">## Delegations to Erlang with inlining (macros)</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns an integer or float which is the arithmetical absolute value of `number`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; abs(-3.33)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      3.33</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; abs(-3)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      3</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">abs</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">number</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">number</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">abs</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">number</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">abs</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">number</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Invokes the given anonymous function `fun` with the list of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  arguments `args`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the number of arguments is known at compile time, prefer</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `fun.(arg_1, arg_2, ..., arg_n)` as it is clearer than</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `apply(fun, [arg_1, arg_2, ..., arg_n])`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; apply(fn x -&gt; x * 2 end, [2])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      4</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">apply</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">any</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">any</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">apply</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">apply</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Invokes the given function from `module` with the list of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  arguments `args`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `apply/3` is used to invoke functions where the module, function</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  name or arguments are defined dynamically at runtime. For this</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  reason, you can&#39;t invoke macros using `apply/3`, only functions.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the number of arguments and the function name are known at compile time,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  prefer `module.function(arg_1, arg_2, ..., arg_n)` as it is clearer than</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `apply(module, :function, [arg_1, arg_2, ..., arg_n])`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `apply/3` cannot be used to call private functions.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; apply(Enum, :reverse, [[1, 2, 3]])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [3, 2, 1]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">apply</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">function_name</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">atom</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">any</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">any</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">apply</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">function_name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">apply</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">function_name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Extracts the part of the binary at `start` with `size`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If `start` or `size` reference in any way outside the binary,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  an `ArgumentError` exception is raised.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_part(&quot;foo&quot;, 1, 2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;oo&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  A negative `size` can be used to extract bytes that come *before* the byte</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  at `start`:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_part(&quot;Hello&quot;, 5, -3)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;llo&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  An `ArgumentError` is raised when the size is outside of the binary:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      binary_part(&quot;Hello&quot;, 0, 10)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (ArgumentError) argument error</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">binary_part</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">non_neg_integer</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">integer</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">binary</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">binary_part</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">start</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">length</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">binary_part</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">start</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">length</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns an integer which is the size in bits of `bitstring`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; bit_size(&lt;&lt;433::16, 3::3&gt;&gt;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      19</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; bit_size(&lt;&lt;1, 2, 3&gt;&gt;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      24</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">bit_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">bitstring</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">non_neg_integer</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">bit_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">bitstring</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">bit_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">bitstring</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns the number of bytes needed to contain `bitstring`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  That is, if the number of bits in `bitstring` is not divisible by 8, the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  resulting number of bytes will be rounded up (by excess). This operation</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  happens in constant time.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; byte_size(&lt;&lt;433::16, 3::3&gt;&gt;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      3</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; byte_size(&lt;&lt;1, 2, 3&gt;&gt;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      3</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">byte_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">bitstring</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">non_neg_integer</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">byte_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">bitstring</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">byte_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">bitstring</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns the smallest integer greater than or equal to `number`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If you want to perform ceil operation on other decimal places,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  use `Float.ceil/2` instead.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ceil(10)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      10</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ceil(10.1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      11</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ceil(-10.1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      -10</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.8.0&quot;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">ceil</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">number</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">integer</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">ceil</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">number</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">ceil</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">number</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Performs an integer division.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Raises an `ArithmeticError` exception if one of the arguments is not an</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  integer, or when the `divisor` is `0`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `div/2` performs *truncated* integer division. This means that</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the result is always rounded towards zero.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If you want to perform floored integer division (rounding towards negative infinity),</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  use `Integer.floor_div/2` instead.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      div(5, 2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      div(6, -4)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; -1</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      div(-99, 2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; -49</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      div(100, 0)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (ArithmeticError) bad argument in arithmetic expression</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">div</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">integer</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">neg_integer</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">pos_integer</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">integer</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">div</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">dividend</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">divisor</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">div</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">dividend</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">divisor</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Stops the execution of the calling process with the given reason.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Since evaluating this function causes the process to terminate,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  it has no return value.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  When a process reaches its end, by default it exits with</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  reason `:normal`. You can also call `exit/1` explicitly if you</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  want to terminate a process but not signal any failure:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      exit(:normal)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In case something goes wrong, you can also use `exit/1` with</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  a different reason:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      exit(:seems_bad)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the exit reason is not `:normal`, all the processes linked to the process</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  that exited will crash (unless they are trapping exits).</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## OTP exits</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Exits are used by the OTP to determine if a process exited abnormally</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  or not. The following exits are considered &quot;normal&quot;:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `exit(:normal)`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `exit(:shutdown)`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `exit({:shutdown, term})`</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Exiting with any other reason is considered abnormal and treated</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  as a crash. This means the default supervisor behaviour kicks in,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  error reports are emitted, and so forth.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This behaviour is relied on in many different places. For example,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `ExUnit` uses `exit(:shutdown)` when exiting the test process to</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  signal linked processes, supervision trees and so on to politely</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  shut down too.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## CLI exits</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Building on top of the exit signals mentioned above, if the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  process started by the command line exits with any of the three</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  reasons above, its exit is considered normal and the Operating</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  System process will exit with status 0.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It is, however, possible to customize the operating system exit</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  signal by invoking:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      exit({:shutdown, integer})</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This will cause the operating system process to exit with the status given by</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `integer` while signaling all linked Erlang processes to politely</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  shut down.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Any other exit reason will cause the operating system process to exit with</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  status `1` and linked Erlang processes to crash.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">exit</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">no_return</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">exit</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">reason</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">exit</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">reason</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns the largest integer smaller than or equal to `number`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If you want to perform floor operation on other decimal places,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  use `Float.floor/2` instead.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; floor(10)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      10</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; floor(9.7)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      9</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; floor(-9.7)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      -10</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.8.0&quot;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">floor</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">number</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">integer</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">floor</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">number</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">floor</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">number</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns the head of a list. Raises `ArgumentError` if the list is empty.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The head of a list is its first element.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It works with improper lists.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      hd([1, 2, 3, 4])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; 1</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      hd([1 | 2])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; 1</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Giving it an empty list raises:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      hd([])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (ArgumentError) argument error</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">hd</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">nonempty_maybe_improper_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">elem</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">any</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">elem</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="string" style="color: #98C379; ">elem: </span><span class="text" style="color: #ABB2BF; ">term</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">hd</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">hd</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is an atom; otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_atom(false)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_atom(:name)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_atom(AnAtom)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_atom(&quot;true&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is a binary; otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  A binary always contains a complete number of bytes.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_binary(&quot;foo&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_binary(&lt;&lt;1::3&gt;&gt;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is a bitstring (including a binary); otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_bitstring(&quot;foo&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_bitstring(&lt;&lt;1::3&gt;&gt;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">is_bitstring</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">is_bitstring</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_bitstring</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is either the atom `true` or the atom `false` (i.e.,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  a boolean); otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_boolean(false)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_boolean(true)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_boolean(:test)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">is_boolean</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">is_boolean</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_boolean</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is a floating-point number; otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">is_float</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">is_float</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_float</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is a function; otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_function(fn x -&gt; x + x end)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_function(&quot;not a function&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">is_function</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">is_function</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_function</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is a function that can be applied with `arity` number of arguments;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_function(fn x -&gt; x * 2 end, 1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_function(fn x -&gt; x * 2 end, 2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">is_function</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">non_neg_integer</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">is_function</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arity</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_function</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arity</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is an integer; otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is a list with zero or more elements; otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">is_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">is_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is either an integer or a floating-point number;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">is_number</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">is_number</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_number</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is a PID (process identifier); otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">is_pid</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">is_pid</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_pid</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is a port identifier; otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">is_port</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">is_port</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_port</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is a reference; otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">is_reference</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">is_reference</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_reference</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is a tuple; otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">is_tuple</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">is_tuple</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_tuple</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is a map; otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">is_map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">is_map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `key` is a key in `map`; otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It raises `BadMapError` if the first element is not a map.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_map_key(%{a: &quot;foo&quot;, b: &quot;bar&quot;}, :a)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_map_key(%{a: &quot;foo&quot;, b: &quot;bar&quot;}, :c)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.10.0&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">is_map_key</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">map</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">is_map_key</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">map</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_map_key</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">map</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns the length of `list`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; length([1, 2, 3, 4, 5, 6, 7, 8, 9])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      9</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">length</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">non_neg_integer</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">length</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">length</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns an almost unique reference.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The returned reference will re-occur after approximately 2^82 calls;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  therefore it is unique enough for practical purposes.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      make_ref()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; #Reference&lt;0.0.0.135&gt;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">make_ref</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">reference</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">make_ref</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">make_ref</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns the size of a map.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The size of a map is the number of key-value pairs that the map contains.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This operation happens in constant time.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; map_size(%{a: &quot;foo&quot;, b: &quot;bar&quot;})</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      2</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">map_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">map</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">non_neg_integer</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">map_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">map</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">map</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns the biggest of the two given terms according to</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  their structural comparison.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the terms compare equal, the first one is returned.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This performs a structural comparison where all Elixir</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  terms can be compared with each other. See the [&quot;Structural</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  comparison&quot; section](#module-structural-comparison) section</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; max(1, 2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; max(:a, :b)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      :b</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">max</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">second</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">first</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">second</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="string" style="color: #98C379; ">first: </span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">second: </span><span class="text" style="color: #ABB2BF; ">term</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">max</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">second</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">max</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">second</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns the smallest of the two given terms according to</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  their structural comparison.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the terms compare equal, the first one is returned.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This performs a structural comparison where all Elixir</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  terms can be compared with each other. See the [&quot;Structural</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  comparison&quot; section](#module-structural-comparison) section</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; min(1, 2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; min(&quot;foo&quot;, &quot;bar&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;bar&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">min</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">second</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">first</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">second</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="string" style="color: #98C379; ">first: </span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">second: </span><span class="text" style="color: #ABB2BF; ">term</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">min</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">second</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">min</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">second</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns an atom representing the name of the local node.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the node is not alive, `:nonode@nohost` is returned instead.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">node</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">node</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">node</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">node</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns the node where the given argument is located.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The argument can be a PID, a reference, or a port.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the local node is not alive, `:nonode@nohost` is returned.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">node</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">pid</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">reference</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">port</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">node</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">node</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">node</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Computes the remainder of an integer division.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `rem/2` uses truncated division, which means that</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the result will always have the sign of the `dividend`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Raises an `ArithmeticError` exception if one of the arguments is not an</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  integer, or when the `divisor` is `0`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; rem(5, 2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; rem(6, -4)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      2</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">rem</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">integer</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">neg_integer</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">pos_integer</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">integer</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">rem</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">dividend</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">divisor</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">rem</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">dividend</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">divisor</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Rounds a number to the nearest integer.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the number is equidistant to the two nearest integers, rounds away from zero.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; round(5.6)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      6</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; round(5.2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      5</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; round(-9.9)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      -10</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; round(-9)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      -9</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; round(2.5)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      3</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; round(-2.5)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      -3</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">round</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">number</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">integer</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">round</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">number</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">round</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">number</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Sends a message to the given `dest` and returns the message.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `dest` may be a remote or local PID, a local port, a locally</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  registered name, or a tuple in the form of `{registered_name, node}` for a</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  registered name at another node.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; send(self(), :hello)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      :hello</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">send</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">dest</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="module" style="color: #61AFEF; ">Process</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">dest</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">message</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">message</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="string" style="color: #98C379; ">message: </span><span class="text" style="color: #ABB2BF; ">any</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">send</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">dest</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">message</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">send</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">dest</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">message</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns the PID (process identifier) of the calling process.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard clauses. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">self</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">pid</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">self</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">self</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Spawns the given function and returns its PID.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Typically developers do not use the `spawn` functions, instead they use</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  abstractions such as `Task`, `GenServer` and `Agent`, built on top of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `spawn`, that spawns processes with more conveniences in terms of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  introspection and debugging.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Check the `Process` module for more process-related functions.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The anonymous function receives 0 arguments, and may return any value.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      current = self()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      child = spawn(fn -&gt; send(current, {self(), 1 + 2}) end)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      receive do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        {^child, 3} -&gt; IO.puts(&quot;Received 3 back&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">spawn</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">any</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">pid</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">spawn</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">spawn</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Spawns the given function `fun` from the given `module` passing it the given</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `args` and returns its PID.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Typically developers do not use the `spawn` functions, instead they use</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  abstractions such as `Task`, `GenServer` and `Agent`, built on top of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `spawn`, that spawns processes with more conveniences in terms of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  introspection and debugging.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Check the `Process` module for more process-related functions.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      spawn(SomeModule, :function, [1, 2, 3])</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">spawn</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">atom</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">pid</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">spawn</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">spawn</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Spawns the given function, links it to the current process, and returns its PID.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Typically developers do not use the `spawn` functions, instead they use</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  abstractions such as `Task`, `GenServer` and `Agent`, built on top of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `spawn`, that spawns processes with more conveniences in terms of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  introspection and debugging.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Check the `Process` module for more process-related functions. For more</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  information on linking, check `Process.link/1`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The anonymous function receives 0 arguments, and may return any value.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      current = self()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      child = spawn_link(fn -&gt; send(current, {self(), 1 + 2}) end)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      receive do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        {^child, 3} -&gt; IO.puts(&quot;Received 3 back&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">spawn_link</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">any</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">pid</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">spawn_link</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">spawn_link</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Spawns the given function `fun` from the given `module` passing it the given</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `args`, links it to the current process, and returns its PID.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Typically developers do not use the `spawn` functions, instead they use</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  abstractions such as `Task`, `GenServer` and `Agent`, built on top of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `spawn`, that spawns processes with more conveniences in terms of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  introspection and debugging.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Check the `Process` module for more process-related functions. For more</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  information on linking, check `Process.link/1`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      spawn_link(SomeModule, :function, [1, 2, 3])</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">spawn_link</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">atom</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">pid</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">spawn_link</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">spawn_link</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Spawns the given function, monitors it and returns its PID</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and monitoring reference.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Typically developers do not use the `spawn` functions, instead they use</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  abstractions such as `Task`, `GenServer` and `Agent`, built on top of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `spawn`, that spawns processes with more conveniences in terms of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  introspection and debugging.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Check the `Process` module for more process-related functions.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The anonymous function receives 0 arguments, and may return any value.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      current = self()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      spawn_monitor(fn -&gt; send(current, {self(), 1 + 2}) end)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">spawn_monitor</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">any</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">pid</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">reference</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">spawn_monitor</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">spawn_monitor</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Spawns the given module and function passing the given args,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  monitors it and returns its PID and monitoring reference.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Typically developers do not use the `spawn` functions, instead they use</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  abstractions such as `Task`, `GenServer` and `Agent`, built on top of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `spawn`, that spawns processes with more conveniences in terms of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  introspection and debugging.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Check the `Process` module for more process-related functions.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      spawn_monitor(SomeModule, :function, [1, 2, 3])</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">spawn_monitor</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">atom</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">pid</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">reference</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">spawn_monitor</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">spawn_monitor</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Pipes the first argument, `value`, into the second argument, a function `fun`,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and returns `value` itself.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Useful for running synchronous side effects in a pipeline, using the `|&gt;/2` operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; tap(1, fn x -&gt; x + 1 end)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      1</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Most commonly, this is used in pipelines, using the `|&gt;/2` operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  For example, let&#39;s suppose you want to inspect part of a data structure.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  You could write:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      %{a: 1}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      |&gt; Map.update!(:a, &amp; &amp;1 + 2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      |&gt; tap(&amp;IO.inspect(&amp;1.a))</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      |&gt; Map.update!(:a, &amp; &amp;1 * 2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.12.0&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">tap</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="string" style="color: #98C379; ">bind_quoted: </span><span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">fun: </span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">value: </span><span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="text" style="color: #ABB2BF; ">value</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  A non-local return from a function.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Using `throw/1` is generally discouraged, as it allows a function</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  to escape from its regular execution flow, which can make the code</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  harder to read. Furthermore, all thrown values must be caught by</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `try/catch`. See `try/1` for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="keyword" style="color: #E06C75; ">throw</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">no_return</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="keyword" style="color: #E06C75; ">throw</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">throw</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns the tail of a list. Raises `ArgumentError` if the list is empty.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The tail of a list is the list without its first element.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It works with improper lists.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      tl([1, 2, 3, :go])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; [2, 3, :go]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      tl([:one])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; []</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      tl([:a, :b | :improper_end])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; [:b | :improper_end]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      tl([:a | %{b: 1}])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; %{b: 1}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Giving it an empty list raises:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      tl([])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (ArgumentError) argument error</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">tl</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">nonempty_maybe_improper_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">elem</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="function" style="color: #61AFEF; ">maybe_improper_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">elem</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">last</span>
        <span class="keyword" style="color: #E06C75; ">when</span> <span class="string" style="color: #98C379; ">elem: </span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">last: </span><span class="text" style="color: #ABB2BF; ">term</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">tl</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">tl</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns the integer part of `number`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; trunc(5.4)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      5</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; trunc(-5.99)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      -5</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; trunc(-5)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      -5</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">trunc</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">number</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">integer</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">trunc</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">number</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">trunc</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">number</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns the size of a tuple.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This operation happens in constant time.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; tuple_size({:a, :b, :c})</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      3</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">tuple_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">tuple</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">non_neg_integer</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">tuple_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">tuple</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">tuple_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">tuple</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Arithmetic addition operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 1 + 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      3</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">+</span> <span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">integer</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">+</span> <span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">float</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">+</span> <span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">float</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">+</span> <span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">float</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">+</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">+</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Arithmetic subtraction operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 1 - 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      -1</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">-</span> <span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">integer</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">-</span> <span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">float</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">-</span> <span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">float</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">-</span> <span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">float</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">-</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">-</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Arithmetic positive unary operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; +1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      1</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="operator" style="color: #C678DD; ">+</span><span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">integer</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="operator" style="color: #C678DD; ">+</span><span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">float</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="operator" style="color: #C678DD; ">+</span><span class="text" style="color: #ABB2BF; ">value</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">+</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Arithmetic negative unary operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; -2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      -2</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="operator" style="color: #C678DD; ">-</span><span class="text" style="color: #ABB2BF; ">0</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">0</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="operator" style="color: #C678DD; ">-</span><span class="text" style="color: #ABB2BF; ">pos_integer</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">neg_integer</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="operator" style="color: #C678DD; ">-</span><span class="text" style="color: #ABB2BF; ">neg_integer</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">pos_integer</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="operator" style="color: #C678DD; ">-</span><span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">float</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="operator" style="color: #C678DD; ">-</span><span class="text" style="color: #ABB2BF; ">value</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">-</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Arithmetic multiplication operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 1 * 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      2</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">*</span> <span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">integer</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">*</span> <span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">float</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">*</span> <span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">float</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">*</span> <span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">float</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">*</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">*</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Arithmetic division operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The result is always a float. Use `div/2` and `rem/2` if you want</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  an integer division or the remainder.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Raises `ArithmeticError` if `right` is 0 or 0.0.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      1 / 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; 0.5</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      -3.0 / 2.0</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; -1.5</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      5 / 1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; 5.0</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      7 / 0</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (ArithmeticError) bad argument in arithmetic expression</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">number</span> <span class="operator" style="color: #C678DD; ">/</span> <span class="text" style="color: #ABB2BF; ">number</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">float</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">/</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">/</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  List concatenation operator. Concatenates a proper list and a term, returning a list.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The complexity of `a ++ b` is proportional to `length(a)`, so avoid repeatedly</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  appending to lists of arbitrary length, for example, `list ++ [element]`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Instead, consider prepending via `[element | rest]` and then reversing.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the `right` operand is not a proper list, it returns an improper list.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the `left` operand is not a proper list, it raises `ArgumentError`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; [1] ++ [2, 3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [1, 2, 3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~c&quot;foo&quot; ++ ~c&quot;bar&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~c&quot;foobar&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      # a non-list on the right will return an improper list</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      # with said element at the end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; [1, 2] ++ 3</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [1, 2 | 3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; [1, 2] ++ {3, 4}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [1, 2 | {3, 4}]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      # improper list on the right will return an improper list</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; [1] ++ [2 | 3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [1, 2 | 3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The `++/2` operator is right associative, meaning:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; [1, 2, 3] -- [1] ++ [2]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  As it is equivalent to:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; [1, 2, 3] -- ([1] ++ [2])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">list</span> <span class="operator" style="color: #C678DD; ">++</span> <span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">maybe_improper_list</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">++</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">++</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  List subtraction operator. Removes the first occurrence of an element</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  on the left list for each element on the right.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This function is optimized so the complexity of `a -- b` is proportional</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  to `length(a) * log(length(b))`. See also the [Erlang efficiency</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  guide](https://www.erlang.org/doc/efficiency_guide/retired_myths.html).</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; [1, 2, 3] -- [1, 2]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; [1, 2, 3, 2, 1] -- [1, 2, 2]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [3, 1]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The `--/2` operator is right associative, meaning:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; [1, 2, 3] -- [2] -- [3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [1, 3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  As it is equivalent to:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; [1, 2, 3] -- ([2] -- [3])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [1, 3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">list</span> <span class="operator" style="color: #C678DD; ">--</span> <span class="text" style="color: #ABB2BF; ">list</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">list</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">--</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">--</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Strictly boolean &quot;not&quot; operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `value` must be a boolean; if it&#39;s not, an `ArgumentError` exception is raised.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; not false</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="keyword" style="color: #E06C75; ">not</span> <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="constant" style="color: #56B6C2; ">false</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="keyword" style="color: #E06C75; ">not</span> <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="constant" style="color: #56B6C2; ">true</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="keyword" style="color: #E06C75; ">not</span> <span class="text" style="color: #ABB2BF; ">value</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">not</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Less-than operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `left` is less than `right`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This performs a structural comparison where all Elixir</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  terms can be compared with each other. See the [&quot;Structural</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  comparison&quot; section](#module-structural-comparison) section</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 1 &lt; 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">&lt;</span> <span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">&lt;</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">&lt;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Greater-than operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `left` is more than `right`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This performs a structural comparison where all Elixir</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  terms can be compared with each other. See the [&quot;Structural</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  comparison&quot; section](#module-structural-comparison) section</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 1 &gt; 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">&gt;</span> <span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">&gt;</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">&gt;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Less-than or equal to operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `left` is less than or equal to `right`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This performs a structural comparison where all Elixir</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  terms can be compared with each other. See the [&quot;Structural</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  comparison&quot; section](#module-structural-comparison) section</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 1 &lt;= 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">&lt;=</span> <span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">&lt;=</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="string" style="color: #98C379; ">&quot;=&lt;&quot;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Greater-than or equal to operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `left` is more than or equal to `right`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This performs a structural comparison where all Elixir</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  terms can be compared with each other. See the [&quot;Structural</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  comparison&quot; section](#module-structural-comparison) section</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 1 &gt;= 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">&gt;=</span> <span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">&gt;=</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">&gt;=</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Equal to operator. Returns `true` if the two terms are equal.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This operator considers 1 and 1.0 to be equal. For stricter</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  semantics, use `===/2` instead.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This performs a structural comparison where all Elixir</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  terms can be compared with each other. See the [&quot;Structural</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  comparison&quot; section](#module-structural-comparison) section</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 1 == 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 1 == 1.0</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">==</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Not equal to operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if the two terms are not equal.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This operator considers 1 and 1.0 to be equal. For match</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  comparison, use `!==/2` instead.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This performs a structural comparison where all Elixir</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  terms can be compared with each other. See the [&quot;Structural</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  comparison&quot; section](#module-structural-comparison) section</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 1 != 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 1 != 1.0</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">!=</span> <span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">!=</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="string" style="color: #98C379; ">&quot;/=&quot;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Strictly equal to operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if the two terms are exactly equal.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The terms are only considered to be exactly equal if they</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  have the same value and are of the same type. For example,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `1 == 1.0` returns `true`, but since they are of different</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  types, `1 === 1.0` returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This performs a structural comparison where all Elixir</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  terms can be compared with each other. See the [&quot;Structural</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  comparison&quot; section](#module-structural-comparison) section</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 1 === 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 1 === 1.0</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">===</span> <span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">===</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="string" style="color: #98C379; ">&quot;=:=&quot;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Strictly not equal to operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if the two terms are not exactly equal.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  See `===/2` for a definition of what is considered &quot;exactly equal&quot;.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This performs a structural comparison where all Elixir</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  terms can be compared with each other. See the [&quot;Structural</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  comparison&quot; section](#module-structural-comparison) section</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 1 !== 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 1 !== 1.0</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">!==</span> <span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">!==</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="string" style="color: #98C379; ">&quot;=/=&quot;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Gets the element at the zero-based `index` in `tuple`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It raises `ArgumentError` when index is negative or it is out of range of the tuple elements.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests. Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      tuple = {:foo, :bar, 3}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      elem(tuple, 1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; :bar</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      elem({}, 0)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (ArgumentError) argument error</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      elem({:foo, :bar}, 2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (ArgumentError) argument error</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">elem</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">tuple</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">non_neg_integer</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">term</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">elem</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">tuple</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">index</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">element</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">index</span> <span class="operator" style="color: #C678DD; ">+</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">tuple</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Puts `value` at the given zero-based `index` in `tuple`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; tuple = {:foo, :bar, 3}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; put_elem(tuple, 0, :baz)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      {:baz, :bar, 3}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">put_elem</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">tuple</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">non_neg_integer</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">tuple</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">put_elem</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">tuple</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">index</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">setelement</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">index</span> <span class="operator" style="color: #C678DD; ">+</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">tuple</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">## Implemented in Elixir</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">optimize_boolean</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:case</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:case</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:optimize_boolean</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Strictly boolean &quot;or&quot; operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If `left` is `true`, returns `true`; otherwise returns `right`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Requires only the `left` operand to be a boolean since it short-circuits.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the `left` operand is not a boolean, a `BadBooleanError` exception is</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  raised.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; true or false</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; false or 42</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      42</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 42 or false</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (BadBooleanError) expected a boolean on left-side of &quot;or&quot;, got: 42</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="constant" style="color: #56B6C2; ">nil</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="function" style="color: #61AFEF; ">build_boolean_check</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:or</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="string" style="color: #98C379; ">:match</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="function" style="color: #61AFEF; ">invalid_match!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:or</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="string" style="color: #98C379; ">:guard</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">orelse</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Strictly boolean &quot;and&quot; operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If `left` is `false`, returns `false`; otherwise returns `right`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Requires only the `left` operand to be a boolean since it short-circuits. If</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the `left` operand is not a boolean, a `BadBooleanError` exception is raised.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; true and false</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; true and &quot;yay!&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;yay!&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; &quot;yay!&quot; and true</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (BadBooleanError) expected a boolean on left-side of &quot;and&quot;, got: &quot;yay!&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="constant" style="color: #56B6C2; ">nil</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="function" style="color: #61AFEF; ">build_boolean_check</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:and</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">false</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="string" style="color: #98C379; ">:match</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="function" style="color: #61AFEF; ">invalid_match!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:and</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="string" style="color: #98C379; ">:guard</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">andalso</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">build_boolean_check</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">operator</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">check</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">true_clause</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">false_clause</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">optimize_boolean</span><span class="text" style="color: #ABB2BF; ">(</span>
      <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="keyword" style="color: #E06C75; ">case</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">check</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">false_clause</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">true_clause</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="text" style="color: #ABB2BF; ">other</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">error</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:badbool</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">operator</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
      <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Boolean &quot;not&quot; operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Receives any value (not just booleans) and returns `true` if `value`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  is `false` or `nil`; returns `false` otherwise.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Not allowed in guard clauses.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; !Enum.empty?([])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; !List.first([])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="operator" style="color: #C678DD; ">!</span><span class="text" style="color: #ABB2BF; ">value</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="operator" style="color: #C678DD; ">!</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:!</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">assert_no_match_or_guard_scope</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;!&quot;</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="function" style="color: #61AFEF; ">optimize_boolean</span><span class="text" style="color: #ABB2BF; ">(</span>
      <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="keyword" style="color: #E06C75; ">case</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="text" style="color: #ABB2BF; ">x</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="string" style="color: #98C379; ">:&quot;Elixir.Kernel&quot;</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">x</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="constant" style="color: #56B6C2; ">false</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="constant" style="color: #56B6C2; ">false</span>
          <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="constant" style="color: #56B6C2; ">true</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
      <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="operator" style="color: #C678DD; ">!</span><span class="text" style="color: #ABB2BF; ">value</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">assert_no_match_or_guard_scope</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;!&quot;</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="function" style="color: #61AFEF; ">optimize_boolean</span><span class="text" style="color: #ABB2BF; ">(</span>
      <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="keyword" style="color: #E06C75; ">case</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="text" style="color: #ABB2BF; ">x</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="string" style="color: #98C379; ">:&quot;Elixir.Kernel&quot;</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">x</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="constant" style="color: #56B6C2; ">false</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="constant" style="color: #56B6C2; ">true</span>
          <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="constant" style="color: #56B6C2; ">false</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
      <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Binary concatenation operator. Concatenates two binaries.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Raises an `ArgumentError` if one of the sides aren&#39;t binaries.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; &quot;foo&quot; &lt;&gt; &quot;bar&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;foobar&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The `&lt;&gt;/2` operator can also be used in pattern matching (and guard clauses) as</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  long as the left argument is a literal binary:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; &quot;foo&quot; &lt;&gt; x = &quot;foobar&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; x</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;bar&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `x &lt;&gt; &quot;bar&quot; = &quot;foobar&quot;` would result in an `ArgumentError` exception.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">concats</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">extract_concatenations</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">&lt;&lt;</span><span class="keyword" style="color: #E06C75; ">unquote_splicing</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">concats</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; "># Extracts concatenations in order to optimize many</span>
  <span class="comment" style="font-style: italic; color: #5C6370; "># concatenations into one single clause.</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">extract_concatenations</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">caller</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">[</span><span class="function" style="color: #61AFEF; ">wrap_concatenation</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">caller</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="function" style="color: #61AFEF; ">extract_concatenations</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">caller</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">]</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">extract_concatenations</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">caller</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">[</span><span class="function" style="color: #61AFEF; ">wrap_concatenation</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:right</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">caller</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">]</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">wrap_concatenation</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_side</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_caller</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">binary</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">wrap_concatenation</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">literal</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_side</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_caller</span><span class="text" style="color: #ABB2BF; ">)</span>
       <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">literal</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">literal</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">literal</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="function" style="color: #61AFEF; ">is_float</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">literal</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">error</span><span class="text" style="color: #ABB2BF; ">(</span>
      <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">exception</span><span class="text" style="color: #ABB2BF; ">(</span>
        <span class="string" style="color: #98C379; ">&quot;expected binary argument in &lt;&gt; operator but got: <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">literal</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span>
      <span class="text" style="color: #ABB2BF; ">)</span>
    <span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">wrap_concatenation</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">side</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">caller</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">expanded</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">expand_concat_argument</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">side</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">caller</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&quot;::&quot;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">expanded</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:binary</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">expand_concat_argument</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">context: </span><span class="string" style="color: #98C379; ">:match</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">caller</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">expanded_arg</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">case</span> <span class="function" style="color: #61AFEF; ">bootstrapped?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">caller</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">arg</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">expanded_arg</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="function" style="color: #61AFEF; ">invalid_concat_left_argument_error</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Atom</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:^</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="function" style="color: #61AFEF; ">invalid_concat_left_argument_error</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">&quot;^<span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="module" style="color: #61AFEF; ">Atom</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">expanded_arg</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">expand_concat_argument</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">arg</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">invalid_concat_left_argument_error</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">error</span><span class="text" style="color: #ABB2BF; ">(</span>
      <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">exception</span><span class="text" style="color: #ABB2BF; ">(</span>
        <span class="string" style="color: #98C379; ">&quot;the left argument of &lt;&gt; operator inside a match should always be a literal &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
          <span class="string" style="color: #98C379; ">&quot;binary because its size can&#39;t be verified. Got: <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span>
      <span class="text" style="color: #ABB2BF; ">)</span>
    <span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Raises an exception.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If `message` is a string, it raises a `RuntimeError` exception with it.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If `message` is an atom, it just calls `raise/2` with the atom as the first</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  argument and `[]` as the second one.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If `message` is an exception struct, it is raised as is.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If `message` is anything else, `raise` will fail with an `ArgumentError`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  exception.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; raise &quot;oops&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (RuntimeError) oops</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      try do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        1 + :foo</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      rescue</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        x in [ArithmeticError] -&gt;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          IO.puts(&quot;that was expected&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          raise x</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">raise</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">message</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="comment" style="font-style: italic; color: #5C6370; "># Try to figure out the type at compilation time</span>
    <span class="comment" style="font-style: italic; color: #5C6370; "># to avoid dead code and make Dialyzer happy.</span>
    <span class="text" style="color: #ABB2BF; ">message</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">case</span> <span class="keyword" style="color: #E06C75; ">not</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">message</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="function" style="color: #61AFEF; ">bootstrapped?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">message</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">message</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="text" style="color: #ABB2BF; ">erlang_error</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">case</span> <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">system_info</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:otp_release</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">&gt;=</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="constant" style="color: #56B6C2; ">?2</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">?4</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
          <span class="keyword" style="color: #E06C75; ">fn</span> <span class="text" style="color: #ABB2BF; ">x</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
            <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
              <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">error</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">x</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:none</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">error_info: </span><span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">module: </span><span class="module" style="color: #61AFEF; ">Exception</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">)</span>
            <span class="keyword" style="color: #E06C75; ">end</span>
          <span class="keyword" style="color: #E06C75; ">end</span>

        <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
          <span class="keyword" style="color: #E06C75; ">fn</span> <span class="text" style="color: #ABB2BF; ">x</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
            <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
              <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">error</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">x</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
            <span class="keyword" style="color: #E06C75; ">end</span>
          <span class="keyword" style="color: #E06C75; ">end</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">message</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">message</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">message</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">erlang_error</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">quote</span> <span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">RuntimeError</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">exception</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">message</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">message</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">erlang_error</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">quote</span> <span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">RuntimeError</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">exception</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">message</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="text" style="color: #ABB2BF; ">alias</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">alias</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">erlang_error</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">quote</span> <span class="string" style="color: #98C379; ">do: </span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">alias</span><span class="text" style="color: #ABB2BF; ">)</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">exception</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">erlang_error</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">quote</span> <span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">Kernel.Utils</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">raise</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">message</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Raises an exception.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Calls the `exception/1` function on the given argument (which has to be a</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  module name like `ArgumentError` or `RuntimeError`) passing `attributes`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  in order to retrieve the exception struct.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Any module that contains a call to the `defexception/1` macro automatically</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  implements the `c:Exception.exception/1` callback expected by `raise/2`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  For more information, see `defexception/1`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; raise(ArgumentError, &quot;Sample&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (ArgumentError) Sample</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">raise</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">exception</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">attributes</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">error</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">exception</span><span class="text" style="color: #ABB2BF; ">)</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">exception</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">attributes</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Raises an exception preserving a previous stacktrace.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Works like `raise/1` but does not generate a new stacktrace.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note that `__STACKTRACE__` can be used inside catch/rescue</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  to retrieve the current stacktrace.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      try do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        raise &quot;oops&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      rescue</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        exception -&gt;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          reraise exception, __STACKTRACE__</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">reraise</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">message</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">stacktrace</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="comment" style="font-style: italic; color: #5C6370; "># Try to figure out the type at compilation time</span>
    <span class="comment" style="font-style: italic; color: #5C6370; "># to avoid dead code and make Dialyzer happy.</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">message</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">message</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">message</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">error</span><span class="text" style="color: #ABB2BF; ">(</span>
            <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">raise</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:error</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="module" style="color: #61AFEF; ">RuntimeError</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">exception</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">message</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">stacktrace</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">message</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">error</span><span class="text" style="color: #ABB2BF; ">(</span>
            <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">raise</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:error</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="module" style="color: #61AFEF; ">RuntimeError</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">exception</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">message</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">stacktrace</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="text" style="color: #ABB2BF; ">alias</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">alias</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">error</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">raise</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:error</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">alias</span><span class="text" style="color: #ABB2BF; ">)</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">exception</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">stacktrace</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="text" style="color: #ABB2BF; ">message</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">error</span><span class="text" style="color: #ABB2BF; ">(</span>
            <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">raise</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:error</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="module" style="color: #61AFEF; ">Kernel.Utils</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">raise</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">message</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">stacktrace</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Raises an exception preserving a previous stacktrace.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `reraise/3` works like `reraise/2`, except it passes arguments to the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `exception/1` function as explained in `raise/2`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      try do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        raise &quot;oops&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      rescue</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        exception -&gt;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          reraise WrapperError, [exception: exception], __STACKTRACE__</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">reraise</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">exception</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">attributes</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">stacktrace</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">raise</span><span class="text" style="color: #ABB2BF; ">(</span>
        <span class="string" style="color: #98C379; ">:error</span><span class="text" style="color: #ABB2BF; ">,</span>
        <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">exception</span><span class="text" style="color: #ABB2BF; ">)</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">exception</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">attributes</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
        <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">stacktrace</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Text-based match operator. Matches the term on the `left`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  against the regular expression or string on the `right`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If `right` is a regular expression, returns `true` if `left` matches right.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If `right` is a string, returns `true` if `left` contains `right`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; &quot;abcd&quot; =~ ~r/c(d)/</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; &quot;abcd&quot; =~ ~r/e/</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; &quot;abcd&quot; =~ ~r//</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; &quot;abcd&quot; =~ &quot;bc&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; &quot;abcd&quot; =~ &quot;ad&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; &quot;abcd&quot; =~ &quot;abcd&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; &quot;abcd&quot; =~ &quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  For more information about regular expressions, please check the `Regex` module.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="module" style="color: #61AFEF; ">String</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">t</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">=~</span> <span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">String</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">t</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="module" style="color: #61AFEF; ">Regex</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">t</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">=~</span> <span class="string" style="color: #98C379; ">&quot;&quot;</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="constant" style="color: #56B6C2; ">true</span>

  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">=~</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:binary</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">match</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">!=</span> <span class="string" style="color: #98C379; ">:nomatch</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">=~</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">Regex</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">match?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">~S<span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inspects the given argument according to the `Inspect` protocol.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The second argument is a keyword list with options to control</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  inspection.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Options</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `inspect/2` accepts a list of options that are internally</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  translated to an `Inspect.Opts` struct. Check the docs for</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `Inspect.Opts` to see the supported options.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; inspect(:foo)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;:foo&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; inspect([1, 2, 3, 4, 5], limit: 3)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;[1, 2, 3, ...]&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; inspect([1, 2, 3], pretty: true, width: 0)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;[1,\n 2,\n 3]&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; inspect(&quot;olÃ¡&quot; &lt;&gt; &lt;&lt;0&gt;&gt;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;&lt;&lt;111, 108, 195, 161, 0&gt;&gt;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; inspect(&quot;olÃ¡&quot; &lt;&gt; &lt;&lt;0&gt;&gt;, binaries: :as_strings)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;<span class="string" style="color: #98C379; ">\&quot;</span>olÃ¡\\0<span class="string" style="color: #98C379; ">\&quot;</span>&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; inspect(&quot;olÃ¡&quot;, binaries: :as_binaries)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;&lt;&lt;111, 108, 195, 161&gt;&gt;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; inspect(~c&quot;bar&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;~c<span class="string" style="color: #98C379; ">\&quot;</span>bar<span class="string" style="color: #98C379; ">\&quot;</span>&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; inspect([0 | ~c&quot;bar&quot;])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;[0, 98, 97, 114]&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; inspect(100, base: :octal)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;0o144&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; inspect(100, base: :hex)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;0x64&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note that the `Inspect` protocol does not necessarily return a valid</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  representation of an Elixir term. In such cases, the inspected result</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  must start with `#`. For example, inspecting a function will return:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      inspect(fn a, b -&gt; a + b end)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; #Function&lt;...&gt;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The `Inspect` protocol can be derived to hide certain fields</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  from structs, so they don&#39;t show up in logs, inspects and similar.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  See the &quot;Deriving&quot; section of the documentation of the `Inspect`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  protocol for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Inspect</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">t</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">keyword</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="module" style="color: #61AFEF; ">String</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">t</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">opts</span> <span class="operator" style="color: #C678DD; ">\\</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">opts</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">opts</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Inspect.Opts</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">new</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">opts</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="text" style="color: #ABB2BF; ">limit</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">opts</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">pretty</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">opts</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">width</span>
        <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="string" style="color: #98C379; ">:infinity</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="text" style="color: #ABB2BF; ">doc</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Inspect.Algebra</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">group</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Inspect.Algebra</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_doc</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">opts</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="module" style="color: #61AFEF; ">IO</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">iodata_to_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Inspect.Algebra</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">format</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">doc</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">limit</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Creates and updates a struct.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The `struct` argument may be an atom (which defines `defstruct`)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  or a `struct` itself. The second argument is any `Enumerable` that</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  emits two-element tuples (key-value pairs) during enumeration.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Keys in the `Enumerable` that don&#39;t exist in the struct are automatically</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  discarded. Note that keys must be atoms, as only atoms are allowed when</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  defining a struct. If keys in the `Enumerable` are duplicated, the last</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  entry will be taken (same behaviour as `Map.new/1`).</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This function is useful for dynamically creating and updating structs, as</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  well as for converting maps to structs; in the latter case, just inserting</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the appropriate `:__struct__` field into the map may not be enough and</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `struct/2` should be used instead.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule User do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defstruct name: &quot;john&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      struct(User)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; %User{name: &quot;john&quot;}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      opts = [name: &quot;meg&quot;]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      user = struct(User, opts)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; %User{name: &quot;meg&quot;}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      struct(user, unknown: &quot;value&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; %User{name: &quot;meg&quot;}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      struct(User, %{name: &quot;meg&quot;})</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; %User{name: &quot;meg&quot;}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      # String keys are ignored</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      struct(User, %{&quot;name&quot; =&gt; &quot;meg&quot;})</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; %User{name: &quot;john&quot;}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">struct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="module" style="color: #61AFEF; ">Enumerable</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">t</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">struct</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">struct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fields</span> <span class="operator" style="color: #C678DD; ">\\</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">struct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">fn</span>
      <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:__struct__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_val</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">acc</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">acc</span>

      <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">val</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">acc</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">acc</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="operator" style="color: #C678DD; ">^</span><span class="text" style="color: #ABB2BF; ">key</span> <span class="operator" style="color: #C678DD; ">=&gt;</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">acc</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">key</span> <span class="operator" style="color: #C678DD; ">=&gt;</span> <span class="text" style="color: #ABB2BF; ">val</span><span class="text" style="color: #ABB2BF; ">}</span>
          <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">acc</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Similar to `struct/2` but checks for key validity.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The function `struct!/2` emulates the compile time behaviour</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  of structs. This means that:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * when building a struct, as in `struct!(SomeStruct, key: :value)`,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      it is equivalent to `%SomeStruct{key: :value}` and therefore this</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      function will check if every given key-value belongs to the struct.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      If the struct is enforcing any key via `@enforce_keys`, those will</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      be enforced as well;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * when updating a struct, as in `struct!(%SomeStruct{}, key: :value)`,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      it is equivalent to `%SomeStruct{struct | key: :value}` and therefore this</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      function will check if every given key-value belongs to the struct.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      However, updating structs does not enforce keys, as keys are enforced</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      only when building;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">struct!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="module" style="color: #61AFEF; ">Enumerable</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">t</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">struct</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">struct!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fields</span> <span class="operator" style="color: #C678DD; ">\\</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">struct!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">validate_struct!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">__struct__</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">struct!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">struct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">fn</span>
      <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:__struct__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">acc</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">acc</span>

      <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">val</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">acc</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="module" style="color: #61AFEF; ">Map</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">replace!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">acc</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">val</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">struct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">validate_struct!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">__struct__</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">0</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">struct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">struct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">validate_struct!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">__struct__</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">0</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">struct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">%</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">struct</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">struct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">%</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">Enum</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">reduce</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">validate_struct!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">__struct__: </span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_arity</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">struct</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">validate_struct!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">__struct__: </span><span class="text" style="color: #ABB2BF; ">struct_name</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arity</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct_name</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">error_message</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="string" style="color: #98C379; ">&quot;expected struct name returned by <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>.__struct__/<span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">arity</span><span class="text" style="color: #ABB2BF; ">}</span></span> to be &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
        <span class="string" style="color: #98C379; ">&quot;<span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>, got: <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct_name</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span>

    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">error</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">exception</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">error_message</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">validate_struct!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arity</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">error_message</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="string" style="color: #98C379; ">&quot;expected <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>.__struct__/<span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">arity</span><span class="text" style="color: #ABB2BF; ">}</span></span> to return a map with a :__struct__ &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
        <span class="string" style="color: #98C379; ">&quot;key that holds the name of the struct (atom), got: <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span>

    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">error</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">exception</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">error_message</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is a struct; otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_struct(URI.parse(&quot;/&quot;))</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_struct(%{})</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.10.0&quot;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">is_struct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="constant" style="color: #56B6C2; ">nil</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="keyword" style="color: #E06C75; ">case</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
            <span class="text" style="color: #ABB2BF; ">%</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="constant" style="color: #56B6C2; ">true</span>
            <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="constant" style="color: #56B6C2; ">false</span>
          <span class="keyword" style="color: #E06C75; ">end</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="string" style="color: #98C379; ">:match</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="function" style="color: #61AFEF; ">invalid_match!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:is_struct</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="string" style="color: #98C379; ">:guard</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="function" style="color: #61AFEF; ">is_map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_map_key</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:__struct__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
            <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map_get</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:__struct__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is a struct of `name`; otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `is_struct/2` does not check that `name` exists and is a valid struct.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If you want such validations, you must pattern match on the struct</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  instead, such as `match?(%URI{}, arg)`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_struct(URI.parse(&quot;/&quot;), URI)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_struct(URI.parse(&quot;/&quot;), Macro.Env)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.11.0&quot;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">is_struct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="constant" style="color: #56B6C2; ">nil</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="string" style="color: #98C379; ">generated: </span><span class="constant" style="color: #56B6C2; ">true</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="keyword" style="color: #E06C75; ">case</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
            <span class="text" style="color: #ABB2BF; ">name</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
              <span class="keyword" style="color: #E06C75; ">case</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
                <span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">__struct__: </span><span class="operator" style="color: #C678DD; ">^</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="constant" style="color: #56B6C2; ">true</span>
                <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="constant" style="color: #56B6C2; ">false</span>
              <span class="keyword" style="color: #E06C75; ">end</span>

            <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
              <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span>
          <span class="keyword" style="color: #E06C75; ">end</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="string" style="color: #98C379; ">:match</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="function" style="color: #61AFEF; ">invalid_match!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:is_struct</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="string" style="color: #98C379; ">:guard</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="function" style="color: #61AFEF; ">is_map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
            <span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="string" style="color: #98C379; ">:fail</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
            <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_map_key</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:__struct__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
            <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map_get</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:__struct__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is an exception; otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_exception(%RuntimeError{})</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_exception(%{})</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.11.0&quot;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">is_exception</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="constant" style="color: #56B6C2; ">nil</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="keyword" style="color: #E06C75; ">case</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
            <span class="text" style="color: #ABB2BF; ">%</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">__exception__: </span><span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="constant" style="color: #56B6C2; ">true</span>
            <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="constant" style="color: #56B6C2; ">false</span>
          <span class="keyword" style="color: #E06C75; ">end</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="string" style="color: #98C379; ">:match</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="function" style="color: #61AFEF; ">invalid_match!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:is_exception</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="string" style="color: #98C379; ">:guard</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="function" style="color: #61AFEF; ">is_map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_map_key</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:__struct__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
            <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map_get</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:__struct__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
            <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_map_key</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:__exception__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
            <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map_get</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:__exception__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="constant" style="color: #56B6C2; ">true</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is an exception of `name`; otherwise returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard tests.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_exception(%RuntimeError{}, RuntimeError)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_exception(%RuntimeError{}, Macro.Env)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.11.0&quot;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">is_exception</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="constant" style="color: #56B6C2; ">nil</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="keyword" style="color: #E06C75; ">case</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
            <span class="text" style="color: #ABB2BF; ">name</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
              <span class="keyword" style="color: #E06C75; ">case</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
                <span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">__struct__: </span><span class="operator" style="color: #C678DD; ">^</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">__exception__: </span><span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="constant" style="color: #56B6C2; ">true</span>
                <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="constant" style="color: #56B6C2; ">false</span>
              <span class="keyword" style="color: #E06C75; ">end</span>

            <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
              <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span>
          <span class="keyword" style="color: #E06C75; ">end</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="string" style="color: #98C379; ">:match</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="function" style="color: #61AFEF; ">invalid_match!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:is_exception</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="string" style="color: #98C379; ">:guard</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="function" style="color: #61AFEF; ">is_map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
            <span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="string" style="color: #98C379; ">:fail</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
            <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_map_key</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:__struct__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
            <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map_get</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:__struct__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
            <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_map_key</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:__exception__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
            <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map_get</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:__exception__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="constant" style="color: #56B6C2; ">true</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Pipes the first argument, `value`, into the second argument, a function `fun`,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and returns the result of calling `fun`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In other words, it invokes the function `fun` with `value` as argument,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and returns its result.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This is most commonly used in pipelines, using the `|&gt;/2` operator, allowing you</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  to pipe a value to a function outside of its first argument.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ### Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 1 |&gt; then(fn x -&gt; x * 2 end)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      2</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 1 |&gt; then(fn x -&gt; Enum.drop([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;], x) end)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [&quot;b&quot;, &quot;c&quot;]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.12.0&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">then</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Gets a value from a nested structure.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Uses the `Access` module to traverse the structures</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  according to the given `keys`, unless the `key` is a</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  function, which is detailed in a later section.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note that if none of the given keys are functions,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  there is rarely a reason to use `get_in` over</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  writing &quot;regular&quot; Elixir code using `[]`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = %{&quot;john&quot; =&gt; %{age: 27}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; get_in(users, [&quot;john&quot;, :age])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      27</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; # Equivalent to:</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users[&quot;john&quot;][:age]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      27</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `get_in/2` can also use the accessors in the `Access` module</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  to traverse more complex data structures. For example, here we</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  use `Access.all/0` to traverse a list:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = [%{name: &quot;john&quot;, age: 27}, %{name: &quot;meg&quot;, age: 23}]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; get_in(users, [Access.all(), :age])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [27, 23]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In case any of the components returns `nil`, `nil` will be returned</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and `get_in/2` won&#39;t traverse any further:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = %{&quot;john&quot; =&gt; %{age: 27}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; get_in(users, [&quot;unknown&quot;, :age])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      nil</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; # Equivalent to:</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users[&quot;unknown&quot;][:age]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      nil</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = nil</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; get_in(users, [Access.all(), :age])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      nil</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Alternatively, if you need to access complex data-structures, you can</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  use pattern matching:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      case users do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        %{&quot;john&quot; =&gt; %{age: age}} -&gt; age</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        _ -&gt; default_value</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Functions as keys</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If a key given to `get_in/2` is a function, the function will be invoked</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  passing three arguments:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * the operation (`:get`)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * the data to be accessed</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * a function to be invoked next</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This means `get_in/2` can be extended to provide custom lookups.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  That&#39;s precisely how the `Access.all/0` key in the previous section</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  behaves. For example, we can manually implement such traversal as</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  follows:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = [%{name: &quot;john&quot;, age: 27}, %{name: &quot;meg&quot;, age: 23}]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; all = fn :get, data, next -&gt; Enum.map(data, next) end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; get_in(users, [all, :age])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [27, 23]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The `Access` module ships with many convenience accessor functions.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  See `Access.all/0`, `Access.key/2`, and others as examples.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Working with structs</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  By default, structs do not implement the `Access` behaviour required</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  by this function. Therefore, you can&#39;t do this:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      get_in(some_struct, [:some_key, :nested_key])</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The good news is that structs have predefined shape. Therefore,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  you can write instead:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      some_struct.some_key.nested_key</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If, by any chance, `some_key` can return nil, you can always</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  fallback to pattern matching to provide nested struct handling:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      case some_struct do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        %{some_key: %{nested_key: value}} -&gt; value</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        %{} -&gt; nil</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">get_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">t</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="function" style="color: #61AFEF; ">nonempty_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">term</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">get_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">keys</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">get_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="constant" style="color: #56B6C2; ">nil</span>

  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">get_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_function</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">h</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:get</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="operator" style="color: #C678DD; ">&amp;</span> <span class="operator" style="color: #C678DD; ">&amp;</span><span class="operator" style="color: #C678DD; ">1</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">get_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">h</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_function</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">h</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:get</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="operator" style="color: #C678DD; ">&amp;</span><span class="function" style="color: #61AFEF; ">get_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="operator" style="color: #C678DD; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">get_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">get</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">get_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">h</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="function" style="color: #61AFEF; ">get_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">get</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Puts a value in a nested structure.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Uses the `Access` module to traverse the structures</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  according to the given `keys`, unless the `key` is a</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  function. If the key is a function, it will be invoked</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  as specified in `get_and_update_in/3`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = %{&quot;john&quot; =&gt; %{age: 27}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; put_in(users, [&quot;john&quot;, :age], 28)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      %{&quot;john&quot; =&gt; %{age: 28}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If any of the intermediate values are nil, it will raise:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = %{&quot;john&quot; =&gt; %{age: 27}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; put_in(users, [&quot;jane&quot;, :age], &quot;oops&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (ArgumentError) could not put/update key :age on a nil value</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">put_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">t</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="function" style="color: #61AFEF; ">nonempty_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">t</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">put_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">keys</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">elem</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">keys</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">fn</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="keyword" style="color: #E06C75; ">end</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Updates a key in a nested structure.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Uses the `Access` module to traverse the structures</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  according to the given `keys`, unless the `key` is a</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  function. If the key is a function, it will be invoked</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  as specified in `get_and_update_in/3`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `data` is a nested structure (that is, a map, keyword</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  list, or struct that implements the `Access` behaviour).</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The `fun` argument receives the value of `key` (or `nil`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  if `key` is not present) and the result replaces the value</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  in the structure.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = %{&quot;john&quot; =&gt; %{age: 27}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; update_in(users, [&quot;john&quot;, :age], &amp;(&amp;1 + 1))</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      %{&quot;john&quot; =&gt; %{age: 28}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note the current value given to the anonymous function may be `nil`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If any of the intermediate values are nil, it will raise:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = %{&quot;john&quot; =&gt; %{age: 27}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; update_in(users, [&quot;jane&quot;, :age], &amp; &amp;1 + 1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (ArgumentError) could not put/update key :age on a nil value</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">t</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="function" style="color: #61AFEF; ">nonempty_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">t</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">keys</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_function</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">elem</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">keys</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">fn</span> <span class="text" style="color: #ABB2BF; ">x</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">x</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="keyword" style="color: #E06C75; ">end</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Gets a value and updates a nested structure.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `data` is a nested structure (that is, a map, keyword</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  list, or struct that implements the `Access` behaviour).</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The `fun` argument receives the value of `key` (or `nil` if `key`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  is not present) and must return one of the following values:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * a two-element tuple `{current_value, new_value}`. In this case,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      `current_value` is the retrieved value which can possibly be operated on before</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      being returned. `new_value` is the new value to be stored under `key`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `:pop`, which implies that the current value under `key`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      should be removed from the structure and returned.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This function uses the `Access` module to traverse the structures</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  according to the given `keys`, unless the `key` is a function,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  which is detailed in a later section.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This function is useful when there is a need to retrieve the current</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  value (or something calculated in function of the current value) and</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  update it at the same time. For example, it could be used to read the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  current age of a user while increasing it by one in one pass:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = %{&quot;john&quot; =&gt; %{age: 27}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; get_and_update_in(users, [&quot;john&quot;, :age], &amp;{&amp;1, &amp;1 + 1})</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      {27, %{&quot;john&quot; =&gt; %{age: 28}, &quot;meg&quot; =&gt; %{age: 23}}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note the current value given to the anonymous function may be `nil`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If any of the intermediate values are nil, it will raise:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = %{&quot;john&quot; =&gt; %{age: 27}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; get_and_update_in(users, [&quot;jane&quot;, :age], &amp;{&amp;1, &amp;1 + 1})</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (ArgumentError) could not put/update key :age on a nil value</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Functions as keys</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If a key is a function, the function will be invoked passing three</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  arguments:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * the operation (`:get_and_update`)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * the data to be accessed</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * a function to be invoked next</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This means `get_and_update_in/3` can be extended to provide custom</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  lookups. The downside is that functions cannot be stored as keys</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  in the accessed data structures.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  When one of the keys is a function, the function is invoked.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In the example below, we use a function to get and increment all</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ages inside a list:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = [%{name: &quot;john&quot;, age: 27}, %{name: &quot;meg&quot;, age: 23}]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; all = fn :get_and_update, data, next -&gt;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ...&gt;   data |&gt; Enum.map(next) |&gt; Enum.unzip()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ...&gt; end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; get_and_update_in(users, [all, :age], &amp;{&amp;1, &amp;1 + 1})</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      {[27, 23], [%{name: &quot;john&quot;, age: 28}, %{name: &quot;meg&quot;, age: 24}]}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the previous value before invoking the function is `nil`,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the function *will* receive `nil` as a value and must handle it</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  accordingly (be it by failing or providing a sane default).</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The `Access` module ships with many convenience accessor functions,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  like the `all` anonymous function defined above. See `Access.all/0`,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `Access.key/2`, and others as examples.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span>
          <span class="text" style="color: #ABB2BF; ">structure</span><span class="text" style="color: #ABB2BF; ">,</span>
          <span class="text" style="color: #ABB2BF; ">keys</span><span class="text" style="color: #ABB2BF; ">,</span>
          <span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="constant" style="color: #56B6C2; ">nil</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">current_value</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">new_value</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="string" style="color: #98C379; ">:pop</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">current_value</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">new_structure</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">structure</span><span class="text" style="color: #ABB2BF; ">}</span>
        <span class="keyword" style="color: #E06C75; ">when</span> <span class="string" style="color: #98C379; ">structure: </span><span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">t</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
             <span class="string" style="color: #98C379; ">keys: </span><span class="function" style="color: #61AFEF; ">nonempty_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">any</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
             <span class="string" style="color: #98C379; ">current_value: </span><span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">value</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
             <span class="string" style="color: #98C379; ">new_value: </span><span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">value</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">keys</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">head</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_function</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">head</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">3</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
    <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">head</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:get_and_update</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">head</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_function</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">head</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">3</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
    <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">head</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:get_and_update</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="operator" style="color: #C678DD; ">&amp;</span><span class="function" style="color: #61AFEF; ">get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="operator" style="color: #C678DD; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">head</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_function</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
    <span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">get_and_update</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">head</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">head</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_function</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
    <span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">get_and_update</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">head</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="operator" style="color: #C678DD; ">&amp;</span><span class="function" style="color: #61AFEF; ">get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="operator" style="color: #C678DD; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Pops a key from the given nested structure.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Uses the `Access` protocol to traverse the structures</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  according to the given `keys`, unless the `key` is a</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  function. If the key is a function, it will be invoked</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  as specified in `get_and_update_in/3`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = %{&quot;john&quot; =&gt; %{age: 27}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; pop_in(users, [&quot;john&quot;, :age])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      {27, %{&quot;john&quot; =&gt; %{}, &quot;meg&quot; =&gt; %{age: 23}}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In case any entry returns `nil`, its key will be removed</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and the deletion will be considered a success.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = %{&quot;john&quot; =&gt; %{age: 27}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; pop_in(users, [&quot;jane&quot;, :age])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      {nil, %{&quot;john&quot; =&gt; %{age: 27}, &quot;meg&quot; =&gt; %{age: 23}}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">pop_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="function" style="color: #61AFEF; ">nonempty_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">get_and_update_fun</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">}</span>
        <span class="keyword" style="color: #E06C75; ">when</span> <span class="string" style="color: #98C379; ">data: </span><span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">container</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">pop_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">keys</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">pop_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">key</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;could not pop key <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span> on a nil value&quot;</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">pop_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">keys</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">pop_in_data</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">keys</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">pop_in_data</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="string" style="color: #98C379; ">:pop</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">pop_in_data</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_function</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
    <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">fun</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:get_and_update</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">fn</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="string" style="color: #98C379; ">:pop</span> <span class="keyword" style="color: #E06C75; ">end</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">pop_in_data</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">fun</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_function</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
    <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">fun</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:get_and_update</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="operator" style="color: #C678DD; ">&amp;</span><span class="function" style="color: #61AFEF; ">pop_in_data</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="operator" style="color: #C678DD; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">pop_in_data</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">pop</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">pop_in_data</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">key</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
    <span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">get_and_update</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">data</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="operator" style="color: #C678DD; ">&amp;</span><span class="function" style="color: #61AFEF; ">pop_in_data</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="operator" style="color: #C678DD; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Puts a value in a nested structure via the given `path`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This is similar to `put_in/3`, except the path is extracted via</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  a macro rather than passing a list. For example:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      put_in(opts[:foo][:bar], :baz)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Is equivalent to:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      put_in(opts, [:foo, :bar], :baz)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This also works with nested structs and the `struct.path.to.value` way to specify</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  paths:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      put_in(struct.foo.bar, :baz)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note that in order for this macro to work, the complete path must always</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  be visible by this macro. For more information about the supported path</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  expressions, please check `get_and_update_in/2` docs.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = %{&quot;john&quot; =&gt; %{age: 27}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; put_in(users[&quot;john&quot;][:age], 28)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      %{&quot;john&quot; =&gt; %{age: 28}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = %{&quot;john&quot; =&gt; %{age: 27}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; put_in(users[&quot;john&quot;].age, 28)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      %{&quot;john&quot; =&gt; %{age: 28}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">put_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">path</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="function" style="color: #61AFEF; ">unnest</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">path</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;put_in/2&quot;</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">h</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="function" style="color: #61AFEF; ">nest_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="keyword" style="color: #E06C75; ">fn</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">end</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">h</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">false</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">expr</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">nest_get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="keyword" style="color: #E06C75; ">fn</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="keyword" style="color: #E06C75; ">end</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">element</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">2</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Pops a key from the nested structure via the given `path`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This is similar to `pop_in/2`, except the path is extracted via</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  a macro rather than passing a list. For example:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      pop_in(opts[:foo][:bar])</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Is equivalent to:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      pop_in(opts, [:foo, :bar])</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note that in order for this macro to work, the complete path must always</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  be visible by this macro. For more information about the supported path</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  expressions, please check `get_and_update_in/2` docs.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = %{&quot;john&quot; =&gt; %{age: 27}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; pop_in(users[&quot;john&quot;][:age])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      {27, %{&quot;john&quot; =&gt; %{}, &quot;meg&quot; =&gt; %{age: 23}}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = %{john: %{age: 27}, meg: %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; pop_in(users.john[:age])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      {27, %{john: %{}, meg: %{age: 23}}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In case any entry returns `nil`, its key will be removed</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and the deletion will be considered a success.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">pop_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">path</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">h</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">unnest</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">path</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;pop_in/1&quot;</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="function" style="color: #61AFEF; ">nest_pop_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:map</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Updates a nested structure via the given `path`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This is similar to `update_in/3`, except the path is extracted via</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  a macro rather than passing a list. For example:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      update_in(opts[:foo][:bar], &amp;(&amp;1 + 1))</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Is equivalent to:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      update_in(opts, [:foo, :bar], &amp;(&amp;1 + 1))</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This also works with nested structs and the `struct.path.to.value` way to specify</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  paths:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      update_in(struct.foo.bar, &amp;(&amp;1 + 1))</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note that in order for this macro to work, the complete path must always</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  be visible by this macro. For more information about the supported path</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  expressions, please check `get_and_update_in/2` docs.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = %{&quot;john&quot; =&gt; %{age: 27}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; update_in(users[&quot;john&quot;][:age], &amp;(&amp;1 + 1))</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      %{&quot;john&quot; =&gt; %{age: 28}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = %{&quot;john&quot; =&gt; %{age: 27}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; update_in(users[&quot;john&quot;].age, &amp;(&amp;1 + 1))</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      %{&quot;john&quot; =&gt; %{age: 28}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">path</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="function" style="color: #61AFEF; ">unnest</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">path</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;update_in/2&quot;</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">h</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="function" style="color: #61AFEF; ">nest_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">h</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">false</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">expr</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">nest_get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="keyword" style="color: #E06C75; ">fn</span> <span class="text" style="color: #ABB2BF; ">x</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">x</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="keyword" style="color: #E06C75; ">end</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">element</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">2</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Gets a value and updates a nested data structure via the given `path`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This is similar to `get_and_update_in/3`, except the path is extracted</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  via a macro rather than passing a list. For example:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      get_and_update_in(opts[:foo][:bar], &amp;{&amp;1, &amp;1 + 1})</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Is equivalent to:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      get_and_update_in(opts, [:foo, :bar], &amp;{&amp;1, &amp;1 + 1})</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This also works with nested structs and the `struct.path.to.value` way to specify</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  paths:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      get_and_update_in(struct.foo.bar, &amp;{&amp;1, &amp;1 + 1})</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note that in order for this macro to work, the complete path must always</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  be visible by this macro. See the &quot;Paths&quot; section below.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; users = %{&quot;john&quot; =&gt; %{age: 27}, &quot;meg&quot; =&gt; %{age: 23}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; get_and_update_in(users[&quot;john&quot;].age, &amp;{&amp;1, &amp;1 + 1})</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      {27, %{&quot;john&quot; =&gt; %{age: 28}, &quot;meg&quot; =&gt; %{age: 23}}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Paths</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  A path may start with a variable, local or remote call, and must be</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  followed by one or more:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `foo[bar]` - accesses the key `bar` in `foo`; in case `foo` is nil,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      `nil` is returned</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `foo.bar` - accesses a map/struct field; in case the field is not</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      present, an error is raised</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Here are some valid paths:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      users[&quot;john&quot;][:age]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      users[&quot;john&quot;].age</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      User.all()[&quot;john&quot;].age</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      all_users()[&quot;john&quot;].age</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Here are some invalid ones:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      # Does a remote call after the initial value</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      users[&quot;john&quot;].do_something(arg1, arg2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      # Does not access any key or field</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      users</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">path</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">h</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">unnest</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">path</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;get_and_update_in/2&quot;</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="function" style="color: #61AFEF; ">nest_get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">nest_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">fun</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">nest_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="keyword" style="color: #E06C75; ">fn</span> <span class="text" style="color: #ABB2BF; ">x</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">nest_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">x</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">nest_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:map</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="module" style="color: #61AFEF; ">Map</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">update!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">nest_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">nest_get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">fun</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">nest_get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="keyword" style="color: #E06C75; ">fn</span> <span class="text" style="color: #ABB2BF; ">x</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">nest_get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">x</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">nest_get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:access</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">get_and_update</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">nest_get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">nest_get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:map</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="module" style="color: #61AFEF; ">Map</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">get_and_update!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">nest_get_and_update_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">nest_pop_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="keyword" style="color: #E06C75; ">fn</span> <span class="text" style="color: #ABB2BF; ">x</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">nest_pop_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">x</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">nest_pop_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:map</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:access</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="keyword" style="color: #E06C75; ">case</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="constant" style="color: #56B6C2; ">nil</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">}</span>
        <span class="text" style="color: #ABB2BF; ">h</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">pop</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">nest_pop_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:map</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span>
          <span class="string" style="color: #98C379; ">&quot;cannot use pop_in when the last segment is a map/struct field. &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
            <span class="string" style="color: #98C379; ">&quot;This would effectively remove the field <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span> from the map/struct&quot;</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">nest_pop_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:map</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="module" style="color: #61AFEF; ">Map</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">get_and_update!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">nest_pop_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:map</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">nest_pop_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:access</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="keyword" style="color: #E06C75; ">case</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="constant" style="color: #56B6C2; ">nil</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="string" style="color: #98C379; ">:pop</span>
        <span class="text" style="color: #ABB2BF; ">h</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">pop</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">nest_pop_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:access</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="module" style="color: #61AFEF; ">Access</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">get_and_update</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">nest_pop_in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:access</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">unnest</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:.</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="module" style="color: #61AFEF; ">Access</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:get</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">acc</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_all_map?</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">unnest</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:access</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">acc</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">false</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">unnest</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:.</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">acc</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">all_map?</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">)</span>
       <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_tuple</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">element</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">!=</span> <span class="string" style="color: #98C379; ">:__aliases__</span> <span class="keyword" style="color: #E06C75; ">and</span>
              <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">element</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">!=</span> <span class="string" style="color: #98C379; ">:__MODULE__</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">unnest</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:map</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">acc</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">all_map?</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">unnest</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_all_map?</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span>
          <span class="string" style="color: #98C379; ">&quot;expected expression given to <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">}</span></span> to access at least one element, &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
            <span class="string" style="color: #98C379; ">&quot;got: <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">unnest</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">acc</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">all_map?</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="function" style="color: #61AFEF; ">proper_start?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">other</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">acc</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">all_map?</span><span class="text" style="color: #ABB2BF; ">}</span>

      <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span>
              <span class="string" style="color: #98C379; ">&quot;expression given to <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">}</span></span> must start with a variable, local or remote call &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
                <span class="string" style="color: #98C379; ">&quot;and be followed by an element access, got: <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">proper_start?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:.</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_args</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">)</span>
       <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">)</span>
       <span class="keyword" style="color: #E06C75; ">when</span> <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">element</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="string" style="color: #98C379; ">:__aliases__</span>
       <span class="keyword" style="color: #E06C75; ">when</span> <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">element</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="string" style="color: #98C379; ">:__MODULE__</span><span class="text" style="color: #ABB2BF; ">,</span>
       <span class="string" style="color: #98C379; ">do: </span><span class="constant" style="color: #56B6C2; ">true</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">proper_start?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">atom</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_args</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">)</span>
       <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">atom</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
       <span class="string" style="color: #98C379; ">do: </span><span class="constant" style="color: #56B6C2; ">true</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">proper_start?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="keyword" style="color: #E06C75; ">not</span> <span class="function" style="color: #61AFEF; ">is_tuple</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Converts the argument to a string according to the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `String.Chars` protocol.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This is the function invoked when there is string interpolation.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; to_string(:foo)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;foo&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="string" style="color: #98C379; ">:&quot;Elixir.String.Chars&quot;</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Converts the given term to a charlist according to the `List.Chars` protocol.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; to_charlist(:foo)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~c&quot;foo&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">to_charlist</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">List.Chars</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_charlist</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `term` is `nil`, `false` otherwise.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Allowed in guard clauses.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_nil(1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; is_nil(nil)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">is_nil</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  A convenience macro that checks if the right side (an expression) matches the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  left side (a pattern).</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; match?(1, 1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; match?({1, _}, {1, 2})</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; map = %{a: 1, b: 2}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; match?(%{a: _}, map)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; a = 1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; match?(^a, 1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `match?/2` is very useful when filtering or finding a value in an enumerable:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; list = [a: 1, b: 2, a: 3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Enum.filter(list, &amp;match?({:a, _}, &amp;1))</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [a: 1, a: 3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Guard clauses can also be given to the match:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; list = [a: 1, b: 2, a: 3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Enum.filter(list, &amp;match?({:a, x} when x &lt; 2, &amp;1))</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [a: 1]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Variables assigned in the match will not be available outside of the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  function call (unlike regular pattern matching with the `=` operator):</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; match?(_x, 1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binding()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      []</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Values vs patterns</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Remember the pin operator matches _values_, not _patterns_.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Passing a variable as the pattern will always return `true` and will</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  result in a warning that the variable is unused:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      # don&#39;t do this</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      pattern = %{a: :a}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      match?(pattern, %{b: :b})</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Similarly, moving an expression out the pattern may no longer preserve</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  its semantics. For example:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      match?([_ | _], [1, 2, 3])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      pattern = [_ | _]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      match?(pattern, [1, 2, 3])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (CompileError) invalid use of _. _ can only be used inside patterns to ignore values and cannot be used in expressions. Make sure you are inside a pattern or change it accordingly</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Another example is that a map as a pattern performs a subset match, but not</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  once assigned to a variable:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      match?(%{x: 1}, %{x: 1, y: 2})</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      attrs = %{x: 1}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      match?(^attrs, %{x: 1, y: 2})</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The pin operator will check if the values are equal, using `===/2`, while</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  patterns have their own rules when matching maps, lists, and so forth.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Such behaviour is not specific to `match?/2`. The following code also</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  throws an exception:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      attrs = %{x: 1}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ^attrs = %{x: 1, y: 2}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; (MatchError) no match of right hand side value: %{x: 1, y: 2}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">match?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">pattern</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">success</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">pattern</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="constant" style="color: #56B6C2; ">true</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="text" style="color: #ABB2BF; ">failure</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">quote</span> <span class="string" style="color: #98C379; ">generated: </span><span class="constant" style="color: #56B6C2; ">true</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="constant" style="color: #56B6C2; ">false</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:case</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">success</span> <span class="operator" style="color: #C678DD; ">++</span> <span class="text" style="color: #ABB2BF; ">failure</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Module attribute unary operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Reads and writes attributes in the current module.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The canonical example for attributes is annotating that a module</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  implements an OTP behaviour, such as `GenServer`:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule MyServer do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        @behaviour GenServer</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        # ... callbacks ...</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  By default Elixir supports all the module attributes supported by Erlang, but</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  custom attributes can be used as well:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule MyServer do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        @my_data 13</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        IO.inspect(@my_data)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        #=&gt; 13</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Unlike Erlang, such attributes are not stored in the module by default since</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  it is common in Elixir to use custom attributes to store temporary data that</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  will be available at compile-time. Custom attributes may be configured to</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  behave closer to Erlang by using `Module.register_attribute/3`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; #### Prefixing module attributes {: .tip}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; Libraries and frameworks should consider prefixing any</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; module attributes that are private by underscore, such as `@_my_data`,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; so code completion tools do not show them on suggestions and prompts.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Finally, note that attributes can also be read inside functions:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule MyServer do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        @my_data 11</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        def first_data, do: @my_data</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        @my_data 13</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        def second_data, do: @my_data</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      MyServer.first_data()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; 11</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      MyServer.second_data()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; 13</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It is important to note that reading an attribute takes a snapshot of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  its current value. In other words, the value is read at compilation</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  time and not at runtime. Check the `Module` module for other functions</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  to manipulate module attributes.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Attention! Multiple references of the same attribute</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  As mentioned above, every time you read a module attribute, a snapshot</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  of its current value is taken. Therefore, if you are storing large</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  values inside module attributes (for example, embedding external files</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  in module attributes), you should avoid referencing the same attribute</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  multiple times. For example, don&#39;t do this:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      @files %{</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        example1: File.read!(&quot;lib/example1.data&quot;),</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        example2: File.read!(&quot;lib/example2.data&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      }</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      def example1, do: @files[:example1]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      def example2, do: @files[:example2]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In the above, each reference to `@files` may end-up with a complete</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and individual copy of the whole `@files` module attribute. Instead,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  reference the module attribute once in a private function:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      @files %{</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        example1: File.read!(&quot;lib/example1.data&quot;),</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        example2: File.read!(&quot;lib/example2.data&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      }</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defp files(), do: @files</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      def example1, do: files()[:example1]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      def example2, do: files()[:example2]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Attention! Compile-time dependencies</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Keep in mind references to other modules, even in module attributes,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  generate compile-time dependencies to said modules.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  For example, take this common pattern:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      @values [:foo, :bar, :baz]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      def handle_arg(arg) when arg in @values do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        ...</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  While the above is fine, imagine if instead you have actual</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  module names in the module attribute, like this:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      @values [Foo, Bar, Baz]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      def handle_arg(arg) when arg in @values do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        ...</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The code above will define a compile-time dependency on the modules</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `Foo`, `Bar`, and `Baz`, in a way that, if any of them change, the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  current module will have to recompile. In such cases, it may be</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  preferred to avoid the module attribute altogether:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      def handle_arg(arg) when arg in [Foo, Bar, Baz] do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        ...</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">expr</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="operator" style="color: #C678DD; ">@</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:__aliases__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_args</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;module attributes set via @ cannot start with an uppercase letter&quot;</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="operator" style="color: #C678DD; ">@</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">assert_module_scope</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:@</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="text" style="color: #ABB2BF; ">function?</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">function</span> <span class="operator" style="color: #C678DD; ">!=</span> <span class="constant" style="color: #56B6C2; ">nil</span>

    <span class="keyword" style="color: #E06C75; ">cond</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="comment" style="font-style: italic; color: #5C6370; "># Check for Macro as it is compiled later than Kernel</span>
      <span class="keyword" style="color: #E06C75; ">not</span> <span class="function" style="color: #61AFEF; ">bootstrapped?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="constant" style="color: #56B6C2; ">nil</span>

      <span class="keyword" style="color: #E06C75; ">not</span> <span class="text" style="color: #ABB2BF; ">function?</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="string" style="color: #98C379; ">:match</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="string" style="color: #98C379; ">:guard</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span>
              <span class="string" style="color: #98C379; ">&quot;&quot;&quot;</span>
<span class="string" style="color: #98C379; ">              invalid usage of module attributes. Module attributes cannot be used inside \</span>
<span class="string" style="color: #98C379; ">              pattern matching (and guards) outside of a function. If you are trying to \</span>
<span class="string" style="color: #98C379; ">              define an attribute, do not do this:</span>
<span class="string" style="color: #98C379; "></span>
<span class="string" style="color: #98C379; ">                  @foo = :value</span>
<span class="string" style="color: #98C379; "></span>
<span class="string" style="color: #98C379; ">              Instead, do this:</span>
<span class="string" style="color: #98C379; "></span>
<span class="string" style="color: #98C379; ">                  @foo :value</span>
<span class="string" style="color: #98C379; ">              &quot;&quot;&quot;</span>

      <span class="comment" style="font-style: italic; color: #5C6370; "># Typespecs attributes are currently special cased by the compiler</span>
      <span class="function" style="color: #61AFEF; ">is_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="function" style="color: #61AFEF; ">typespec?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">case</span> <span class="function" style="color: #61AFEF; ">bootstrapped?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Kernel.Typespec</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
            <span class="string" style="color: #98C379; ">:ok</span>

          <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
            <span class="text" style="color: #ABB2BF; ">pos</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">:elixir_locals</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">cache_env</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
            <span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">line: </span><span class="text" style="color: #ABB2BF; ">line</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">file: </span><span class="text" style="color: #ABB2BF; ">file</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">module: </span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span>

            <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
              <span class="module" style="color: #61AFEF; ">Kernel.Typespec</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">deftypespec</span><span class="text" style="color: #ABB2BF; ">(</span>
                <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
                <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">escape</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">hd</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">unquote: </span><span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
                <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">line</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
                <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">file</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
                <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
                <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">pos</span><span class="text" style="color: #ABB2BF; ">)</span>
              <span class="text" style="color: #ABB2BF; ">)</span>
            <span class="keyword" style="color: #E06C75; ">end</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="function" style="color: #61AFEF; ">do_at</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">function?</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; "># @attribute(value)</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">do_at</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">function?</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">line</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">case</span> <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">keymember</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="constant" style="color: #56B6C2; ">nil</span>
        <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">line</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="keyword" style="color: #E06C75; ">cond</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">function?</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;cannot set attribute @<span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">}</span></span> inside function/macro&quot;</span>

      <span class="text" style="color: #ABB2BF; ">name</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="string" style="color: #98C379; ">:behavior</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;@behavior attribute is not supported, please use @behaviour instead&quot;</span>

      <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">member</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">:moduledoc</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:typedoc</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:doc</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">arg</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">line</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">}</span>

        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="module" style="color: #61AFEF; ">Module</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">__put_attribute__</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__MODULE__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">line</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">traces</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">collect_traces</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span>

        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="module" style="color: #61AFEF; ">Module</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">__put_attribute__</span><span class="text" style="color: #ABB2BF; ">(</span>
            <span class="constant builtin" style="color: #D19A66; ">__MODULE__</span><span class="text" style="color: #ABB2BF; ">,</span>
            <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
            <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
            <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">line</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
            <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">escape</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">traces</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; "># @attribute()</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">do_at</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">function?</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">IO</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">warn</span><span class="text" style="color: #ABB2BF; ">(</span>
      <span class="string" style="color: #98C379; ">&quot;the @<span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">}</span></span>() notation (with parentheses) is deprecated, please use @<span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">}</span></span> (without parentheses) instead&quot;</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="module" style="color: #61AFEF; ">Macro.Env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">stacktrace</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="text" style="color: #ABB2BF; ">)</span>

    <span class="function" style="color: #61AFEF; ">do_at</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">function?</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; "># @attribute</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">do_at</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">function?</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">line</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">line</span>
    <span class="text" style="color: #ABB2BF; ">doc_attr?</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">member</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">:moduledoc</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:typedoc</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:doc</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">function?</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">value</span> <span class="operator" style="color: #C678DD; ">=</span>
          <span class="keyword" style="color: #E06C75; ">case</span> <span class="module" style="color: #61AFEF; ">Module</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">__get_attribute__</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">line</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">false</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
            <span class="text" style="color: #ABB2BF; ">{</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">doc</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="text" style="color: #ABB2BF; ">doc_attr?</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">doc</span>
            <span class="text" style="color: #ABB2BF; ">other</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">other</span>
          <span class="keyword" style="color: #E06C75; ">end</span>

        <span class="keyword" style="color: #E06C75; ">try</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="module" style="color: #61AFEF; ">:elixir_quote</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">escape</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">value</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:none</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">false</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">rescue</span>
          <span class="text" style="color: #ABB2BF; ">ex</span> <span class="keyword" style="color: #E06C75; ">in</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
            <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span>
                  <span class="string" style="color: #98C379; ">&quot;cannot inject attribute @<span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">}</span></span> into function/macro because &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
                    <span class="module" style="color: #61AFEF; ">Exception</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">message</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">ex</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="constant" style="color: #56B6C2; ">false</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="text" style="color: #ABB2BF; ">doc_attr?</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="keyword" style="color: #E06C75; ">case</span> <span class="module" style="color: #61AFEF; ">Module</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">__get_attribute__</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__MODULE__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">line</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">false</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
            <span class="text" style="color: #ABB2BF; ">{</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">doc</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">doc</span>
            <span class="text" style="color: #ABB2BF; ">other</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">other</span>
          <span class="keyword" style="color: #E06C75; ">end</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="module" style="color: #61AFEF; ">Module</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">__get_attribute__</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__MODULE__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">line</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; "># Error cases</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">do_at</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">ctx_or_args</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:do</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">kw</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_function?</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_env</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">args</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">case</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">ctx_or_args</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span>
        <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">ctx_or_args</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="text" style="color: #ABB2BF; ">code</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="string" style="color: #98C379; ">&quot;<span class="string" style="color: #98C379; ">\n</span>@<span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">}</span></span> (<span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span> <span class="operator" style="color: #C678DD; ">++</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">kw</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>)&quot;</span>

    <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;&quot;&quot;</span>
<span class="string" style="color: #98C379; ">    expected 0 or 1 argument for @<span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">}</span></span>, got 2.</span>
<span class="string" style="color: #98C379; "></span>
<span class="string" style="color: #98C379; ">    It seems you are trying to use the do-syntax with @module attributes \</span>
<span class="string" style="color: #98C379; ">    but the do-block binds to the attribute name. You probably want \</span>
<span class="string" style="color: #98C379; ">    to wrap the argument value in parentheses, like this:</span>
<span class="string" style="color: #98C379; ">    <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="module" style="color: #61AFEF; ">String</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">replace</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">code</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;<span class="string" style="color: #98C379; ">\n</span>&quot;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;<span class="string" style="color: #98C379; ">\n</span>    &quot;</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span></span>
<span class="string" style="color: #98C379; ">    &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">do_at</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_function?</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_env</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;expected 0 or 1 argument for @<span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">}</span></span>, got: <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="function" style="color: #61AFEF; ">length</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; "># Those are always compile-time dependencies, so we can skip the trace.</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">collect_traces</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:before_compile</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_env</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">collect_traces</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:after_compile</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_env</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">collect_traces</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:after_verify</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_env</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">collect_traces</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:on_definition</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_env</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">collect_traces</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">lexical_tracker: </span><span class="text" style="color: #ABB2BF; ">pid</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_pid</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">pid</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">env</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">env</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="string" style="color: #98C379; ">function: </span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:__info__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">}</span>

    <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">aliases</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand_literals</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">fn</span>
        <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:__aliases__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">alias</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">acc</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
          <span class="keyword" style="color: #E06C75; ">case</span> <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">alias</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
            <span class="text" style="color: #ABB2BF; ">atom</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">atom</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">atom</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="module" style="color: #61AFEF; ">Map</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">put</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">acc</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">atom</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span>
            <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">alias</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">acc</span><span class="text" style="color: #ABB2BF; ">}</span>
          <span class="keyword" style="color: #E06C75; ">end</span>

        <span class="text" style="color: #ABB2BF; ">node</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">acc</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
          <span class="text" style="color: #ABB2BF; ">{</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">node</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">acc</span><span class="text" style="color: #ABB2BF; ">}</span>
      <span class="keyword" style="color: #E06C75; ">end</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="keyword" style="color: #E06C75; ">case</span> <span class="function" style="color: #61AFEF; ">map_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">aliases</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">0</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span>
      <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">line</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">lexical_tracker</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">tracers</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="module" style="color: #61AFEF; ">:maps</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">keys</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">aliases</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">collect_traces</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_env</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">typespec?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:type</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">typespec?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:typep</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">typespec?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:opaque</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">typespec?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:spec</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">typespec?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:callback</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">typespec?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:macrocallback</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">typespec?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="constant" style="color: #56B6C2; ">false</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns the binding for the given context as a keyword list.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In the returned result, keys are variable names and values are the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  corresponding variable values.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the given `context` is `nil` (by default it is), the binding for the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  current context is returned.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; x = 1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binding()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [x: 1]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; x = 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binding()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [x: 2]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binding(:foo)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      []</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; var!(x, :foo) = 1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binding(:foo)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [x: 1]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">binding</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">context</span> <span class="operator" style="color: #C678DD; ">\\</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">in_match?</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Macro.Env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">in_match?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="text" style="color: #ABB2BF; ">bindings</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">for</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">v</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">c</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">&lt;-</span> <span class="module" style="color: #61AFEF; ">Macro.Env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">vars</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">c</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="text" style="color: #ABB2BF; ">context</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">v</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="function" style="color: #61AFEF; ">wrap_binding</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">in_match?</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">v</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">generated: </span><span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">c</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">usort</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">bindings</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">wrap_binding</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="operator" style="color: #C678DD; ">^</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">wrap_binding</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">var</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Provides an `if/2` macro.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This macro expects the first argument to be a condition and the second</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  argument to be a keyword list.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## One-liner examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      if(foo, do: bar)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In the example above, `bar` will be returned if `foo` evaluates to</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  a truthy value (neither `false` nor `nil`). Otherwise, `nil` will be</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  returned.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  An `else` option can be given to specify the opposite:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      if(foo, do: bar, else: baz)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Blocks examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It&#39;s also possible to pass a block to the `if/2` macro. The first</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  example above would be translated to:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      if foo do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        bar</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note that `do`-`end` become delimiters. The second example would</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  translate to:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      if foo do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        bar</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      else</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        baz</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In order to compare more than two clauses, the `cond/1` macro has to be used.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">if</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">condition</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">clauses</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">build_if</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">condition</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">clauses</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">build_if</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">condition</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">do_clause</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">build_if</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">condition</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">do_clause</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">else: </span><span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">build_if</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">condition</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">do_clause</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">else: </span><span class="text" style="color: #ABB2BF; ">else_clause</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">optimize_boolean</span><span class="text" style="color: #ABB2BF; ">(</span>
      <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="keyword" style="color: #E06C75; ">case</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">condition</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="text" style="color: #ABB2BF; ">x</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="string" style="color: #98C379; ">:&quot;Elixir.Kernel&quot;</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">x</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="constant" style="color: #56B6C2; ">false</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">else_clause</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">do_clause</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
      <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">build_if</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_condition</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_arguments</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span>
          <span class="string" style="color: #98C379; ">&quot;invalid or duplicate keys for if, only <span class="string" style="color: #98C379; ">\&quot;</span>do<span class="string" style="color: #98C379; ">\&quot;</span> and an optional <span class="string" style="color: #98C379; ">\&quot;</span>else<span class="string" style="color: #98C379; ">\&quot;</span> are permitted&quot;</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Provides an `unless` macro.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This macro evaluates and returns the `do` block passed in as the second</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  argument if `condition` evaluates to a falsy value (`false` or `nil`).</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Otherwise, it returns the value of the `else` block if present or `nil` if not.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  See also `if/2`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; unless(Enum.empty?([]), do: &quot;Hello&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      nil</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; unless(Enum.empty?([1, 2, 3]), do: &quot;Hello&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;Hello&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; unless Enum.sum([2, 2]) == 5 do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ...&gt;   &quot;Math still works&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ...&gt; else</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ...&gt;   &quot;Math is broken&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ...&gt; end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;Math still works&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">unless</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">condition</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">clauses</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">build_unless</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">condition</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">clauses</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">build_unless</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">condition</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">do_clause</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">build_unless</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">condition</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">do_clause</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">else: </span><span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">build_unless</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">condition</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">do_clause</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">else: </span><span class="text" style="color: #ABB2BF; ">else_clause</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="keyword" style="color: #E06C75; ">if</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">condition</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">else_clause</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">else: </span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">do_clause</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">build_unless</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_condition</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_arguments</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span>
          <span class="string" style="color: #98C379; ">&quot;invalid or duplicate keys for unless, &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
            <span class="string" style="color: #98C379; ">&quot;only <span class="string" style="color: #98C379; ">\&quot;</span>do<span class="string" style="color: #98C379; ">\&quot;</span> and an optional <span class="string" style="color: #98C379; ">\&quot;</span>else<span class="string" style="color: #98C379; ">\&quot;</span> are permitted&quot;</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Destructures two lists, assigning each term in the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  right one to the matching term in the left one.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Unlike pattern matching via `=`, if the sizes of the left</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and right lists don&#39;t match, destructuring simply stops</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  instead of raising an error.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; destructure([x, y, z], [1, 2, 3, 4, 5])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; {x, y, z}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      {1, 2, 3}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In the example above, even though the right list has more entries than the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  left one, destructuring works fine. If the right list is smaller, the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  remaining elements are simply set to `nil`:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; destructure([x, y, z], [1])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; {x, y, z}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      {1, nil, nil}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The left-hand side supports any expression you would use</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  on the left-hand side of a match:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      x = 1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      destructure([^x, y, z], [1, 2, 3])</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The example above will only work if `x` matches the first value in the right</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  list. Otherwise, it will raise a `MatchError` (like the `=` operator would</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  do).</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">destructure</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Kernel.Utils</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">destructure</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">length</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Creates a range from `first` to `last`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If first is less than last, the range will be increasing from</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  first to last. If first is equal to last, the range will contain</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  one element, which is the number itself.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If first is more than last, the range will be decreasing from first</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  to last, albeit this behaviour is deprecated. Instead prefer to</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  explicitly list the step with `first..last//-1`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  See the `Range` module for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 0 in 1..3</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 2 in 1..3</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Enum.to_list(1..3)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [1, 2, 3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="operator" style="color: #C678DD; ">..</span><span class="text" style="color: #ABB2BF; ">last</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="function" style="color: #61AFEF; ">bootstrapped?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">first</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="text" style="color: #ABB2BF; ">last</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="function" style="color: #61AFEF; ">validate_range!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="function" style="color: #61AFEF; ">range</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="function" style="color: #61AFEF; ">range</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">range</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="comment" style="font-style: italic; color: #5C6370; "># TODO: Deprecate inferring a range with a step of -1 on Elixir v1.17</span>
    <span class="text" style="color: #ABB2BF; ">step</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="keyword" style="color: #E06C75; ">if</span> <span class="text" style="color: #ABB2BF; ">first</span> <span class="operator" style="color: #C678DD; ">&lt;=</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">else: </span><span class="operator" style="color: #C678DD; ">-</span><span class="text" style="color: #ABB2BF; ">1</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:%{}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">__struct__: </span><span class="module" style="color: #61AFEF; ">Elixir.Range</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">first: </span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">last: </span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">step: </span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">range</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">Elixir.Range</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">new</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">range</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:guard</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="comment" style="font-style: italic; color: #5C6370; "># We need to compute the step using guards. We don&#39;t have conditionals,</span>
    <span class="comment" style="font-style: italic; color: #5C6370; "># but we can emulate them using a map access.</span>
    <span class="text" style="color: #ABB2BF; ">step</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map_get</span><span class="text" style="color: #ABB2BF; ">(</span>
          <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">&gt;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
          <span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">false: </span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">true: </span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">-</span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span>
        <span class="text" style="color: #ABB2BF; ">)</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="comment" style="font-style: italic; color: #5C6370; "># TODO: Deprecate me inside guard when sides are not integers on Elixir v1.17</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:%{}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">__struct__: </span><span class="module" style="color: #61AFEF; ">Elixir.Range</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">first: </span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">last: </span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">step: </span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">range</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:match</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="comment" style="font-style: italic; color: #5C6370; "># TODO: Deprecate me inside match in all occasions (including literals) on Elixir v1.17</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:%{}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">__struct__: </span><span class="module" style="color: #61AFEF; ">Elixir.Range</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">first: </span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">last: </span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Creates a range from `first` to `last` with `step`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  See the `Range` module for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 0 in 1..3//1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 2 in 1..3//1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 2 in 1..3//2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Enum.to_list(1..3//1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [1, 2, 3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Enum.to_list(1..3//2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [1, 3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Enum.to_list(3..1//-1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [3, 2, 1]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Enum.to_list(1..0//1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      []</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.12.0&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="operator" style="color: #C678DD; ">..</span><span class="text" style="color: #ABB2BF; ">last</span><span class="operator" style="color: #C678DD; ">//</span><span class="text" style="color: #ABB2BF; ">step</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="function" style="color: #61AFEF; ">bootstrapped?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">first</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="text" style="color: #ABB2BF; ">last</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="text" style="color: #ABB2BF; ">step</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="function" style="color: #61AFEF; ">validate_range!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="function" style="color: #61AFEF; ">validate_step!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="function" style="color: #61AFEF; ">range</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="function" style="color: #61AFEF; ">range</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">range</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span>
       <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span>
       <span class="keyword" style="color: #E06C75; ">when</span> <span class="text" style="color: #ABB2BF; ">context</span> <span class="operator" style="color: #C678DD; ">!=</span> <span class="constant" style="color: #56B6C2; ">nil</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:%{}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">__struct__: </span><span class="module" style="color: #61AFEF; ">Elixir.Range</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">first: </span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">last: </span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">step: </span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">range</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">Elixir.Range</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">new</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">validate_range!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span>
       <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_float</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="function" style="color: #61AFEF; ">is_float</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span>
              <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="function" style="color: #61AFEF; ">is_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="function" style="color: #61AFEF; ">is_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span>
          <span class="string" style="color: #98C379; ">&quot;ranges (first..last//step) expect both sides to be integers, &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
            <span class="string" style="color: #98C379; ">&quot;got: <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:..</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">validate_range!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="string" style="color: #98C379; ">:ok</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">validate_step!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span>
       <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_float</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="function" style="color: #61AFEF; ">is_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="text" style="color: #ABB2BF; ">step</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="text" style="color: #ABB2BF; ">0</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span>
          <span class="string" style="color: #98C379; ">&quot;ranges (first..last//step) expect the step to be a non-zero integer, &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
            <span class="string" style="color: #98C379; ">&quot;got: <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">validate_step!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="string" style="color: #98C379; ">:ok</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Creates the full-slice range `0..-1//1`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This macro returns a range with the following properties:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * When enumerated, it is empty</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * When used as a `slice`, it returns the sliced element as is</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  See `..///3` and the `Range` module for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Enum.to_list(..)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      []</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; String.slice(&quot;Hello world!&quot;, ..)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;Hello world!&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.14.0&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">..</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">range</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">0</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="operator" style="color: #C678DD; ">-</span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Boolean &quot;and&quot; operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Provides a short-circuit operator that evaluates and returns</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the second expression only if the first one evaluates to a truthy value</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  (neither `false` nor `nil`). Returns the first expression</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  otherwise.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Not allowed in guard clauses.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Enum.empty?([]) &amp;&amp; Enum.empty?([])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; List.first([]) &amp;&amp; true</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      nil</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Enum.empty?([]) &amp;&amp; List.first([1])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      1</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; false &amp;&amp; throw(:bad)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note that, unlike `and/2`, this operator accepts any expression</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  as the first argument, not only booleans.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">&amp;&amp;</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">assert_no_match_or_guard_scope</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;&amp;&amp;&quot;</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="keyword" style="color: #E06C75; ">case</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="text" style="color: #ABB2BF; ">x</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="string" style="color: #98C379; ">:&quot;Elixir.Kernel&quot;</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">x</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="constant" style="color: #56B6C2; ">false</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
          <span class="text" style="color: #ABB2BF; ">x</span>

        <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
          <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Boolean &quot;or&quot; operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Provides a short-circuit operator that evaluates and returns the second</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  expression only if the first one does not evaluate to a truthy value (that is,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  it is either `nil` or `false`). Returns the first expression otherwise.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Not allowed in guard clauses.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Enum.empty?([1]) || Enum.empty?([1])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; List.first([]) || true</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Enum.empty?([1]) || 1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      1</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Enum.empty?([]) || throw(:bad)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note that, unlike `or/2`, this operator accepts any expression</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  as the first argument, not only booleans.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">||</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">assert_no_match_or_guard_scope</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;||&quot;</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="keyword" style="color: #E06C75; ">case</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="text" style="color: #ABB2BF; ">x</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="string" style="color: #98C379; ">:&quot;Elixir.Kernel&quot;</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">in</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">x</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="constant" style="color: #56B6C2; ">false</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
          <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>

        <span class="text" style="color: #ABB2BF; ">x</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
          <span class="text" style="color: #ABB2BF; ">x</span>
      <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Pipe operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This operator introduces the expression on the left-hand side as</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the first argument to the function call on the right-hand side.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; [1, [2], 3] |&gt; List.flatten()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [1, 2, 3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The example above is the same as calling `List.flatten([1, [2], 3])`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The `|&gt;/2` operator is mostly useful when there is a desire to execute a series</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  of operations resembling a pipeline:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; [1, [2], 3] |&gt; List.flatten() |&gt; Enum.map(fn x -&gt; x * 2 end)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [2, 4, 6]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In the example above, the list `[1, [2], 3]` is passed as the first argument</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  to the `List.flatten/1` function, then the flattened list is passed as the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  first argument to the `Enum.map/2` function which doubles each element of the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  list.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In other words, the expression above simply translates to:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      Enum.map(List.flatten([1, [2], 3]), fn x -&gt; x * 2 end)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Pitfalls</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  There are two common pitfalls when using the pipe operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The first one is related to operator precedence. For example,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the following expression:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      String.graphemes &quot;Hello&quot; |&gt; Enum.reverse</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Translates to:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      String.graphemes(&quot;Hello&quot; |&gt; Enum.reverse())</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  which results in an error as the `Enumerable` protocol is not defined</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  for binaries. Adding explicit parentheses resolves the ambiguity:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      String.graphemes(&quot;Hello&quot;) |&gt; Enum.reverse()</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Or, even better:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;Hello&quot; |&gt; String.graphemes() |&gt; Enum.reverse()</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The second limitation is that Elixir always pipes to a function</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  call. Therefore, to pipe into an anonymous function, you need to</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  invoke it:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      some_fun = &amp;Regex.replace(~r/l/, &amp;1, &quot;L&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;Hello&quot; |&gt; some_fun.()</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Alternatively, you can use `then/2` for the same effect:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      some_fun = &amp;Regex.replace(~r/l/, &amp;1, &quot;L&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;Hello&quot; |&gt; then(some_fun)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `then/2` is most commonly used when you want to pipe to a function</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  but the value is expected outside of the first argument, such as</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  above. By replacing `some_fun` by its value, we get:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;Hello&quot; |&gt; then(&amp;Regex.replace(~r/l/, &amp;1, &quot;L&quot;))</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="operator" style="color: #C678DD; ">|&gt;</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">fun</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="keyword" style="color: #E06C75; ">fn</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">x</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">pos</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">acc</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
      <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">pipe</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">acc</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">x</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">pos</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">foldl</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">unpipe</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `module` is loaded and contains a</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  public `function` with the given `arity`, otherwise `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note that this function does not load the module in case</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  it is not loaded. Check `Code.ensure_loaded/1` for more</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Inlined by the compiler.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; function_exported?(Enum, :map, 2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; function_exported?(Enum, :map, 10)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; function_exported?(List, :to_string, 1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">function_exported?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">atom</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arity</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">function_exported?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">function</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arity</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">function_exported</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">function</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arity</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns `true` if `module` is loaded and contains a</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  public `macro` with the given `arity`, otherwise `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note that this function does not load the module in case</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  it is not loaded. Check `Code.ensure_loaded/1` for more</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If `module` is an Erlang module (as opposed to an Elixir module), this</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  function always returns `false`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; macro_exported?(Kernel, :use, 2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; macro_exported?(:erlang, :abs, 1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="function" style="color: #61AFEF; ">macro_exported?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">atom</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arity</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">boolean</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">macro_exported?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">macro</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arity</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">macro</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">arity</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
             <span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">arity</span> <span class="operator" style="color: #C678DD; ">&gt;=</span> <span class="text" style="color: #ABB2BF; ">0</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="text" style="color: #ABB2BF; ">arity</span> <span class="operator" style="color: #C678DD; ">&lt;=</span> <span class="text" style="color: #ABB2BF; ">255</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">function_exported?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:__info__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
      <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">member</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">macro</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arity</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">module</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">__info__</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:macros</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Power operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It takes two numbers for input. If both are integers and the right-hand</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  side (the `exponent`) is also greater than or equal to 0, then the result</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  will also be an integer. Otherwise it returns a float.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 2 ** 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      4</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 2 ** -4</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      0.0625</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 2.0 ** 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      4.0</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; 2 ** 2.0</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      4.0</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.13.0&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">**</span> <span class="text" style="color: #ABB2BF; ">non_neg_integer</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">integer</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">**</span> <span class="text" style="color: #ABB2BF; ">neg_integer</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">float</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">**</span> <span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">float</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">**</span> <span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">float</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="text" style="color: #ABB2BF; ">float</span> <span class="operator" style="color: #C678DD; ">**</span> <span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="text" style="color: #ABB2BF; ">float</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">base</span> <span class="operator" style="color: #C678DD; ">**</span> <span class="text" style="color: #ABB2BF; ">exponent</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">base</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">exponent</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="text" style="color: #ABB2BF; ">exponent</span> <span class="operator" style="color: #C678DD; ">&gt;=</span> <span class="text" style="color: #ABB2BF; ">0</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">integer_pow</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">base</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">exponent</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">def</span> <span class="text" style="color: #ABB2BF; ">base</span> <span class="operator" style="color: #C678DD; ">**</span> <span class="text" style="color: #ABB2BF; ">exponent</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_number</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">base</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="function" style="color: #61AFEF; ">is_number</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">exponent</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:math</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">pow</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">base</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">exponent</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; "># https://en.wikipedia.org/wiki/Exponentiation_by_squaring</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">integer_pow</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">0</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
    <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">1</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">integer_pow</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">b</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">a</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
    <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">b</span> <span class="operator" style="color: #C678DD; ">*</span> <span class="text" style="color: #ABB2BF; ">a</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">integer_pow</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">b</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">a</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">e</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">band</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">e</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="text" style="color: #ABB2BF; ">0</span><span class="text" style="color: #ABB2BF; ">,</span>
    <span class="string" style="color: #98C379; ">do: </span><span class="function" style="color: #61AFEF; ">integer_pow</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">b</span> <span class="operator" style="color: #C678DD; ">*</span> <span class="text" style="color: #ABB2BF; ">b</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">a</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">bsr</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">e</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">integer_pow</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">b</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">a</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">e</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
    <span class="string" style="color: #98C379; ">do: </span><span class="function" style="color: #61AFEF; ">integer_pow</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">b</span> <span class="operator" style="color: #C678DD; ">*</span> <span class="text" style="color: #ABB2BF; ">b</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">a</span> <span class="operator" style="color: #C678DD; ">*</span> <span class="text" style="color: #ABB2BF; ">b</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">bsr</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">e</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Membership operator.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Checks if the element on the left-hand side is a member of the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  collection on the right-hand side.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; x = 1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; x in [1, 2, 3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This operator (which is a macro) simply translates to a call to</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `Enum.member?/2`. The example above would translate to:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      Enum.member?([1, 2, 3], x)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Elixir also supports `left not in right`, which evaluates to</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `not(left in right)`:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; x = 1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; x not in [1, 2, 3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      false</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Guards</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The `in/2` operator (as well as `not in`) can be used in guard clauses as</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  long as the right-hand side is a range or a list.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the right-hand side is a list, Elixir will expand the operator to a valid</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  guard expression which needs to check each value. For example:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      when x in [1, 2, 3]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  translates to:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      when x === 1 or x === 2 or x === 3</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  However, this construct will be inefficient for large lists. In such cases, it</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  is best to stop using guards and use a more appropriate data structure, such</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  as `MapSet`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the right-hand side is a range, a more efficient comparison check will be</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  done. For example:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      when x in 1..1000</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  translates roughly to:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      when x &gt;= 1 and x &lt;= 1000</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ### AST considerations</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `left not in right` is parsed by the compiler into the AST:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      {:not, _, [{:in, _, [left, right]}]}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This is the same AST as `not(left in right)`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Additionally, `Macro.to_string/2` and `Code.format_string!/2`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  will translate all occurrences of this AST to `left not in right`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="text" style="color: #ABB2BF; ">left</span> <span class="keyword" style="color: #E06C75; ">in</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">in_body?</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="constant" style="color: #56B6C2; ">nil</span>

    <span class="text" style="color: #ABB2BF; ">expand</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">case</span> <span class="function" style="color: #61AFEF; ">bootstrapped?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="operator" style="color: #C678DD; ">&amp;</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="operator" style="color: #C678DD; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="operator" style="color: #C678DD; ">&amp;</span> <span class="operator" style="color: #C678DD; ">&amp;</span><span class="operator" style="color: #C678DD; ">1</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">expand</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="keyword" style="color: #E06C75; ">not</span> <span class="text" style="color: #ABB2BF; ">in_body?</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="constant" style="color: #56B6C2; ">false</span>

      <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="constant" style="color: #56B6C2; ">false</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">head</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">list</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="comment" style="font-style: italic; color: #5C6370; "># We only expand lists in the body if they are relatively</span>
        <span class="comment" style="font-style: italic; color: #5C6370; "># short and it is made only of literal expressions.</span>
        <span class="keyword" style="color: #E06C75; ">case</span> <span class="keyword" style="color: #E06C75; ">not</span> <span class="text" style="color: #ABB2BF; ">in_body?</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="function" style="color: #61AFEF; ">small_literal_list?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="function" style="color: #61AFEF; ">in_var</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">in_body?</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="operator" style="color: #C678DD; ">&amp;</span><span class="function" style="color: #61AFEF; ">in_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="operator" style="color: #C678DD; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">head</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expand</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">in_body?</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">member</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">right</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;found unescaped value on the right side of in/2: <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span>

      <span class="text" style="color: #ABB2BF; ">right</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">with</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:%{}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">&lt;-</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">,</span>
             <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">__struct__: </span><span class="module" style="color: #61AFEF; ">Elixir.Range</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">first: </span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">last: </span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">step: </span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">&lt;-</span>
               <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">usort</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="function" style="color: #61AFEF; ">in_var</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">in_body?</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="operator" style="color: #C678DD; ">&amp;</span><span class="function" style="color: #61AFEF; ">in_range</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="operator" style="color: #C678DD; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expand</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expand</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expand</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">else</span>
          <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="text" style="color: #ABB2BF; ">in_body?</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
            <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">Elixir.Enum</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">member?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

          <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
            <span class="function" style="color: #61AFEF; ">raise_on_invalid_args_in_2</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">raise_on_invalid_args_in_2</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">&lt;&lt;</span>
      <span class="string" style="color: #98C379; ">&quot;invalid right argument for operator <span class="string" style="color: #98C379; ">\&quot;</span>in<span class="string" style="color: #98C379; ">\&quot;</span>, it expects a compile-time proper list &quot;</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">&quot;or compile-time range on the right side when used in guard expressions, got: &quot;</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span><span class="operator" style="color: #C678DD; ">::</span><span class="text" style="color: #ABB2BF; ">binary</span>
    <span class="text" style="color: #ABB2BF; ">&gt;&gt;</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">in_var</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant" style="color: #56B6C2; ">false</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">ast</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">fun</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">ast</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">in_var</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">atom</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">context</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">atom</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">context</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
    <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">fun</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">in_var</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">ast</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">var</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">ast</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">small_literal_list?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="function" style="color: #61AFEF; ">length</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">&lt;=</span> <span class="text" style="color: #ABB2BF; ">32</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">all</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">fn</span> <span class="text" style="color: #ABB2BF; ">x</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">x</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">x</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="function" style="color: #61AFEF; ">is_number</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">x</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">end</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">list</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">small_literal_list?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_list</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="constant" style="color: #56B6C2; ">false</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">in_range</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">in_range_literal</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">in_range</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">quoted</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
          <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
          <span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">&gt;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">0</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
              <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">increasing_compare</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">or</span>
             <span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">&lt;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">0</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span>
                <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">decreasing_compare</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="function" style="color: #61AFEF; ">in_range_step</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">quoted</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">in_range_literal</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_step</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="string" style="color: #98C379; ">&quot;=:=&quot;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">in_range_literal</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="text" style="color: #ABB2BF; ">step</span> <span class="operator" style="color: #C678DD; ">&gt;</span> <span class="text" style="color: #ABB2BF; ">0</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">quoted</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">andalso</span><span class="text" style="color: #ABB2BF; ">(</span>
          <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
          <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">increasing_compare</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="text" style="color: #ABB2BF; ">)</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="function" style="color: #61AFEF; ">in_range_step</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">quoted</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">in_range_literal</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="text" style="color: #ABB2BF; ">step</span> <span class="operator" style="color: #C678DD; ">&lt;</span> <span class="text" style="color: #ABB2BF; ">0</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">quoted</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">andalso</span><span class="text" style="color: #ABB2BF; ">(</span>
          <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
          <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">decreasing_compare</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="text" style="color: #ABB2BF; ">)</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="function" style="color: #61AFEF; ">in_range_step</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">quoted</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">in_range_step</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">quoted</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="text" style="color: #ABB2BF; ">step</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="text" style="color: #ABB2BF; ">1</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="text" style="color: #ABB2BF; ">step</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="operator" style="color: #C678DD; ">-</span><span class="text" style="color: #ABB2BF; ">1</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">quoted</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">in_range_step</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">quoted</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">andalso</span><span class="text" style="color: #ABB2BF; ">(</span>
        <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">quoted</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
        <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="string" style="color: #98C379; ">&quot;=:=&quot;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">rem</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">0</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">in_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">head</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expand</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">in_body?</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">head</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="function" style="color: #61AFEF; ">comp</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="operator" style="color: #C678DD; ">&amp;</span><span class="operator" style="color: #C678DD; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expand</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">in_body?</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">head</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">foldl</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">orelse</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="operator" style="color: #C678DD; ">2</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="operator" style="color: #C678DD; ">1</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">head</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">comp</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:|</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">head</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expand</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">in_body?</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">expand</span><span class="operator" style="color: #C678DD; ">.</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="string" style="color: #98C379; ">&quot;=:=&quot;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">head</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">tail_head</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">orelse</span><span class="text" style="color: #ABB2BF; ">(</span>
            <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="string" style="color: #98C379; ">&quot;=:=&quot;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">head</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
            <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">in_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">tail_head</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expand</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">in_body?</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="text" style="color: #ABB2BF; ">tail</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="text" style="color: #ABB2BF; ">in_body?</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">orelse</span><span class="text" style="color: #ABB2BF; ">(</span>
            <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="string" style="color: #98C379; ">&quot;=:=&quot;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">head</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
            <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">member</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">tail</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="function" style="color: #61AFEF; ">raise_on_invalid_args_in_2</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">comp</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_expand</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_right</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_in_body?</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="string" style="color: #98C379; ">&quot;=:=&quot;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">left</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">right</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">increasing_compare</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">andalso</span><span class="text" style="color: #ABB2BF; ">(</span>
        <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">&gt;=</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
        <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="string" style="color: #98C379; ">&quot;=&lt;&quot;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">decreasing_compare</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">andalso</span><span class="text" style="color: #ABB2BF; ">(</span>
        <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="string" style="color: #98C379; ">&quot;=&lt;&quot;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
        <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">&gt;=</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">last</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Marks that the given variable should not be hygienized.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This macro expects a variable and it is typically invoked</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  inside `quote/2` to mark that a variable</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  should not be hygienized. See `quote/2` for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Kernel.var!(example) = 1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Kernel.var!(example)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      1</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">var!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">var</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">context</span> <span class="operator" style="color: #C678DD; ">\\</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">var!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">atom</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">context</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">atom</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="comment" style="font-style: italic; color: #5C6370; "># Remove counter and force them to be vars</span>
    <span class="text" style="color: #ABB2BF; ">meta</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">keydelete</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:counter</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="text" style="color: #ABB2BF; ">meta</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">keystore</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:if_undefined</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:if_undefined</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:raise</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="keyword" style="color: #E06C75; ">case</span> <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">context</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">context</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">context</span><span class="text" style="color: #ABB2BF; ">}</span>

      <span class="text" style="color: #ABB2BF; ">other</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span>
              <span class="string" style="color: #98C379; ">&quot;expected var! context to expand to an atom, got: <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">var!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_context</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;expected a variable to be given to var!, got: <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  When used inside quoting, marks that the given alias should not</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  be hygienized. This means the alias will be expanded when</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the macro is expanded.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Check `quote/2` for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">alias!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">alias</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">alias</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">alias</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">alias!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:__aliases__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="comment" style="font-style: italic; color: #5C6370; "># Simply remove the alias metadata from the node</span>
    <span class="comment" style="font-style: italic; color: #5C6370; "># so it does not affect expansion.</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:__aliases__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">keydelete</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:alias</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns a binary starting at the offset `start` and of the given `size`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This is similar to `binary_part/3` except that if `start + size`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  is greater than the binary size, it automatically clips it to</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the binary size instead of raising. Opposite to `binary_part/3`,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  this function is not allowed in guards.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This function works with bytes. For a slicing operation that</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  considers characters, see `String.slice/3`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, 0, 6)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;elixir&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, 0, 5)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;elixi&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, 1, 4)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;lixi&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, 0, 10)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;elixir&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If `start` is negative, it is normalized against the binary</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  size and clamped to 0:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, -3, 10)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;xir&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, -10, 10)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;elixir&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the `size` is zero, an empty binary is returned:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, 1, 0)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If `start` is greater than or equal to the binary size,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  an empty binary is returned:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, 10, 10)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.14.0&quot;</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">binary_slice</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">start</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">size</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">start</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="function" style="color: #61AFEF; ">is_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">size</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="text" style="color: #ABB2BF; ">size</span> <span class="operator" style="color: #C678DD; ">&gt;=</span> <span class="text" style="color: #ABB2BF; ">0</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">total</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">byte_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="text" style="color: #ABB2BF; ">start</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="keyword" style="color: #E06C75; ">if</span> <span class="text" style="color: #ABB2BF; ">start</span> <span class="operator" style="color: #C678DD; ">&lt;</span> <span class="text" style="color: #ABB2BF; ">0</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="function" style="color: #61AFEF; ">max</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">total</span> <span class="operator" style="color: #C678DD; ">+</span> <span class="text" style="color: #ABB2BF; ">start</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">0</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">else: </span><span class="text" style="color: #ABB2BF; ">start</span>

    <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">start</span> <span class="operator" style="color: #C678DD; ">&lt;</span> <span class="text" style="color: #ABB2BF; ">total</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">binary_part</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">start</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="function" style="color: #61AFEF; ">min</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">size</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">total</span> <span class="operator" style="color: #C678DD; ">-</span> <span class="text" style="color: #ABB2BF; ">start</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="string" style="color: #98C379; ">&quot;&quot;</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Returns a binary from the offset given by the start of the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  range to the offset given by the end of the range.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the start or end of the range are negative, they are converted</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  into positive indices based on the binary size. For example,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `-1` means the last byte of the binary.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This is similar to `binary_part/3` except that it works with ranges</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and it is not allowed in guards.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This function works with bytes. For a slicing operation that</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  considers characters, see `String.slice/2`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, 0..5)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;elixir&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, 1..3)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;lix&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, 1..10)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;lixir&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, -4..-1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;ixir&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, -4..6)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;ixir&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, -10..10)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;elixir&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  For ranges where `start &gt; stop`, you need to explicitly</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  mark them as increasing:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, 2..-1//1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;ixir&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, 1..-2//1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;lixi&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  You can use `../0` as a shortcut for `0..-1//1`, which returns</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the whole binary as is:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, ..)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;elixir&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The step can be any positive number. For example, to</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  get every 2 characters of the binary:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, 0..-1//2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;eii&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the first position is after the string ends or after</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the last position of the range, it returns an empty string:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, 10..3//1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;elixir&quot;, -10..-7)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; binary_slice(&quot;a&quot;, 1..1500)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.14.0&quot;</span>
  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">binary_slice</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="operator" style="color: #C678DD; ">..</span><span class="text" style="color: #ABB2BF; ">last</span><span class="operator" style="color: #C678DD; ">//</span><span class="text" style="color: #ABB2BF; ">step</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="text" style="color: #ABB2BF; ">step</span> <span class="operator" style="color: #C678DD; ">&gt;</span> <span class="text" style="color: #ABB2BF; ">0</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">total</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">byte_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="text" style="color: #ABB2BF; ">first</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="keyword" style="color: #E06C75; ">if</span> <span class="text" style="color: #ABB2BF; ">first</span> <span class="operator" style="color: #C678DD; ">&lt;</span> <span class="text" style="color: #ABB2BF; ">0</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="function" style="color: #61AFEF; ">max</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">first</span> <span class="operator" style="color: #C678DD; ">+</span> <span class="text" style="color: #ABB2BF; ">total</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">0</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">else: </span><span class="text" style="color: #ABB2BF; ">first</span>
    <span class="text" style="color: #ABB2BF; ">last</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="keyword" style="color: #E06C75; ">if</span> <span class="text" style="color: #ABB2BF; ">last</span> <span class="operator" style="color: #C678DD; ">&lt;</span> <span class="text" style="color: #ABB2BF; ">0</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">last</span> <span class="operator" style="color: #C678DD; ">+</span> <span class="text" style="color: #ABB2BF; ">total</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">else: </span><span class="text" style="color: #ABB2BF; ">last</span>

    <span class="text" style="color: #ABB2BF; ">amount</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">last</span> <span class="operator" style="color: #C678DD; ">-</span> <span class="text" style="color: #ABB2BF; ">first</span> <span class="operator" style="color: #C678DD; ">+</span> <span class="text" style="color: #ABB2BF; ">1</span>

    <span class="keyword" style="color: #E06C75; ">if</span> <span class="text" style="color: #ABB2BF; ">first</span> <span class="operator" style="color: #C678DD; ">&lt;</span> <span class="text" style="color: #ABB2BF; ">total</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="text" style="color: #ABB2BF; ">amount</span> <span class="operator" style="color: #C678DD; ">&gt;</span> <span class="text" style="color: #ABB2BF; ">0</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">part</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">binary_part</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="function" style="color: #61AFEF; ">min</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">amount</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">total</span> <span class="operator" style="color: #C678DD; ">-</span> <span class="text" style="color: #ABB2BF; ">first</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="keyword" style="color: #E06C75; ">if</span> <span class="text" style="color: #ABB2BF; ">step</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="text" style="color: #ABB2BF; ">1</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="text" style="color: #ABB2BF; ">part</span>
      <span class="keyword" style="color: #E06C75; ">else</span>
        <span class="text" style="color: #ABB2BF; ">&lt;&lt;</span><span class="text" style="color: #ABB2BF; ">first_byte</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">rest</span><span class="operator" style="color: #C678DD; ">::</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">&gt;&gt;</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">part</span>
        <span class="keyword" style="color: #E06C75; ">for</span> <span class="text" style="color: #ABB2BF; ">&lt;&lt;</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="operator" style="color: #C678DD; ">::</span><span class="function" style="color: #61AFEF; ">size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">^</span><span class="text" style="color: #ABB2BF; ">step</span> <span class="operator" style="color: #C678DD; ">-</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span><span class="operator" style="color: #C678DD; ">-</span><span class="text" style="color: #ABB2BF; ">bytes</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">byte</span> <span class="operator" style="color: #C678DD; ">&lt;-</span> <span class="text" style="color: #ABB2BF; ">rest</span><span class="text" style="color: #ABB2BF; ">&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">into: </span><span class="text" style="color: #ABB2BF; ">&lt;&lt;</span><span class="text" style="color: #ABB2BF; ">first_byte</span><span class="text" style="color: #ABB2BF; ">&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">&lt;&lt;</span><span class="text" style="color: #ABB2BF; ">byte</span><span class="text" style="color: #ABB2BF; ">&gt;&gt;</span>
      <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">else</span>
      <span class="string" style="color: #98C379; ">&quot;&quot;</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">binary_slice</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="operator" style="color: #C678DD; ">..</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="operator" style="color: #C678DD; ">//</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">range</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span>
          <span class="string" style="color: #98C379; ">&quot;binary_slice/2 does not accept ranges with negative steps, got: <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">range</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">## Definitions implemented in Elixir</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">~S<span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Defines a module given by name with the given contents.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This macro defines a module with the given `alias` as its name and with the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  given contents. It returns a tuple with four elements:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `:module`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * the module name</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * the binary contents of the module</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * the result of evaluating the contents block</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule Number do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        def one, do: 1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        def two, do: 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; {:module, Number, &lt;&lt;70, 79, 82, ...&gt;&gt;, {:two, 0}}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      Number.one()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; 1</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      Number.two()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Module names and aliases</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Module names (and aliases) must start with an ASCII uppercase character which</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  may be followed by any ASCII letter, number, or underscore. Elixir&#39;s</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  [Naming Conventions](naming-conventions.md) suggest for module names and aliases</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  to be written in the `CamelCase` format.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  You can also use atoms as the module name, although they must only contain ASCII</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  characters.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Nesting</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Nesting a module inside another module affects the name of the nested module:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule Foo do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defmodule Bar do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In the example above, two modules - `Foo` and `Foo.Bar` - are created.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  When nesting, Elixir automatically creates an alias to the inner module,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  allowing the second module `Foo.Bar` to be accessed as `Bar` in the same</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  lexical scope where it&#39;s defined (the `Foo` module). This only happens</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  if the nested module is defined via an alias.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the `Foo.Bar` module is moved somewhere else, the references to `Bar` in</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the `Foo` module need to be updated to the fully-qualified name (`Foo.Bar`) or</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  an alias has to be explicitly set in the `Foo` module with the help of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `alias/2`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule Foo.Bar do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        # code</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule Foo do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        alias Foo.Bar</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        # code here can refer to &quot;Foo.Bar&quot; as just &quot;Bar&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Dynamic names</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Elixir module names can be dynamically generated. This is very</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  useful when working with macros. For instance, one could write:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule Module.concat([&quot;Foo&quot;, &quot;Bar&quot;]) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        # contents ...</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Elixir will accept any module name as long as the expression passed as the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  first argument to `defmodule/2` evaluates to an atom.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note that, when a dynamic name is used, Elixir won&#39;t nest the name under</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the current module nor automatically set up an alias.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Reserved module names</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If you attempt to define a module that already exists, you will get a</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  warning saying that a module has been redefined.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  There are some modules that Elixir does not currently implement but it</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  may be implement in the future. Those modules are reserved and defining</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  them will result in a compilation error:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule Any do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        # code</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (CompileError) iex:1: module Any is reserved and cannot be defined</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Elixir reserves the following module names: `Elixir`, `Any`, `BitString`,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `PID`, and `Reference`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">defmodule</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">alias</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">do_block</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">defmodule</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">alias</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">block</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">env</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span>
    <span class="function" style="color: #61AFEF; ">assert_no_match_or_guard_scope</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;defmodule/2&quot;</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="text" style="color: #ABB2BF; ">expanded</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">expand_module_alias</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">alias</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">expanded</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">with_alias</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">case</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">expanded</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
          <span class="comment" style="font-style: italic; color: #5C6370; "># Expand the module considering the current environment/nesting</span>
          <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">full</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">old</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">new</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">alias_defmodule</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">alias</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expanded</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="text" style="color: #ABB2BF; ">meta</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">defined: </span><span class="text" style="color: #ABB2BF; ">full</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">context: </span><span class="text" style="color: #ABB2BF; ">env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">module</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">++</span> <span class="function" style="color: #61AFEF; ">alias_meta</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">alias</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">full</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:alias</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">old</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">as: </span><span class="text" style="color: #ABB2BF; ">new</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">warn: </span><span class="constant" style="color: #56B6C2; ">false</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">}</span>

        <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
          <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">expanded</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">}</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="text" style="color: #ABB2BF; ">escaped</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">env</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">function: </span><span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">lexical_tracker: </span><span class="text" style="color: #ABB2BF; ">pid</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_pid</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">pid</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
          <span class="text" style="color: #ABB2BF; ">integer</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Kernel.LexicalTracker</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">write_cache</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">pid</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">block</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">Kernel.LexicalTracker</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">read_cache</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">pid</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">integer</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

        <span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
          <span class="module" style="color: #61AFEF; ">:elixir_quote</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">escape</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">block</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:none</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">false</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="text" style="color: #ABB2BF; ">versioned_vars</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">versioned_vars</span>
    <span class="text" style="color: #ABB2BF; ">prune</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_map_key</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:elixir</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:prune_binding</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">versioned_vars</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="text" style="color: #ABB2BF; ">var_meta</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">prune</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">generated: </span><span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">keep_unused: </span><span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">]</span>
        <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">generated: </span><span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">]</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="text" style="color: #ABB2BF; ">module_vars</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="function" style="color: #61AFEF; ">module_var</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="operator" style="color: #C678DD; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">var_meta</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="module" style="color: #61AFEF; ">:maps</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">keys</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">versioned_vars</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">with_alias</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="module" style="color: #61AFEF; ">:elixir_module</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">compile</span><span class="text" style="color: #ABB2BF; ">(</span>
        <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">expanded</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
        <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">escaped</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
        <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module_vars</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
        <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">prune</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
        <span class="constant builtin" style="color: #D19A66; ">__ENV__</span>
      <span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">alias_meta</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:__aliases__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">meta</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">alias_meta</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span>

  <span class="comment" style="font-style: italic; color: #5C6370; "># We don&#39;t want to trace :alias_reference since we are defining the alias</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">expand_module_alias</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:__aliases__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">original</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="module" style="color: #61AFEF; ">:elixir_aliases</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand_or_concat</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">original</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">receiver</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">receiver</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">receiver</span>

      <span class="text" style="color: #ABB2BF; ">aliases</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">aliases</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="operator" style="color: #C678DD; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">aliases</span><span class="text" style="color: #ABB2BF; ">)</span>

        <span class="keyword" style="color: #E06C75; ">case</span> <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">all</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="text" style="color: #ABB2BF; ">is_atom</span><span class="operator" style="color: #C678DD; ">/</span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">aliases</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="module" style="color: #61AFEF; ">:elixir_aliases</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">concat</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">aliases</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">original</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">expand_module_alias</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="comment" style="font-style: italic; color: #5C6370; "># defmodule Elixir.Alias</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">alias_defmodule</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:__aliases__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">:&quot;Elixir&quot;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_env</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
    <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">}</span>

  <span class="comment" style="font-style: italic; color: #5C6370; "># defmodule Alias in root</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">alias_defmodule</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:__aliases__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">module: </span><span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span>
    <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">}</span>

  <span class="comment" style="font-style: italic; color: #5C6370; "># defmodule Alias nested</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">alias_defmodule</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:__aliases__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">h</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">module</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">:elixir_aliases</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">concat</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="text" style="color: #ABB2BF; ">alias</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">String</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">&quot;Elixir.&quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span> <span class="module" style="color: #61AFEF; ">Atom</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">h</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">t</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">alias</span><span class="text" style="color: #ABB2BF; ">}</span>
      <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="module" style="color: #61AFEF; ">String</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Enum</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">join</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">module</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">t</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;.&quot;</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">alias</span><span class="text" style="color: #ABB2BF; ">}</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; "># defmodule _</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">alias_defmodule</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_raw</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_env</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">module_var</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">module_var</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">counter: </span><span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">++</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">}</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">~S<span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Defines a public function with the given name and body.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule Foo do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        def bar, do: :baz</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      Foo.bar()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; :baz</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  A function that expects arguments can be defined as follows:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule Foo do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        def sum(a, b) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          a + b</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In the example above, a `sum/2` function is defined; this function receives</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  two arguments and returns their sum.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Default arguments</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `\\` is used to specify a default value for a parameter of a function. For</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  example:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule MyMath do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        def multiply_by(number, factor \\ 2) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          number * factor</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      MyMath.multiply_by(4, 3)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; 12</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      MyMath.multiply_by(4)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; 8</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The compiler translates this into multiple functions with different arities,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  here `MyMath.multiply_by/1` and `MyMath.multiply_by/2`, that represent cases when</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  arguments for parameters with default values are passed or not passed.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  When defining a function with default arguments as well as multiple</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  explicitly declared clauses, you must write a function head that declares the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  defaults. For example:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule MyString do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        def join(string1, string2 \\ nil, separator \\ &quot; &quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        def join(string1, nil, _separator) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          string1</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        def join(string1, string2, separator) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          string1 &lt;&gt; separator &lt;&gt; string2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note that `\\` can&#39;t be used with anonymous functions because they</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  can only have a sole arity.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ### Keyword lists with default arguments</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Functions containing many arguments can benefit from using `Keyword`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  lists to group and pass attributes as a single value.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule MyConfiguration do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        @default_opts [storage: &quot;local&quot;]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        def configure(resource, opts \\ []) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          opts = Keyword.merge(@default_opts, opts)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          storage = opts[:storage]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          # ...</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The difference between using `Map` and `Keyword` to store many</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  arguments is `Keyword`&#39;s keys:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * must be atoms</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * can be given more than once</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * ordered, as specified by the developer</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Function names</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Function and variable names in Elixir must start with an underscore or a</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Unicode letter that is not in uppercase or titlecase. They may continue</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  using a sequence of Unicode letters, numbers, and underscores. They may</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  end in `?` or `!`. Elixir&#39;s [Naming Conventions](naming-conventions.md)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  suggest for function and variable names to be written in the `snake_case`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  format.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## `rescue`/`catch`/`after`/`else`</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Function bodies support `rescue`, `catch`, `after`, and `else` as `try/1`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  does (known as &quot;implicit try&quot;). For example, the following two functions are equivalent:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      def convert(number) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        try do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          String.to_integer(number)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        rescue</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          e in ArgumentError -&gt; {:error, e.message}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      def convert(number) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        String.to_integer(number)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      rescue</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        e in ArgumentError -&gt; {:error, e.message}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">def</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expr</span> <span class="operator" style="color: #C678DD; ">\\</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">assert_no_match_or_guard_scope</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;def/2&quot;</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="function" style="color: #61AFEF; ">define</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:def</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Defines a private function with the given name and body.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Private functions are only accessible from within the module in which they are</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  defined. Trying to access a private function from outside the module it&#39;s</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  defined in results in an `UndefinedFunctionError` exception.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Check `def/2` for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule Foo do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        def bar do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          sum(1, 2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defp sum(a, b), do: a + b</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      Foo.bar()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; 3</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      Foo.sum(1, 2)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (UndefinedFunctionError) undefined function Foo.sum/2</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">defp</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expr</span> <span class="operator" style="color: #C678DD; ">\\</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">assert_no_match_or_guard_scope</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;defp/2&quot;</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="function" style="color: #61AFEF; ">define</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:defp</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Defines a public macro with the given name and body.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Macros must be defined before its usage.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Check `def/2` for rules on naming and default arguments.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule MyLogic do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defmacro unless(expr, opts) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          quote do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">            if !unquote(expr), unquote(opts)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      require MyLogic</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      MyLogic.unless false do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        IO.puts(&quot;It works&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">defmacro</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expr</span> <span class="operator" style="color: #C678DD; ">\\</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">assert_no_match_or_guard_scope</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;defmacro/2&quot;</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="function" style="color: #61AFEF; ">define</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:defmacro</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Defines a private macro with the given name and body.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Private macros are only accessible from the same module in which they are</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  defined.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Private macros must be defined before its usage.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Check `defmacro/2` for more information, and check `def/2` for rules on</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  naming and default arguments.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">defmacrop</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expr</span> <span class="operator" style="color: #C678DD; ">\\</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">assert_no_match_or_guard_scope</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;defmacrop/2&quot;</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="function" style="color: #61AFEF; ">define</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:defmacrop</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">define</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">module</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">assert_module_scope</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">2</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="function" style="color: #61AFEF; ">assert_no_function_scope</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">2</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="text" style="color: #ABB2BF; ">unquoted_call</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">:elixir_quote</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">has_unquotes</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="text" style="color: #ABB2BF; ">unquoted_expr</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">:elixir_quote</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">has_unquotes</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="text" style="color: #ABB2BF; ">store</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">unquoted_expr</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="text" style="color: #ABB2BF; ">unquoted_call</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
          <span class="module" style="color: #61AFEF; ">:elixir_quote</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">escape</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:none</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">)</span>

        <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
          <span class="text" style="color: #ABB2BF; ">key</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">unique_integer</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="module" style="color: #61AFEF; ">:elixir_module</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">write_cache</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">key</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="text" style="color: #ABB2BF; ">key</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="text" style="color: #ABB2BF; ">pos</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">:elixir_locals</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">cache_env</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="module" style="color: #61AFEF; ">:elixir_def</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">store_definition</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">store</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">pos</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Defines a struct.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  A struct is a tagged map that allows developers to provide</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  default values for keys, tags to be used in polymorphic</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  dispatches and compile time assertions. For more information</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  about structs, please check `%/2`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It is only possible to define a struct per module, as the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  struct is tied to the module itself. Calling `defstruct/1`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  also defines a `__struct__/0` function that returns the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  struct itself.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule User do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defstruct name: nil, age: nil</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Struct fields are evaluated at compile-time, which allows</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  them to be dynamic. In the example below, `10 + 11` is</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  evaluated at compile-time and the age field is stored</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  with value `21`:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule User do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defstruct name: nil, age: 10 + 11</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The `fields` argument is usually a keyword list with field names</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  as atom keys and default values as corresponding values. `defstruct/1`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  also supports a list of atoms as its argument: in that case, the atoms</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  in the list will be used as the struct&#39;s field names and they will all</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  default to `nil`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule Post do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defstruct [:title, :content, :author]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Add documentation to a struct with the `@doc` attribute, like a function.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule Post do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        @doc &quot;A post. The content should be valid Markdown.&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defstruct [:title, :content, :author]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Deriving</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Although structs are maps, by default structs do not implement</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  any of the protocols implemented for maps. For example, attempting</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  to use a protocol with the `User` struct leads to an error:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      john = %User{name: &quot;John&quot;}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      MyProtocol.call(john)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (Protocol.UndefinedError) protocol MyProtocol not implemented for %User{...}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `defstruct/1`, however, allows protocol implementations to be</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  *derived*. This can be done by defining a `@derive` attribute as a</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  list before invoking `defstruct/1`:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule User do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        @derive MyProtocol</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defstruct name: nil, age: nil</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      MyProtocol.call(john) # it works!</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  A common example is to `@derive` the `Inspect` protocol to hide certain fields</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  when the struct is printed:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule User do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        @derive {Inspect, only: :name}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defstruct name: nil, age: nil</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  For each protocol in `@derive`, Elixir will assert the protocol has</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  been implemented for `Any`. If the `Any` implementation defines a</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `__deriving__/3` callback, the callback will be invoked and it should define</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the implementation module. Otherwise an implementation that simply points to</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the `Any` implementation is automatically derived. For more information on</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the `__deriving__/3` callback, see `Protocol.derive/3`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Enforcing keys</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  When building a struct, Elixir will automatically guarantee all keys</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  belong to the struct:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      %User{name: &quot;john&quot;, unknown: :key}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (KeyError) key :unknown not found in: %User{age: 21, name: nil}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Elixir also allows developers to enforce that certain keys must always be</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  given when building the struct:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule User do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        @enforce_keys [:name]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defstruct name: nil, age: 10 + 11</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Now trying to build a struct without the name key will fail:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      %User{age: 21}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ** (ArgumentError) the following keys must also be given when building struct User: [:name]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Keep in mind `@enforce_keys` is a simple compile-time guarantee</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  to aid developers when building structs. It is not enforced on</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  updates and it does not provide any sort of value-validation.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Types</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It is recommended to define types for structs. By convention, such a type</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  is called `t`. To define a struct inside a type, the struct literal syntax</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  is used:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule User do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defstruct name: &quot;John&quot;, age: 25</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        @type t :: %__MODULE__{name: String.t(), age: non_neg_integer}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It is recommended to only use the struct syntax when defining the struct&#39;s</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  type. When referring to another struct, it&#39;s better to use `User.t()` instead of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `%User{}`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The types of the struct fields that are not included in `%User{}` default to</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `term()` (see `t:term/0`).</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Structs whose internal structure is private to the local module (pattern</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  matching them or directly accessing their fields should not be allowed) should</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  use the `@opaque` attribute. Structs whose internal structure is public should</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  use `@type`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">defstruct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="string" style="color: #98C379; ">bind_quoted: </span><span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">fields: </span><span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">bootstrapped?: </span><span class="function" style="color: #61AFEF; ">bootstrapped?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Enum</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">derive</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">kv</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">body</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span>
        <span class="module" style="color: #61AFEF; ">Kernel.Utils</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">defstruct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__MODULE__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">bootstrapped?</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__ENV__</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">derive</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="string" style="color: #98C379; ">:ok</span>
        <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="module" style="color: #61AFEF; ">Protocol</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">__derive__</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">derive</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__MODULE__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__ENV__</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">__struct__</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">__struct__</span>
      <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">__struct__</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">kv</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">body</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="module" style="color: #61AFEF; ">Kernel.Utils</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">announce_struct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__MODULE__</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="text" style="color: #ABB2BF; ">struct</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">~S<span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Defines an exception.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Exceptions are structs backed by a module that implements</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the `Exception` behaviour. The `Exception` behaviour requires</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  two functions to be implemented:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * [`exception/1`](`c:Exception.exception/1`) - receives the arguments given to `raise/2`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      and returns the exception struct. The default implementation</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      accepts either a set of keyword arguments that is merged into</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      the struct or a string to be used as the exception&#39;s message.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * [`message/1`](`c:Exception.message/1`) - receives the exception struct and must return its</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      message. Most commonly exceptions have a message field which</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      by default is accessed by this function. However, if an exception</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      does not have a message field, this function must be explicitly</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      implemented.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Since exceptions are structs, the API supported by `defstruct/1`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  is also available in `defexception/1`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Raising exceptions</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The most common way to raise an exception is via `raise/2`:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule MyAppError do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defexception [:message]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      value = [:hello]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      raise MyAppError,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        message: &quot;did not get what was expected, got: #{inspect(value)}&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In many cases it is more convenient to pass the expected value to</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `raise/2` and generate the message in the `c:Exception.exception/1` callback:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule MyAppError do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defexception [:message]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        @impl true</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        def exception(value) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          msg = &quot;did not get what was expected, got: #{inspect(value)}&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          %MyAppError{message: msg}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      raise MyAppError, value</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The example above shows the preferred strategy for customizing</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  exception messages.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">defexception</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="string" style="color: #98C379; ">bind_quoted: </span><span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">fields: </span><span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="module" style="color: #61AFEF; ">Elixir.Kernel</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">@</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">behaviour</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Exception</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="text" style="color: #ABB2BF; ">struct</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="keyword" style="color: #E06C75; ">defstruct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">__exception__: </span><span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">++</span> <span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="keyword" style="color: #E06C75; ">if</span> <span class="module" style="color: #61AFEF; ">Map</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">has_key?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:message</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="module" style="color: #61AFEF; ">Elixir.Kernel</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">@</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">impl</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

        <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">message</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">exception</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="text" style="color: #ABB2BF; ">exception</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">message</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

        <span class="keyword" style="color: #E06C75; ">defoverridable</span> <span class="string" style="color: #98C379; ">message: </span><span class="text" style="color: #ABB2BF; ">1</span>

        <span class="module" style="color: #61AFEF; ">Elixir.Kernel</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">@</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">impl</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

        <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">exception</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">msg</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="module" style="color: #61AFEF; ">Kernel</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">msg</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="function" style="color: #61AFEF; ">exception</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">message: </span><span class="text" style="color: #ABB2BF; ">msg</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="comment" style="font-style: italic; color: #5C6370; "># Calls to Kernel functions must be fully-qualified to ensure</span>
      <span class="comment" style="font-style: italic; color: #5C6370; "># reproducible builds; otherwise, this macro will generate ASTs</span>
      <span class="comment" style="font-style: italic; color: #5C6370; "># with different metadata (:import, :context) depending on if</span>
      <span class="comment" style="font-style: italic; color: #5C6370; "># it is the bootstrapped version or not.</span>
      <span class="module" style="color: #61AFEF; ">Elixir.Kernel</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">@</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">impl</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="comment" style="font-style: italic; color: #5C6370; "># TODO: Change the implementation on v2.0 to simply call Kernel.struct!/2</span>
      <span class="keyword" style="color: #E06C75; ">def</span> <span class="function" style="color: #61AFEF; ">exception</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="module" style="color: #61AFEF; ">Kernel</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">is_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="text" style="color: #ABB2BF; ">struct</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">__struct__</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">valid</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">invalid</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Enum</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">split_with</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">fn</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">k</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="module" style="color: #61AFEF; ">Map</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">has_key?</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">k</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">end</span><span class="text" style="color: #ABB2BF; ">)</span>

        <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">invalid</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
            <span class="string" style="color: #98C379; ">:ok</span>

          <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
            <span class="module" style="color: #61AFEF; ">IO</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">warn</span><span class="text" style="color: #ABB2BF; ">(</span>
              <span class="string" style="color: #98C379; ">&quot;the following fields are unknown when raising &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
                <span class="string" style="color: #98C379; ">&quot;<span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="module" style="color: #61AFEF; ">Kernel</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__MODULE__</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>: <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="module" style="color: #61AFEF; ">Kernel</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">invalid</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>. &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
                <span class="string" style="color: #98C379; ">&quot;Please make sure to only give known fields when raising &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
                <span class="string" style="color: #98C379; ">&quot;or redefine <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="module" style="color: #61AFEF; ">Kernel</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__MODULE__</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>.exception/1 to &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
                <span class="string" style="color: #98C379; ">&quot;discard unknown fields. Future Elixir versions will raise on &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
                <span class="string" style="color: #98C379; ">&quot;unknown fields given to raise/2&quot;</span>
            <span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

        <span class="module" style="color: #61AFEF; ">Kernel</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">struct!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">struct</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">valid</span><span class="text" style="color: #ABB2BF; ">)</span>
      <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="keyword" style="color: #E06C75; ">defoverridable</span> <span class="string" style="color: #98C379; ">exception: </span><span class="text" style="color: #ABB2BF; ">1</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Defines a protocol.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  See the `Protocol` module for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">defprotocol</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">do_block</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">defprotocol</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">block</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">Protocol</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">__protocol__</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">block</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Defines an implementation for the given protocol.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  See the `Protocol` module for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">defimpl</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">opts</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">do_block</span> <span class="operator" style="color: #C678DD; ">\\</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">Protocol</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">__impl__</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">opts</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">do_block</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Makes the given definitions in the current module overridable.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If the user defines a new function or macro with the same name</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and arity, then the overridable ones are discarded. Otherwise, the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  original definitions are used.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It is possible for the overridden definition to have a different visibility</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  than the original: a public function can be overridden by a private</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  function and vice-versa.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Macros cannot be overridden as functions and vice-versa.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Example</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule DefaultMod do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defmacro __using__(_opts) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          quote do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">            def test(x, y) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">              x + y</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">            end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">            defoverridable test: 2</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule ChildMod do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        use DefaultMod</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        def test(x, y) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          x * y + super(x, y)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  As seen as in the example above, `super` can be used to call the default</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  implementation.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; #### Disclaimer {: .tip}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; Use `defoverridable` with care. If you need to define multiple modules</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; with the same behaviour, it may be best to move the default implementation</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; to the caller, and check if a callback exists via `Code.ensure_loaded?/1` and</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; `function_exported?/3`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; For example, in the example above, imagine there is a module that calls the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; `test/2` function. This module could be defined as such:</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt;     defmodule CallsTest do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt;       def receives_module_and_calls_test(module, x, y) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt;         if Code.ensure_loaded?(module) and function_exported?(module, :test, 2) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt;           module.test(x, y)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt;         else</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt;           x + y</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt;         end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt;       end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt;     end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Example with behaviour</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  You can also pass a behaviour to `defoverridable` and it will mark all of the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  callbacks in the behaviour as overridable:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule Behaviour do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        @callback test(number(), number()) :: number()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule DefaultMod do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defmacro __using__(_opts) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          quote do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">            @behaviour Behaviour</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">            def test(x, y) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">              x + y</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">            end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">            defoverridable Behaviour</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule ChildMod do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        use DefaultMod</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        def test(x, y) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          x * y + super(x, y)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">defoverridable</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">keywords_or_behaviour</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="module" style="color: #61AFEF; ">Module</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">make_overridable</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__MODULE__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">keywords_or_behaviour</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Generates a macro suitable for use in guard expressions.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It raises at compile time if the definition uses expressions that aren&#39;t</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  allowed in guards, and otherwise creates a macro that can be used both inside</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  or outside guards.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note the convention in Elixir is to prefix all guards that return a boolean</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  with the `is_` prefix, such as `is_list/1`. If, however, the function/macro</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  returns a boolean and is not allowed in guards, it should have no prefix and</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  end with a question mark, such as `Keyword.keyword?/1`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Example</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule Integer.Guards do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defguard is_even(value) when is_integer(value) and rem(value, 2) == 0</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule Collatz do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        @moduledoc &quot;Tools for working with the Collatz sequence.&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        import Integer.Guards</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        @doc &quot;Determines the number of steps `n` takes to reach `1`.&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        # If this function never converges, please let me know what `n` you used.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        def converge(n) when n &gt; 0, do: step(n, 0)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defp step(1, step_count) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          step_count</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defp step(n, step_count) when is_even(n) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          step(div(n, 2), step_count + 1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defp step(n, step_count) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          step(3 * n + 1, step_count + 1)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.6.0&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="keyword" style="color: #E06C75; ">defguard</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">t</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">t</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">defguard</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">guard</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">define_guard</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:defmacro</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">guard</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Generates a private macro suitable for use in guard expressions.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It raises at compile time if the definition uses expressions that aren&#39;t</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  allowed in guards, and otherwise creates a private macro that can be used</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  both inside or outside guards in the current module.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Similar to `defmacrop/2`, `defguardp/1` must be defined before its use</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  in the current module.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.6.0&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">spec</span> <span class="keyword" style="color: #E06C75; ">defguardp</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">t</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">::</span> <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">t</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">defguardp</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">guard</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">define_guard</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">:defmacrop</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">guard</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">define_guard</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">guard</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="module" style="color: #61AFEF; ">:elixir_utils</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">extract_guards</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">guard</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span>
              <span class="string" style="color: #98C379; ">&quot;invalid syntax in defguard <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>, &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
                <span class="string" style="color: #98C379; ">&quot;only a single when clause is allowed&quot;</span>

      <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">impls</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">case</span> <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">decompose_call</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="text" style="color: #ABB2BF; ">{</span><span class="comment" style="font-style: italic; color: #5C6370; ">_name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
            <span class="function" style="color: #61AFEF; ">validate_variable_only_args!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span>

            <span class="text" style="color: #ABB2BF; ">macro_definition</span> <span class="operator" style="color: #C678DD; ">=</span>
              <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">impls</span> <span class="keyword" style="color: #E06C75; ">do</span>
                <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
                  <span class="function" style="color: #61AFEF; ">define</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant" style="color: #56B6C2; ">nil</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span>

                <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">guard</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
                  <span class="text" style="color: #ABB2BF; ">quoted</span> <span class="operator" style="color: #C678DD; ">=</span>
                    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
                      <span class="keyword" style="color: #E06C75; ">require</span> <span class="module" style="color: #61AFEF; ">Kernel.Utils</span>
                      <span class="module" style="color: #61AFEF; ">Kernel.Utils</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">defguard</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">guard</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
                    <span class="keyword" style="color: #E06C75; ">end</span>

                  <span class="function" style="color: #61AFEF; ">define</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">kind</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">quoted</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span>
              <span class="keyword" style="color: #E06C75; ">end</span>

            <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
              <span class="module" style="color: #61AFEF; ">Elixir.Kernel</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">@</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">doc</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">guard: </span><span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
              <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">macro_definition</span><span class="text" style="color: #ABB2BF; ">)</span>
            <span class="keyword" style="color: #E06C75; ">end</span>

          <span class="comment" style="font-style: italic; color: #5C6370; ">_invalid_definition</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
            <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;invalid syntax in defguard <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">validate_variable_only_args!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">Enum</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">each</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">fn</span>
      <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">ref</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">context</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">ref</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">context</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="string" style="color: #98C379; ">:ok</span>

      <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:\\</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_m1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">ref</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_m2</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">context</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_default</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">ref</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">context</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="string" style="color: #98C379; ">:ok</span>

      <span class="comment" style="font-style: italic; color: #5C6370; ">_match</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;invalid syntax in defguard <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">call</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span>
    <span class="keyword" style="color: #E06C75; ">end</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Uses the given module in the current context.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  When calling:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      use MyModule, some: :options</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Elixir will invoke `MyModule.__using__/1` passing the second argument of</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `use` as its argument. Since `__using__/1` is typically a macro, all</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the usual macro rules apply, and its return value should be quoted code</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  that is then inserted where `use/2` is called.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; #### Code injection {: .warning}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; `use MyModule` works as a **code-injection point** in the caller.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; Given the caller of `use MyModule` has little control over how the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; code is injected, `use/2` should be used with care. If you can,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; avoid use in favor of `import/2` or `alias/2` whenever possible.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  For example, to write test cases using the `ExUnit` framework provided</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  with Elixir, a developer should `use` the `ExUnit.Case` module:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule AssertionTest do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        use ExUnit.Case, async: true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        test &quot;always pass&quot; do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          assert true</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In this example, Elixir will call the `__using__/1` macro in the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `ExUnit.Case` module with the keyword list `[async: true]` as its</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  argument.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In other words, `use/2` translates to:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule AssertionTest do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        require ExUnit.Case</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        ExUnit.Case.__using__(async: true)</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        test &quot;always pass&quot; do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          assert true</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  where `ExUnit.Case` defines the `__using__/1` macro:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule ExUnit.Case do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defmacro __using__(opts) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          # do something with opts</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          quote do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">            # return some code to inject in the caller</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Best practices</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `__using__/1` is typically used when there is a need to set some state</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  (via module attributes) or callbacks (like `@before_compile`, see the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  documentation for `Module` for more information) into the caller.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `__using__/1` may also be used to alias, require, or import functionality</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  from different modules:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule MyModule do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defmacro __using__(_opts) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          quote do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">            import MyModule.Foo</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">            import MyModule.Bar</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">            import MyModule.Baz</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">            alias MyModule.Repo</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  However, do not provide `__using__/1` if all it does is to import,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  alias or require the module itself. For example, avoid this:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule MyModule do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defmacro __using__(_opts) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          quote do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">            import MyModule</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In such cases, developers should instead import or alias the module</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  directly, so that they can customize those as they wish,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  without the indirection behind `use/2`. Developers must also avoid</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  defining functions inside `__using__/1`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Given `use MyModule` can generate any code, it may not be easy for</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  developers to understand the impact of `use MyModule`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  For this reason, to provide guidance and clarity, we recommend developers</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  to include an admonition block in their `@moduledoc` that explains how</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `use MyModule` impacts their code. As an example, the `GenServer` documentation</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  outlines:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; #### `use GenServer` {: .info}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; When you `use GenServer`, the `GenServer` module will</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; set `@behaviour GenServer` and define a `child_spec/1`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; function, so your module can be used as a child</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; in a supervision tree.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  This provides a quick summary of how using a module impacts the user code.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Keep in mind to only list changes made to the public API of the module.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  For example, if `use MyModule` sets an internal attribute called</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `@_my_module_info` and this attribute is never meant to be public,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  it must not be listed.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  For convenience, the markup notation to generate the admonition block</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  above is:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ```</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; #### `use GenServer` {: .info}</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; When you `use GenServer`, the GenServer module will</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; set `@behaviour GenServer` and define a `child_spec/1`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; function, so your module can be used as a child</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &gt; in a supervision tree.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ```</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">use</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">opts</span> <span class="operator" style="color: #C678DD; ">\\</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">calls</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="module" style="color: #61AFEF; ">Enum</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">expand_aliases</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">fn</span>
        <span class="text" style="color: #ABB2BF; ">expanded</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">expanded</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
          <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
            <span class="keyword" style="color: #E06C75; ">require</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">expanded</span><span class="text" style="color: #ABB2BF; ">)</span>
            <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">expanded</span><span class="text" style="color: #ABB2BF; ">)</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">__using__</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">opts</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="keyword" style="color: #E06C75; ">end</span>

        <span class="comment" style="font-style: italic; color: #5C6370; ">_otherwise</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
          <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span>
                <span class="string" style="color: #98C379; ">&quot;invalid arguments for use, &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
                  <span class="string" style="color: #98C379; ">&quot;expected a compile time atom or alias, got: <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span>
      <span class="keyword" style="color: #E06C75; ">end</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote_splicing</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">calls</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">expand_aliases</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:.</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">base</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:{}</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">refs</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">base</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">base</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="module" style="color: #61AFEF; ">Enum</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">refs</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">fn</span>
      <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:__aliases__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">ref</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="module" style="color: #61AFEF; ">Module</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">concat</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">base</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">ref</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="text" style="color: #ABB2BF; ">ref</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">ref</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="module" style="color: #61AFEF; ">Module</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">concat</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">base</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">ref</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="text" style="color: #ABB2BF; ">other</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">other</span>
    <span class="keyword" style="color: #E06C75; ">end</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">expand_aliases</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">[</span><span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">module</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">]</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Defines a function that delegates to another module.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Functions defined with `defdelegate/2` are public and can be invoked from</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  outside the module they&#39;re defined in, as if they were defined using `def/2`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Therefore, `defdelegate/2` is about extending the current module&#39;s public API.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If what you want is to invoke a function defined in another module without</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  using its full module name, then use `alias/2` to shorten the module name or use</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `import/2` to be able to invoke the function without the module name altogether.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Delegation only works with functions; delegating macros is not supported.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Check `def/2` for rules on naming and default arguments.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Options</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `:to` - the module to dispatch to.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `:as` - the function to call on the target given in `:to`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      This parameter is optional and defaults to the name being</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      delegated (`funs`).</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule MyList do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defdelegate reverse(list), to: Enum</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        defdelegate other_reverse(list), to: Enum, as: :reverse</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      MyList.reverse([1, 2, 3])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; [3, 2, 1]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      MyList.other_reverse([1, 2, 3])</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; [3, 2, 1]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="keyword" style="color: #E06C75; ">defdelegate</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">funs</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="function" style="color: #61AFEF; ">opts</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">funs</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">escape</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">funs</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">unquote: </span><span class="constant" style="color: #56B6C2; ">true</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="text" style="color: #ABB2BF; ">opts</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">expand_literals</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">opts</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="string" style="color: #98C379; ">function: </span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:__info__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="string" style="color: #98C379; ">bind_quoted: </span><span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">funs: </span><span class="text" style="color: #ABB2BF; ">funs</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">opts: </span><span class="text" style="color: #ABB2BF; ">opts</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">target</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Kernel.Utils</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">defdelegate_all</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">funs</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">opts</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__ENV__</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="comment" style="font-style: italic; color: #5C6370; "># TODO: Remove List.wrap when multiple funs are no longer supported</span>
      <span class="keyword" style="color: #E06C75; ">for</span> <span class="text" style="color: #ABB2BF; ">fun</span> <span class="operator" style="color: #C678DD; ">&lt;-</span> <span class="module" style="color: #61AFEF; ">List</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">wrap</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">funs</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
        <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">as</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">as_args</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Kernel.Utils</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">defdelegate_each</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">opts</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="module" style="color: #61AFEF; ">Elixir.Kernel</span><span class="operator" style="color: #C678DD; ">.</span><span class="operator" style="color: #C678DD; ">@</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">doc</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">delegate_to: </span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">target</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">as</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="module" style="color: #61AFEF; ">:erlang</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">length</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">as_args</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

        <span class="comment" style="font-style: italic; color: #5C6370; "># Build the call AST by hand so it doesn&#39;t get a</span>
        <span class="comment" style="font-style: italic; color: #5C6370; "># context and it warns on things like missing @impl</span>
        <span class="keyword" style="color: #E06C75; ">def</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">name</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">line: </span><span class="constant builtin" style="color: #D19A66; ">__ENV__</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">line</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">target</span><span class="text" style="color: #ABB2BF; ">)</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">as</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote_splicing</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">as_args</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
      <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Debugs the given `code`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `dbg/2` can be used to debug the given `code` through a configurable debug function.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It returns the result of the given code.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Let&#39;s take this call to `dbg/2`:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      dbg(Atom.to_string(:debugging))</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; &quot;debugging&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It returns the string `&quot;debugging&quot;`, which is the result of the `Atom.to_string/1` call.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Additionally, the call above prints:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [my_file.ex:10: MyMod.my_fun/0]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      Atom.to_string(:debugging) #=&gt; &quot;debugging&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The default debugging function prints additional debugging info when dealing with</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  pipelines. It prints the values at every &quot;step&quot; of the pipeline.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;Elixir is cool!&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      |&gt; String.trim_trailing(&quot;!&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      |&gt; String.split()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      |&gt; List.first()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      |&gt; dbg()</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      #=&gt; &quot;Elixir&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The code above prints:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [my_file.ex:10: MyMod.my_fun/0]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;Elixir is cool!&quot; #=&gt; &quot;Elixir is cool!&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      |&gt; String.trim_trailing(&quot;!&quot;) #=&gt; &quot;Elixir is cool&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      |&gt; String.split() #=&gt; [&quot;Elixir&quot;, &quot;is&quot;, &quot;cool&quot;]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      |&gt; List.first() #=&gt; &quot;Elixir&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  With no arguments, `dbg()` debugs information about the current binding. See `binding/1`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## `dbg` inside IEx</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  You can enable IEx to replace `dbg` with its `IEx.pry/0` backend by calling:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      $ iex --dbg pry</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In such cases, `dbg` will start a `pry` session where you can interact with</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the imports, aliases, and variables of the current environment at the location</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  of the `dbg` call.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If you call `dbg` at the end of a pipeline (using `|&gt;`) within IEx, you are able</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  to go through each step of the pipeline one by one by entering &quot;next&quot; (or &quot;n&quot;).</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Note `dbg` only supports stepping for pipelines (in other words, it can only</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  step through the code it sees). For general stepping, you can set breakpoints</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  using `IEx.break!/4`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  For more information, [see IEx documentation](https://hexdocs.pm/iex/IEx.html#module-dbg-and-breakpoints).</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Configuring the debug function</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  One of the benefits of `dbg/2` is that its debugging logic is configurable,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  allowing tools to extend `dbg` with enhanced behaviour. This is done, for</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  example, by `IEx` which extends `dbg` with an interactive shell where you</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  can directly inspect and access values.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The debug function can be configured at compile time through the `:dbg_callback`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  key of the `:elixir` application. The debug function must be a</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `{module, function, args}` tuple. The `function` function in `module` will be</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  invoked with three arguments *prepended* to `args`:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    1. The AST of `code`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    2. The AST of `options`</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    3. The `Macro.Env` environment of where `dbg/2` is invoked</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The debug function is invoked at compile time and it must also return an AST.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The AST is expected to ultimately return the result of evaluating the debugged</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  expression.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Here&#39;s a simple example:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      defmodule MyMod do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        def debug_fun(code, options, caller, device) do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          quote do</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">            result = unquote(code)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">            IO.inspect(unquote(device), result, label: unquote(Macro.to_string(code)))</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">          end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">        end</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      end</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  To configure the debug function:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      # In config/config.exs</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      config :elixir, :dbg_callback, {MyMod, :debug_fun, [:stdio]}</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ### Default debug function</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  By default, the debug function we use is `Macro.dbg/3`. It just prints</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  information about the code to standard output and returns the value</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  returned by evaluating `code`. `options` are used to control how terms</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  are inspected. They are the same options accepted by `inspect/2`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  &quot;&quot;&quot;</span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.14.0&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">dbg</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">code</span> <span class="operator" style="color: #C678DD; ">\\</span> <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="function" style="color: #61AFEF; ">binding</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">options</span> <span class="operator" style="color: #C678DD; ">\\</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">mod</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Application</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">compile_env!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:elixir</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:dbg_callback</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">compile_apply</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">mod</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">code</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">options</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span> <span class="operator" style="color: #C678DD; ">|</span> <span class="text" style="color: #ABB2BF; ">args</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">## Sigils</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">~S<span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Handles the sigil `~S` for strings.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It returns a string without interpolations and without escape</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  characters, except for the escaping of the closing sigil character</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  itself.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~S(foo)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;foo&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~S(f#{o}o)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;f\#{o}o&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~S(\o/)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;\\o/&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  However, if you want to re-use the sigil character itself on</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  the string, you need to escape it:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~S((\))</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;()&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_S</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_S</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">binary</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">~S<span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Handles the sigil `~s` for strings.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It returns a string as if it was a double quoted string, unescaping characters</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and replacing interpolations.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~s(foo)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;foo&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~s(f#{:o}o)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;foo&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~s(f\#{:o}o)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      &quot;f\#{:o}o&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_s</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_s</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">piece</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">piece</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:elixir_interpolation</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">unescape_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">piece</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_s</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">line</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">pieces</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">line</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="function" style="color: #61AFEF; ">unescape_tokens</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">pieces</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">~S<span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Handles the sigil `~C` for charlists.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It returns a charlist without interpolations and without escape</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  characters, except for the escaping of the closing sigil character</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  itself.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  A charlist is a list of integers where all the integers are valid code points.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The three expressions below are equivalent:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~C&quot;foo\n&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [?f, ?o, ?o, ?\\, ?n]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [102, 111, 111, 92, 110]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In practice, charlists are mostly used in specific scenarios such as</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  interfacing with older Erlang libraries that do not accept binaries as arguments.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~C(foo)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~c&quot;foo&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~C(f#{o}o)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~c&quot;f\#{o}o&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~C(foo\n)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~c&quot;foo\\n&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_C</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_C</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">String</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_charlist</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">~S<span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Handles the sigil `~c` for charlists.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It returns a charlist, unescaping characters and replacing interpolations.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  A charlist is a list of integers where all the integers are valid code points.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The three expressions below are equivalent:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~c&quot;foo&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [?f, ?o, ?o]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [102, 111, 111]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  In practice, charlists are mostly used in specific scenarios such as</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  interfacing with older Erlang libraries that do not accept binaries as arguments.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~c(foo)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~c&quot;foo&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~c(f#{:o}o)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~c&quot;foo&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~c(f\#{:o}o)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~c&quot;f\#{:o}o&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The list is only printed as a `~c` sigil if all code points are within the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ASCII range:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~c&quot;heÅÅo&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [104, 101, 322, 322, 111]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; [104, 101, 108, 108, 111]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~c&quot;hello&quot;</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  See `Inspect.Opts` for more information.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_c</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="comment" style="font-style: italic; color: #5C6370; "># We can skip the runtime conversion if we are</span>
  <span class="comment" style="font-style: italic; color: #5C6370; "># creating a binary made solely of series of chars.</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_c</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">String</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_charlist</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">:elixir_interpolation</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">unescape_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_c</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">pieces</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">List</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_charlist</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">unescape_list_tokens</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">pieces</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">~S<span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Handles the sigil `~r` for regular expressions.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It returns a regular expression pattern, unescaping characters and replacing</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  interpolations.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  More information on regular expressions can be found in the `Regex` module.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Regex.match?(~r/foo/, &quot;foo&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Regex.match?(~r/a#{:b}c/, &quot;abc&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  While the `~r` sigil allows parens and brackets to be used as delimiters,</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  it is preferred to use `&quot;` or `/` to avoid escaping conflicts with reserved</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  regex characters.</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_r</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_r</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">options</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">binary</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">:elixir_interpolation</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">unescape_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="operator" style="color: #C678DD; ">&amp;</span><span class="module" style="color: #61AFEF; ">Regex</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">unescape_map</span><span class="operator" style="color: #C678DD; ">/</span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="text" style="color: #ABB2BF; ">regex</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Regex</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">compile!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="module" style="color: #61AFEF; ">:binary</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">list_to_bin</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">options</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">escape</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">regex</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_r</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">pieces</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">options</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">binary</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="function" style="color: #61AFEF; ">unescape_tokens</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">pieces</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="operator" style="color: #C678DD; ">&amp;</span><span class="module" style="color: #61AFEF; ">Regex</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">unescape_map</span><span class="operator" style="color: #C678DD; ">/</span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span>
    <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">Regex</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">compile!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">:binary</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">list_to_bin</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">options</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">~S<span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Handles the sigil `~R` for regular expressions.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It returns a regular expression pattern without interpolations and</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  without escape characters. Note it still supports escape of Regex</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  tokens (such as escaping `+` or `?`) and it also requires you to</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  escape the closing sigil character itself if it appears on the Regex.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  More information on regexes can be found in the `Regex` module.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; Regex.match?(~R(f#{1,3}o), &quot;f#o&quot;)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      true</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_R</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_R</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">options</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">regex</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Regex</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">compile!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="module" style="color: #61AFEF; ">:binary</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">list_to_bin</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">options</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="module" style="color: #61AFEF; ">Macro</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">escape</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">regex</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">~S<span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Handles the sigil `~D` for dates.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  By default, this sigil uses the built-in `Calendar.ISO`, which</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  requires dates to be written in the ISO8601 format:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~D[yyyy-mm-dd]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  such as:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~D[2015-01-13]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If you are using alternative calendars, any representation can</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  be used as long as you follow the representation by a single space</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and the calendar name:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~D[SOME-REPRESENTATION My.Alternative.Calendar]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The lower case `~d` variant does not exist as interpolation</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and escape characters are not useful for date sigils.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  More information on dates can be found in the `Date` module.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~D[2015-01-13]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~D[2015-01-13]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_D</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">date_string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_D</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:ok</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">year</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">month</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">day</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">calendar</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">parse_with_calendar!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:parse_date</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;Date&quot;</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="function" style="color: #61AFEF; ">to_calendar_struct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Date</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">calendar: </span><span class="text" style="color: #ABB2BF; ">calendar</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">year: </span><span class="text" style="color: #ABB2BF; ">year</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">month: </span><span class="text" style="color: #ABB2BF; ">month</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">day: </span><span class="text" style="color: #ABB2BF; ">day</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">~S<span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Handles the sigil `~T` for times.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  By default, this sigil uses the built-in `Calendar.ISO`, which</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  requires times to be written in the ISO8601 format:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~T[hh:mm:ss]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~T[hh:mm:ss.ssssss]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  such as:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~T[13:00:07]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~T[13:00:07.123]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If you are using alternative calendars, any representation can</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  be used as long as you follow the representation by a single space</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and the calendar name:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~T[SOME-REPRESENTATION My.Alternative.Calendar]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The lower case `~t` variant does not exist as interpolation</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and escape characters are not useful for time sigils.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  More information on times can be found in the `Time` module.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~T[13:00:07]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~T[13:00:07]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~T[13:00:07.001]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~T[13:00:07.001]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_T</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">time_string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_T</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:ok</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">hour</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">minute</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">second</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">microsecond</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">calendar</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="function" style="color: #61AFEF; ">parse_with_calendar!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:parse_time</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;Time&quot;</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="function" style="color: #61AFEF; ">to_calendar_struct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">Time</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">calendar: </span><span class="text" style="color: #ABB2BF; ">calendar</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">hour: </span><span class="text" style="color: #ABB2BF; ">hour</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">minute: </span><span class="text" style="color: #ABB2BF; ">minute</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">second: </span><span class="text" style="color: #ABB2BF; ">second</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">microsecond: </span><span class="text" style="color: #ABB2BF; ">microsecond</span>
    <span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">~S<span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Handles the sigil `~N` for naive date times.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  By default, this sigil uses the built-in `Calendar.ISO`, which</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  requires naive date times to be written in the ISO8601 format:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~N[yyyy-mm-dd hh:mm:ss]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~N[yyyy-mm-dd hh:mm:ss.ssssss]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~N[yyyy-mm-ddThh:mm:ss.ssssss]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  such as:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~N[2015-01-13 13:00:07]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~N[2015-01-13T13:00:07.123]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If you are using alternative calendars, any representation can</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  be used as long as you follow the representation by a single space</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and the calendar name:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~N[SOME-REPRESENTATION My.Alternative.Calendar]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The lower case `~n` variant does not exist as interpolation</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and escape characters are not useful for date time sigils.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  More information on naive date times can be found in the</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  `NaiveDateTime` module.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~N[2015-01-13 13:00:07]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~N[2015-01-13 13:00:07]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~N[2015-01-13T13:00:07.001]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~N[2015-01-13 13:00:07.001]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_N</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">naive_datetime_string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_N</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:ok</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">year</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">month</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">day</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">hour</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">minute</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">second</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">microsecond</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">calendar</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="function" style="color: #61AFEF; ">parse_with_calendar!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:parse_naive_datetime</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;NaiveDateTime&quot;</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="function" style="color: #61AFEF; ">to_calendar_struct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">NaiveDateTime</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">calendar: </span><span class="text" style="color: #ABB2BF; ">calendar</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">year: </span><span class="text" style="color: #ABB2BF; ">year</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">month: </span><span class="text" style="color: #ABB2BF; ">month</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">day: </span><span class="text" style="color: #ABB2BF; ">day</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">hour: </span><span class="text" style="color: #ABB2BF; ">hour</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">minute: </span><span class="text" style="color: #ABB2BF; ">minute</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">second: </span><span class="text" style="color: #ABB2BF; ">second</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">microsecond: </span><span class="text" style="color: #ABB2BF; ">microsecond</span>
    <span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">~S<span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Handles the sigil `~U` to create a UTC `DateTime`.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  By default, this sigil uses the built-in `Calendar.ISO`, which</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  requires UTC date times to be written in the ISO8601 format:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~U[yyyy-mm-dd hh:mm:ssZ]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~U[yyyy-mm-dd hh:mm:ss.ssssssZ]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~U[yyyy-mm-ddThh:mm:ss.ssssss+00:00]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  such as:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~U[2015-01-13 13:00:07Z]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~U[2015-01-13T13:00:07.123+00:00]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  If you are using alternative calendars, any representation can</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  be used as long as you follow the representation by a single space</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and the calendar name:</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~U[SOME-REPRESENTATION My.Alternative.Calendar]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The given `datetime_string` must include &quot;Z&quot; or &quot;00:00&quot; offset</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  which marks it as UTC, otherwise an error is raised.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  The lower case `~u` variant does not exist as interpolation</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and escape characters are not useful for date time sigils.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  More information on date times can be found in the `DateTime` module.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~U[2015-01-13 13:00:07Z]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~U[2015-01-13 13:00:07Z]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~U[2015-01-13T13:00:07.001+00:00]</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      ~U[2015-01-13 13:00:07.001Z]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
  <span class="attribute" style="color: #E5C07B; ">@</span><span class="attribute" style="color: #E5C07B; ">doc</span> <span class="string" style="color: #98C379; ">since: </span><span class="string" style="color: #98C379; ">&quot;1.9.0&quot;</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_U</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">datetime_string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_U</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:ok</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">year</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">month</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">day</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">hour</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">minute</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">second</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">microsecond</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">offset</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">calendar</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span>
      <span class="function" style="color: #61AFEF; ">parse_with_calendar!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">:parse_utc_datetime</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;UTC DateTime&quot;</span><span class="text" style="color: #ABB2BF; ">)</span>

    <span class="keyword" style="color: #E06C75; ">if</span> <span class="text" style="color: #ABB2BF; ">offset</span> <span class="operator" style="color: #C678DD; ">!=</span> <span class="text" style="color: #ABB2BF; ">0</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span>
            <span class="string" style="color: #98C379; ">&quot;cannot parse <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span> as UTC DateTime for <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">calendar</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>, reason: :non_utc_offset&quot;</span>
    <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="function" style="color: #61AFEF; ">to_calendar_struct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">DateTime</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">calendar: </span><span class="text" style="color: #ABB2BF; ">calendar</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">year: </span><span class="text" style="color: #ABB2BF; ">year</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">month: </span><span class="text" style="color: #ABB2BF; ">month</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">day: </span><span class="text" style="color: #ABB2BF; ">day</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">hour: </span><span class="text" style="color: #ABB2BF; ">hour</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">minute: </span><span class="text" style="color: #ABB2BF; ">minute</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">second: </span><span class="text" style="color: #ABB2BF; ">second</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">microsecond: </span><span class="text" style="color: #ABB2BF; ">microsecond</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">time_zone: </span><span class="string" style="color: #98C379; ">&quot;Etc/UTC&quot;</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">zone_abbr: </span><span class="string" style="color: #98C379; ">&quot;UTC&quot;</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">utc_offset: </span><span class="text" style="color: #ABB2BF; ">0</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="string" style="color: #98C379; ">std_offset: </span><span class="text" style="color: #ABB2BF; ">0</span>
    <span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">parse_with_calendar!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">context</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="text" style="color: #ABB2BF; ">calendar</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">extract_calendar</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="text" style="color: #ABB2BF; ">result</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">apply</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">calendar</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="function" style="color: #61AFEF; ">maybe_raise!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">result</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">calendar</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">calendar</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">extract_calendar</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="module" style="color: #61AFEF; ">:binary</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">split</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot; &quot;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">:global</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">[</span><span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="module" style="color: #61AFEF; ">Calendar.ISO</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">}</span>
      <span class="text" style="color: #ABB2BF; ">parts</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="function" style="color: #61AFEF; ">maybe_atomize_calendar</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">List</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">last</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">parts</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">maybe_atomize_calendar</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">&lt;&lt;</span><span class="text" style="color: #ABB2BF; ">alias</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="operator" style="color: #C678DD; ">::</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">&gt;&gt;</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">last_part</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span>
       <span class="keyword" style="color: #E06C75; ">when</span> <span class="text" style="color: #ABB2BF; ">alias</span> <span class="operator" style="color: #C678DD; ">&gt;=</span> <span class="constant" style="color: #56B6C2; ">?A</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="text" style="color: #ABB2BF; ">alias</span> <span class="operator" style="color: #C678DD; ">&lt;=</span> <span class="constant" style="color: #56B6C2; ">?Z</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">string</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="function" style="color: #61AFEF; ">binary_part</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">0</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="function" style="color: #61AFEF; ">byte_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-</span> <span class="function" style="color: #61AFEF; ">byte_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">last_part</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-</span> <span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="module" style="color: #61AFEF; ">String</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_atom</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">&quot;Elixir.&quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span> <span class="text" style="color: #ABB2BF; ">last_part</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">maybe_atomize_calendar</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_last_part</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">{</span><span class="module" style="color: #61AFEF; ">Calendar.ISO</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">}</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">maybe_raise!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:error</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">reason</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">calendar</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">type</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span>
          <span class="string" style="color: #98C379; ">&quot;cannot parse <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span> as <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">type</span><span class="text" style="color: #ABB2BF; ">}</span></span> for <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">calendar</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>, &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
            <span class="string" style="color: #98C379; ">&quot;reason: <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="function" style="color: #61AFEF; ">inspect</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">reason</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span></span>&quot;</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">maybe_raise!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">other</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_calendar</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_type</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_string</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">do: </span><span class="text" style="color: #ABB2BF; ">other</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">to_calendar_struct</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">type</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">quote</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="text" style="color: #ABB2BF; ">%</span><span class="text" style="color: #ABB2BF; ">{</span><span class="keyword" style="color: #E06C75; ">unquote_splicing</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">[</span><span class="string" style="color: #98C379; ">__struct__: </span><span class="text" style="color: #ABB2BF; ">type</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="operator" style="color: #C678DD; ">++</span> <span class="text" style="color: #ABB2BF; ">fields</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">~S<span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Handles the sigil `~w` for list of words.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It returns a list of &quot;words&quot; split by whitespace. Character unescaping and</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  interpolation happens for each word.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Modifiers</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `s`: words in the list are strings (default)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `a`: words in the list are atoms</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `c`: words in the list are charlists</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~w(foo #{:bar} baz)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~w(foo #{&quot; bar baz &quot;})</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~w(--source test/enum_test.exs)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [&quot;--source&quot;, &quot;test/enum_test.exs&quot;]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~w(foo bar baz)a</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [:foo, :bar, :baz]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~w(foo bar baz)c</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [~c&quot;foo&quot;, ~c&quot;bar&quot;, ~c&quot;baz&quot;]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_w</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_w</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">split_words</span><span class="text" style="color: #ABB2BF; ">(</span><span class="module" style="color: #61AFEF; ">:elixir_interpolation</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">unescape_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_w</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">pieces</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">binary</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="function" style="color: #61AFEF; ">unescape_tokens</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">pieces</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">}</span>
    <span class="function" style="color: #61AFEF; ">split_words</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">~S<span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  Handles the sigil `~W` for list of words.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  It returns a list of &quot;words&quot; split by whitespace without interpolations</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  and without escape characters, except for the escaping of the closing</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  sigil character itself.</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Modifiers</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `s`: words in the list are strings (default)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `a`: words in the list are atoms</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">    * `c`: words in the list are charlists</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  ## Examples</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      iex&gt; ~W(foo #{bar} baz)</span>
<span class="comment" style="font-style: italic; color: #5C6370; ">      [&quot;foo&quot;, &quot;\#{bar}&quot;, &quot;baz&quot;]</span>
<span class="comment" style="font-style: italic; color: #5C6370; "></span>
<span class="comment" style="font-style: italic; color: #5C6370; ">  <span class="comment" style="font-style: italic; color: #5C6370; ">&quot;&quot;&quot;</span></span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_W</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">term</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">)</span>

  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">sigil_W</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&lt;&lt;&gt;&gt;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_meta</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">split_words</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">modifiers</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">split_words</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">caller</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="function" style="color: #61AFEF; ">split_words</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="constant" style="color: #56B6C2; ">?s</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">caller</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">split_words</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">mod</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">caller</span><span class="text" style="color: #ABB2BF; ">)</span>
       <span class="keyword" style="color: #E06C75; ">when</span> <span class="text" style="color: #ABB2BF; ">mod</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="constant" style="color: #56B6C2; ">?s</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="text" style="color: #ABB2BF; ">mod</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="constant" style="color: #56B6C2; ">?a</span> <span class="keyword" style="color: #E06C75; ">or</span> <span class="text" style="color: #ABB2BF; ">mod</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="constant" style="color: #56B6C2; ">?c</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">parts</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">String</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">split</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span>

        <span class="text" style="color: #ABB2BF; ">parts_with_trailing_comma</span> <span class="operator" style="color: #C678DD; ">=</span>
          <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">filter</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="text" style="color: #ABB2BF; ">(</span><span class="function" style="color: #61AFEF; ">byte_size</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="operator" style="color: #C678DD; ">1</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">&gt;</span> <span class="text" style="color: #ABB2BF; ">1</span> <span class="keyword" style="color: #E06C75; ">and</span> <span class="module" style="color: #61AFEF; ">:binary</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">last</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="operator" style="color: #C678DD; ">1</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">==</span> <span class="constant" style="color: #56B6C2; ">?,</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">parts</span><span class="text" style="color: #ABB2BF; ">)</span>

        <span class="keyword" style="color: #E06C75; ">if</span> <span class="text" style="color: #ABB2BF; ">parts_with_trailing_comma</span> <span class="operator" style="color: #C678DD; ">!=</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">]</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="text" style="color: #ABB2BF; ">stacktrace</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="module" style="color: #61AFEF; ">Macro.Env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">stacktrace</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">caller</span><span class="text" style="color: #ABB2BF; ">)</span>

          <span class="module" style="color: #61AFEF; ">IO</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">warn</span><span class="text" style="color: #ABB2BF; ">(</span>
            <span class="string" style="color: #98C379; ">&quot;the sigils ~w/~W do not allow trailing commas at the end of each word. &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
              <span class="string" style="color: #98C379; ">&quot;If the comma is necessary, define a regular list with [...], otherwise remove the comma.&quot;</span><span class="text" style="color: #ABB2BF; ">,</span>
            <span class="text" style="color: #ABB2BF; ">stacktrace</span>
          <span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

        <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">mod</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="constant" style="color: #56B6C2; ">?s</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">parts</span>
          <span class="constant" style="color: #56B6C2; ">?a</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="module" style="color: #61AFEF; ">String</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_atom</span><span class="operator" style="color: #C678DD; ">/</span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">parts</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="constant" style="color: #56B6C2; ">?c</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="module" style="color: #61AFEF; ">String</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_charlist</span><span class="operator" style="color: #C678DD; ">/</span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">parts</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>

      <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="text" style="color: #ABB2BF; ">parts</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">String</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">split</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">string</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>

        <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">mod</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="constant" style="color: #56B6C2; ">?s</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">parts</span>
          <span class="constant" style="color: #56B6C2; ">?a</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="module" style="color: #61AFEF; ">String</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_atom</span><span class="operator" style="color: #C678DD; ">/</span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">parts</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="constant" style="color: #56B6C2; ">?c</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="operator" style="color: #C678DD; ">&amp;</span><span class="module" style="color: #61AFEF; ">String</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_charlist</span><span class="operator" style="color: #C678DD; ">/</span><span class="text" style="color: #ABB2BF; ">1</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">parts</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">split_words</span><span class="text" style="color: #ABB2BF; ">(</span><span class="comment" style="font-style: italic; color: #5C6370; ">_string</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_mods</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_caller</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;modifier must be one of: s, a, c&quot;</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">## Shared functions</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">assert_module_scope</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arity</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">module</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="constant" style="color: #56B6C2; ">nil</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;cannot invoke <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">}</span></span>/<span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">arity</span><span class="text" style="color: #ABB2BF; ">}</span></span> outside module&quot;</span>
      <span class="text" style="color: #ABB2BF; ">mod</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">mod</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">assert_no_function_scope</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">env</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">arity</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">function</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="constant" style="color: #56B6C2; ">nil</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="string" style="color: #98C379; ">:ok</span>
      <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="string" style="color: #98C379; ">&quot;cannot invoke <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">fun</span><span class="text" style="color: #ABB2BF; ">}</span></span>/<span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">arity</span><span class="text" style="color: #ABB2BF; ">}</span></span> inside function/macro&quot;</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">assert_no_match_or_guard_scope</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">context</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">exp</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">case</span> <span class="text" style="color: #ABB2BF; ">context</span> <span class="keyword" style="color: #E06C75; ">do</span>
      <span class="string" style="color: #98C379; ">:match</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="function" style="color: #61AFEF; ">invalid_match!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">exp</span><span class="text" style="color: #ABB2BF; ">)</span>

      <span class="string" style="color: #98C379; ">:guard</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span>
              <span class="string" style="color: #98C379; ">&quot;invalid expression in guard, <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">exp</span><span class="text" style="color: #ABB2BF; ">}</span></span> is not allowed in guards. &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
                <span class="string" style="color: #98C379; ">&quot;To learn more about guards, visit: https://hexdocs.pm/elixir/patterns-and-guards.html&quot;</span>

      <span class="comment" style="font-style: italic; color: #5C6370; ">_</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="string" style="color: #98C379; ">:ok</span>
    <span class="keyword" style="color: #E06C75; ">end</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">invalid_match!</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">exp</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="keyword" style="color: #E06C75; ">raise</span> <span class="module" style="color: #61AFEF; ">ArgumentError</span><span class="text" style="color: #ABB2BF; ">,</span>
          <span class="string" style="color: #98C379; ">&quot;invalid expression in match, <span class="text" style="color: #ABB2BF; "><span class="text" style="color: #ABB2BF; ">#{</span><span class="text" style="color: #ABB2BF; ">exp</span><span class="text" style="color: #ABB2BF; ">}</span></span> is not allowed in patterns &quot;</span> <span class="operator" style="color: #C678DD; ">&lt;&gt;</span>
            <span class="string" style="color: #98C379; ">&quot;such as function clauses, case clauses or on the left side of the = operator&quot;</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; "># Helper to handle the :ok | :error tuple returned from :elixir_interpolation.unescape_tokens</span>
  <span class="comment" style="font-style: italic; color: #5C6370; "># We need to do this for bootstrapping purposes, actual code can use Macro.unescape_string.</span>
  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">unescape_tokens</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">tokens</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map</span><span class="text" style="color: #ABB2BF; ">(</span>
      <span class="keyword" style="color: #E06C75; ">fn</span> <span class="text" style="color: #ABB2BF; ">token</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">case</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">token</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="module" style="color: #61AFEF; ">:elixir_interpolation</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">unescape_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">token</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">token</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
      <span class="keyword" style="color: #E06C75; ">end</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="text" style="color: #ABB2BF; ">tokens</span>
    <span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">unescape_tokens</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">tokens</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">unescape_map</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map</span><span class="text" style="color: #ABB2BF; ">(</span>
      <span class="keyword" style="color: #E06C75; ">fn</span> <span class="text" style="color: #ABB2BF; ">token</span> <span class="operator" style="color: #C678DD; ">-&gt;</span>
        <span class="keyword" style="color: #E06C75; ">case</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">token</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
          <span class="constant" style="color: #56B6C2; ">true</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="module" style="color: #61AFEF; ">:elixir_interpolation</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">unescape_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">token</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">unescape_map</span><span class="text" style="color: #ABB2BF; ">)</span>
          <span class="constant" style="color: #56B6C2; ">false</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">token</span>
        <span class="keyword" style="color: #E06C75; ">end</span>
      <span class="keyword" style="color: #E06C75; ">end</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="text" style="color: #ABB2BF; ">tokens</span>
    <span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="keyword" style="color: #E06C75; ">defp</span> <span class="function" style="color: #61AFEF; ">unescape_list_tokens</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">tokens</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="text" style="color: #ABB2BF; ">escape</span> <span class="operator" style="color: #C678DD; ">=</span> <span class="keyword" style="color: #E06C75; ">fn</span>
      <span class="text" style="color: #ABB2BF; ">{</span><span class="string" style="color: #98C379; ">:&quot;::&quot;</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">[</span><span class="text" style="color: #ABB2BF; ">expr</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="comment" style="font-style: italic; color: #5C6370; ">_</span><span class="text" style="color: #ABB2BF; ">]</span><span class="text" style="color: #ABB2BF; ">}</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="text" style="color: #ABB2BF; ">expr</span>
      <span class="text" style="color: #ABB2BF; ">binary</span> <span class="keyword" style="color: #E06C75; ">when</span> <span class="function" style="color: #61AFEF; ">is_binary</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="operator" style="color: #C678DD; ">-&gt;</span> <span class="module" style="color: #61AFEF; ">:elixir_interpolation</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">unescape_string</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">binary</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="keyword" style="color: #E06C75; ">end</span>

    <span class="module" style="color: #61AFEF; ">:lists</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">map</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">escape</span><span class="text" style="color: #ABB2BF; ">,</span> <span class="text" style="color: #ABB2BF; ">tokens</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>

  <span class="comment" style="font-style: italic; color: #5C6370; ">@</span><span class="comment" style="font-style: italic; color: #5C6370; ">doc</span> <span class="comment" style="font-style: italic; color: #5C6370; ">false</span>
  <span class="keyword" style="color: #E06C75; ">defmacro</span> <span class="function" style="color: #61AFEF; ">to_char_list</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">)</span> <span class="keyword" style="color: #E06C75; ">do</span>
    <span class="module" style="color: #61AFEF; ">IO</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">warn</span><span class="text" style="color: #ABB2BF; ">(</span>
      <span class="string" style="color: #98C379; ">&quot;Kernel.to_char_list/1 is deprecated, use Kernel.to_charlist/1 instead&quot;</span><span class="text" style="color: #ABB2BF; ">,</span>
      <span class="module" style="color: #61AFEF; ">Macro.Env</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">stacktrace</span><span class="text" style="color: #ABB2BF; ">(</span><span class="constant builtin" style="color: #D19A66; ">__CALLER__</span><span class="text" style="color: #ABB2BF; ">)</span>
    <span class="text" style="color: #ABB2BF; ">)</span>

    <span class="keyword" style="color: #E06C75; ">quote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="string" style="color: #98C379; ">do: </span><span class="module" style="color: #61AFEF; ">Kernel</span><span class="operator" style="color: #C678DD; ">.</span><span class="function" style="color: #61AFEF; ">to_charlist</span><span class="text" style="color: #ABB2BF; ">(</span><span class="keyword" style="color: #E06C75; ">unquote</span><span class="text" style="color: #ABB2BF; ">(</span><span class="text" style="color: #ABB2BF; ">arg</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span><span class="text" style="color: #ABB2BF; ">)</span>
  <span class="keyword" style="color: #E06C75; ">end</span>
<span class="keyword" style="color: #E06C75; ">end</span>
</code></pre>
</body>
</html>
