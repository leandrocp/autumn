<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Autumn Sample - javascript - dracula (inline)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap" rel="stylesheet">
  <style>
    * {
      font-family: 'JetBrains Mono', monospace;
      line-height: 1.5;
    }
    pre {
      font-size: 15px;
      margin: 20px;
      padding: 50px;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <pre class="autumn-hl" style="background-color: #282A36; color: #f8f8f2;"><code class="language-javascript" translate="no"><span class="ahl-keyword" style="color: #ff79c6;">import</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
  <span class="ahl-variable" style="color: #f8f8f2;">BEFORE_UNLOAD_LOADER_TIMEOUT</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">CHECKABLE_INPUTS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">CONSECUTIVE_RELOADS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_AUTO_RECOVER</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_COMPONENT</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_CONNECTED_CLASS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_DISABLE_WITH</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_DISABLE_WITH_RESTORE</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_DISABLED</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_LOADING_CLASS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_EVENT_CLASSES</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_ERROR_CLASS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_CLIENT_ERROR_CLASS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_SERVER_ERROR_CLASS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_FEEDBACK_FOR</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_FEEDBACK_GROUP</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_HAS_FOCUSED</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_HAS_SUBMITTED</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_HOOK</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_PAGE_LOADING</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_PARENT_ID</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_PROGRESS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_READONLY</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_REF</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_REF_SRC</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_ROOT_ID</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_SESSION</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_STATIC</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_TRACK_STATIC</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_TRACK_UPLOADS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_UPDATE</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_UPLOAD_REF</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_VIEW_SELECTOR</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_MAIN</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_MOUNTED</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PUSH_TIMEOUT</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_VIEWPORT_TOP</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">PHX_VIEWPORT_BOTTOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">from</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;.&#x2f;constants&quot;</span>

<span class="ahl-keyword" style="color: #ff79c6;">import</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
  <span class="ahl-variable" style="color: #f8f8f2;">clone</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">closestPhxBinding</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">isEmpty</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">isEqualObj</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">logError</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">maybe</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
  <span class="ahl-variable" style="color: #f8f8f2;">isCid</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">from</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;.&#x2f;utils&quot;</span>

<span class="ahl-keyword" style="color: #ff79c6;">import</span> <span class="ahl-variable" style="color: #f8f8f2;">Browser</span> <span class="ahl-keyword" style="color: #ff79c6;">from</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;.&#x2f;browser&quot;</span>
<span class="ahl-keyword" style="color: #ff79c6;">import</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span> <span class="ahl-keyword" style="color: #ff79c6;">from</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;.&#x2f;dom&quot;</span>
<span class="ahl-keyword" style="color: #ff79c6;">import</span> <span class="ahl-variable" style="color: #f8f8f2;">DOMPatch</span> <span class="ahl-keyword" style="color: #ff79c6;">from</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;.&#x2f;dom_patch&quot;</span>
<span class="ahl-keyword" style="color: #ff79c6;">import</span> <span class="ahl-variable" style="color: #f8f8f2;">LiveUploader</span> <span class="ahl-keyword" style="color: #ff79c6;">from</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;.&#x2f;live_uploader&quot;</span>
<span class="ahl-keyword" style="color: #ff79c6;">import</span> <span class="ahl-variable" style="color: #f8f8f2;">Rendered</span> <span class="ahl-keyword" style="color: #ff79c6;">from</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;.&#x2f;rendered&quot;</span>
<span class="ahl-keyword" style="color: #ff79c6;">import</span> <span class="ahl-variable" style="color: #f8f8f2;">ViewHook</span> <span class="ahl-keyword" style="color: #ff79c6;">from</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;.&#x2f;view_hook&quot;</span>
<span class="ahl-keyword" style="color: #ff79c6;">import</span> <span class="ahl-variable" style="color: #f8f8f2;">JS</span> <span class="ahl-keyword" style="color: #ff79c6;">from</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;.&#x2f;js&quot;</span>

<span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">serializeForm</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">metadata</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onlyNames</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
  <span class="ahl-keyword" style="color: #ff79c6;">const</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>submitter<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> ...<span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">metadata</span>

  <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; We must inject the submitter in the order that it exists in the DOM</span>
  <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; releative to other inputs. For example, for checkbox groups, the order must be maintained.</span>
  <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">injectedElement</span>
  <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">submitter</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">submitter</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>name<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">const</span> <span class="ahl-variable" style="color: #f8f8f2;">input</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">document</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>createElement<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;input&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>type <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;hidden&quot;</span>
    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; set the form attribute if the submitter has one;</span>
    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; this can happen if the element is outside the actual form element</span>
    <span class="ahl-keyword" style="color: #ff79c6;">const</span> <span class="ahl-variable" style="color: #f8f8f2;">formId</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">submitter</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;form&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formId</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>setAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;form&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">formId</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>name <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">submitter</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>name
    <span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>value <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">submitter</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>value
    <span class="ahl-variable" style="color: #f8f8f2;">submitter</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>parentElement<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>insertBefore<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">submitter</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable" style="color: #f8f8f2;">injectedElement</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">input</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  <span class="ahl-keyword" style="color: #ff79c6;">const</span> <span class="ahl-variable" style="color: #f8f8f2;">formData</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">new</span> <span class="ahl-variable" style="color: #f8f8f2;">FormData</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-keyword" style="color: #ff79c6;">const</span> <span class="ahl-variable" style="color: #f8f8f2;">toRemove</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>

  <span class="ahl-variable" style="color: #f8f8f2;">formData</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">val</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">key</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">_index</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">val</span> <span class="ahl-keyword" style="color: #ff79c6;">instanceof</span> <span class="ahl-variable" style="color: #f8f8f2;">File</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">toRemove</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>push<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">key</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

  <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; Cleanup after building fileData</span>
  <span class="ahl-variable" style="color: #f8f8f2;">toRemove</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">key</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">formData</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>delete<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">key</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

  <span class="ahl-keyword" style="color: #ff79c6;">const</span> <span class="ahl-variable" style="color: #f8f8f2;">params</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">new</span> <span class="ahl-variable" style="color: #f8f8f2;">URLSearchParams</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

  <span class="ahl-keyword" style="color: #ff79c6;">for</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">key</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">val</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-keyword" style="color: #ff79c6;">of</span> <span class="ahl-variable" style="color: #f8f8f2;">formData</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>entries<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">onlyNames</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">===</span> 0 <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-variable" style="color: #f8f8f2;">onlyNames</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>indexOf<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">key</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">&gt;=</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">params</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>append<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">key</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">val</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; remove the injected element again</span>
  <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; (it would be removed by the next dom patch anyway, but this is cleaner)</span>
  <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">submitter</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">injectedElement</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable" style="color: #f8f8f2;">submitter</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>parentElement<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>removeChild<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">injectedElement</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  <span class="ahl-keyword" style="color: #ff79c6;">for</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">metaKey</span> <span class="ahl-keyword" style="color: #ff79c6;">in</span> <span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">params</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>append<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">metaKey</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">metaKey</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">params</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>toString<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

<span class="ahl-keyword" style="color: #ff79c6;">export</span> <span class="ahl-keyword" style="color: #ff79c6;">default</span> <span class="ahl-keyword" style="color: #ff79c6;">class</span> <span class="ahl-variable" style="color: #f8f8f2;">View</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
  constructor<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">liveSocket</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">parentView</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">flash</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">liveReferer</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isDead <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">false</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">liveSocket</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>flash <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">flash</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>parent <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">parentView</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>root <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">parentView</span> ? <span class="ahl-variable" style="color: #f8f8f2;">parentView</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>root : <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>ref <span class="ahl-operator" style="color: #f8f8f2;">=</span> 0
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>childJoins <span class="ahl-operator" style="color: #f8f8f2;">=</span> 0
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>loaderTimer <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pendingDiffs <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pendingForms <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">new</span> <span class="ahl-variable" style="color: #f8f8f2;">Set</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>redirect <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">false</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>href <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinCount <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>parent ? <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>parent<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinCount <span class="ahl-operator" style="color: #f8f8f2;">-</span> 1 : 0
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinPending <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>destroyed <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">false</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinCallback <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">function</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">onDone</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">onDone</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">onDone</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>stopCallback <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">function</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pendingJoinOps <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>parent ? <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span> : <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>viewHooks <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>formSubmits <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>children <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>parent ? <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span> : <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>root<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>children<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>channel <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>channel<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">`lv:<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>`</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">url</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>href <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>expandURL<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>href<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        redirect: <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>redirect ? <span class="ahl-variable" style="color: #f8f8f2;">url</span> : <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">undefined</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
        url: <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>redirect ? <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">undefined</span> : <span class="ahl-variable" style="color: #f8f8f2;">url</span> <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">undefined</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
        params: <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>connectParams<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">liveReferer</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
        session: <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getSession<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
        static: <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getStatic<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
        flash: <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>flash<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  setHref<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">href</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>href <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">href</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  setRedirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">href</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>redirect <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>href <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">href</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  isMain<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>hasAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_MAIN</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  connectParams<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">liveReferer</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">params</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>params<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">manifest</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span>
      <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>all<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">document</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">`[<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_TRACK_STATIC</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>]`</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>map<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">node</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">node</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>src <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-variable" style="color: #f8f8f2;">node</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>href<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">url</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-keyword" style="color: #ff79c6;">typeof</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">url</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;string&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">manifest</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">&gt;</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">params</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-string" style="color: #f1fa8c;">&quot;_track_static&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">manifest</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable" style="color: #f8f8f2;">params</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-string" style="color: #f1fa8c;">&quot;_mounts&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinCount
    <span class="ahl-variable" style="color: #f8f8f2;">params</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-string" style="color: #f1fa8c;">&quot;_live_referer&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">liveReferer</span>

    <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">params</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  isConnected<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>channel<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>canPush<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  getSession<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_SESSION</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  getStatic<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">val</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_STATIC</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">val</span> <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;&quot;</span> ? <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span> : <span class="ahl-variable" style="color: #f8f8f2;">val</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  destroy<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">callback</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">function</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>destroyAllChildren<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>destroyed <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span>
    <span class="ahl-keyword" style="color: #ff79c6;">delete</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>root<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>children<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>parent<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">delete</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>root<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>children<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>parent<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable" style="color: #f8f8f2;">clearTimeout</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>loaderTimer<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">onFinished</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">for</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">id</span> <span class="ahl-keyword" style="color: #ff79c6;">in</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>viewHooks<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>destroyHook<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>viewHooks<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">id</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

    <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>markPhxChildDestroyed<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>log<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;destroyed&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-string" style="color: #f1fa8c;">&quot;the child has been removed from the parent&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>channel<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>leave<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>receive<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;ok&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onFinished</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>receive<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;error&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onFinished</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>receive<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;timeout&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onFinished</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  setContainerClasses<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span>...<span class="ahl-variable" style="color: #f8f8f2;">classes</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>classList<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>remove<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span>
      <span class="ahl-variable" style="color: #f8f8f2;">PHX_CONNECTED_CLASS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
      <span class="ahl-variable" style="color: #f8f8f2;">PHX_LOADING_CLASS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
      <span class="ahl-variable" style="color: #f8f8f2;">PHX_ERROR_CLASS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
      <span class="ahl-variable" style="color: #f8f8f2;">PHX_CLIENT_ERROR_CLASS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
      <span class="ahl-variable" style="color: #f8f8f2;">PHX_SERVER_ERROR_CLASS</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>classList<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>add<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span>...<span class="ahl-variable" style="color: #f8f8f2;">classes</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  showLoader<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">timeout</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable" style="color: #f8f8f2;">clearTimeout</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>loaderTimer<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">timeout</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>loaderTimer <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">setTimeout</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>showLoader<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">timeout</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">for</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">id</span> <span class="ahl-keyword" style="color: #ff79c6;">in</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>viewHooks<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>viewHooks<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">id</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>__disconnected<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>setContainerClasses<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_LOADING_CLASS</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  execAll<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">binding</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>all<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">`[<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">binding</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>]`</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>execJS<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">binding</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  hideLoader<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable" style="color: #f8f8f2;">clearTimeout</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>loaderTimer<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>setContainerClasses<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_CONNECTED_CLASS</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>execAll<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;connected&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  triggerReconnected<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">for</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">id</span> <span class="ahl-keyword" style="color: #ff79c6;">in</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>viewHooks<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>viewHooks<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">id</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>__reconnected<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  log<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">kind</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">msgCallback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>log<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">kind</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">msgCallback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  transition<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">time</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onStart</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onDone</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">function</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>transition<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">time</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onStart</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onDone</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  withinTargets<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">phxTarget</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">phxTarget</span> <span class="ahl-keyword" style="color: #ff79c6;">instanceof</span> <span class="ahl-variable" style="color: #f8f8f2;">HTMLElement</span> <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-variable" style="color: #f8f8f2;">phxTarget</span> <span class="ahl-keyword" style="color: #ff79c6;">instanceof</span> <span class="ahl-variable" style="color: #f8f8f2;">SVGElement</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>owner<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">phxTarget</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">view</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">view</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">phxTarget</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">isCid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">phxTarget</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">targets</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>findComponentNodeList<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">phxTarget</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">targets</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">===</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable" style="color: #f8f8f2;">logError</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">`no component found matching phx-target of <span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">phxTarget</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>`</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">parseInt</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">phxTarget</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">targets</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">Array</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>from<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">document</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>querySelectorAll<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">phxTarget</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">targets</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">===</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">logError</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">`nothing found matching the phx-target selector &quot;<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">phxTarget</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>&quot;`</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-variable" style="color: #f8f8f2;">targets</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">target</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>owner<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">target</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">view</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">view</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">target</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  applyDiff<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">type</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">rawDiff</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>log<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">type</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-string" style="color: #f1fa8c;">&quot;&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">clone</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">rawDiff</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>diff<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> reply<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> events<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> title<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">Rendered</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>extract<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">rawDiff</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>diff<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> reply<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> events<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">title</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">window</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>requestAnimationFrame<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>putTitle<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">title</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  onJoin<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>rendered<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> container<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">resp</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">container</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">tag</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">attrs</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">container</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>replaceRootContainer<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">tag</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">attrs</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>childJoins <span class="ahl-operator" style="color: #f8f8f2;">=</span> 0
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinPending <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>flash <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span>

    <span class="ahl-variable" style="color: #f8f8f2;">Browser</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>dropLocal<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>localStorage<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">window</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>location<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pathname<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">CONSECUTIVE_RELOADS</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>applyDiff<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;mount&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">rendered</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>diff<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> events<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>rendered <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">new</span> <span class="ahl-variable" style="color: #f8f8f2;">Rendered</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">diff</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">streams</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>renderContainer<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;join&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>dropPendingRefs<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">forms</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>formsForRecovery<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">newForm</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">newCid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pendingForms<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>has<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinCount<span class="ahl-operator" style="color: #f8f8f2;">++</span>

      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">forms</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">&gt;</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable" style="color: #f8f8f2;">forms</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">newForm</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">newCid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">i</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
          <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pendingForms<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>add<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
          <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pushFormRecovery<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">newCid</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">resp</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
            <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pendingForms<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>delete<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
            <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">i</span> <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-variable" style="color: #f8f8f2;">forms</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">-</span> 1<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
              <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onJoinComplete<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">streams</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">events</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
            <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
          <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onJoinComplete<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">streams</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">events</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  dropPendingRefs<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>all<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">document</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">`[<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_REF_SRC</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>=&quot;<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>&quot;][<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_REF</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>]`</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>removeAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_REF</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>removeAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_REF_SRC</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  onJoinComplete<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>live_patch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">streams</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">events</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; we can clear pending form recoveries now that we&#x27;ve joined.</span>
    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; They either all resolved or were abandoned</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pendingForms<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>clear<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; In order to provide a better experience, we want to join</span>
    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; all LiveViews first and only then apply their patches.</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinCount <span class="ahl-operator" style="color: #f8f8f2;">&gt;</span> 1 <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>parent <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>parent<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isJoinPending<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>applyJoinPatch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">live_patch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">streams</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">events</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; One downside of this approach is that we need to find phxChildren</span>
    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; in the html fragment, instead of directly on the DOM. The fragment</span>
    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; also does not include PHX_STATIC, so we need to copy it over from</span>
    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; the DOM.</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">newChildren</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>findPhxChildrenInFragment<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">toEl</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">fromEl</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">toEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>querySelector<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">`[id=&quot;<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">toEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>&quot;]`</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">phxStatic</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">fromEl</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">fromEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_STATIC</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">phxStatic</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">toEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>setAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_STATIC</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">phxStatic</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; set PHX_ROOT_ID to prevent events from being dispatched to the root view</span>
      <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; while the child join is still pending</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">fromEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">fromEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>setAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_ROOT_ID</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>root<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinChild<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">toEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">newChildren</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">===</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>parent<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>root<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pendingJoinOps<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>push<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>applyJoinPatch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">live_patch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">streams</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">events</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>parent<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>ackJoin<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onAllChildJoinsComplete<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>applyJoinPatch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">live_patch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">streams</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">events</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>root<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pendingJoinOps<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>push<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>applyJoinPatch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">live_patch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">streams</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">events</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  attachTrueDocEl<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>byId<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>setAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_ROOT_ID</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>root<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  execNewMounted<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">phxViewportTop</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_VIEWPORT_TOP</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">phxViewportBottom</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_VIEWPORT_BOTTOM</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>all<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">`[<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">phxViewportTop</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>], [<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">phxViewportBottom</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>]`</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">hookEl</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>maybeAddPrivateHooks<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">hookEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">phxViewportTop</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">phxViewportBottom</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>maybeAddNewHook<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">hookEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>all<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">`[<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_HOOK</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>], [data-phx-<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_HOOK</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>]`</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">hookEl</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>maybeAddNewHook<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">hookEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>all<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">`[<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_MOUNTED</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>]`</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>maybeMounted<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  applyJoinPatch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">live_patch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">streams</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">events</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>attachTrueDocEl<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">patch</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">new</span> <span class="ahl-variable" style="color: #f8f8f2;">DOMPatch</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">streams</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable" style="color: #f8f8f2;">patch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>markPrunableContentForRemoval<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>performPatch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">patch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">false</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinNewChildren<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>execNewMounted<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinPending <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">false</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>dispatchEvents<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">events</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>applyPendingUpdates<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">live_patch</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>kind<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> to<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">live_patch</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>historyPatch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">to</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">kind</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>hideLoader<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinCount <span class="ahl-operator" style="color: #f8f8f2;">&gt;</span> 1<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>triggerReconnected<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>stopCallback<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  triggerBeforeUpdateHook<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">fromEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">toEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>triggerDOM<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;onBeforeElUpdated&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">fromEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">toEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">hook</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getHook<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">fromEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">isIgnored</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">hook</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isIgnored<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">fromEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_UPDATE</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">hook</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable" style="color: #f8f8f2;">fromEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isEqualNode<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">toEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">isIgnored</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">isEqualObj</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">fromEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>dataset<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">toEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>dataset<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">hook</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>__beforeUpdate<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">hook</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  maybeMounted<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">phxMounted</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_MOUNTED</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">hasBeenInvoked</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">phxMounted</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>private<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;mounted&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">phxMounted</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable" style="color: #f8f8f2;">hasBeenInvoked</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>execJS<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">phxMounted</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>putPrivate<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;mounted&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  maybeAddNewHook<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">force</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">newHook</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>addHook<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">newHook</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">newHook</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>__mounted<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  performPatch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">patch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">pruneCids</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">isJoinPatch</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">false</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">removedEls</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">phxChildrenAdded</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">false</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">updatedHookIds</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">new</span> <span class="ahl-variable" style="color: #f8f8f2;">Set</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-variable" style="color: #f8f8f2;">patch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>after<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;added&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>triggerDOM<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;onNodeAdded&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">phxViewportTop</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_VIEWPORT_TOP</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">phxViewportBottom</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_VIEWPORT_BOTTOM</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>maybeAddPrivateHooks<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">phxViewportTop</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">phxViewportBottom</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>maybeAddNewHook<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>maybeMounted<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-variable" style="color: #f8f8f2;">patch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>after<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;phxChildAdded&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isPhxSticky<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinRootViews<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable" style="color: #f8f8f2;">phxChildrenAdded</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-variable" style="color: #f8f8f2;">patch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>before<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;updated&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">fromEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">toEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">hook</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>triggerBeforeUpdateHook<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">fromEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">toEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">hook</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">updatedHookIds</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>add<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">fromEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-variable" style="color: #f8f8f2;">patch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>after<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;updated&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">updatedHookIds</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>has<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getHook<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>__updated<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-variable" style="color: #f8f8f2;">patch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>after<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;discarded&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>nodeType <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-variable" style="color: #f8f8f2;">Node</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>ELEMENT_NODE<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">removedEls</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>push<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-variable" style="color: #f8f8f2;">patch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>after<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;transitionsDiscarded&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">els</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>afterElementsRemoved<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">els</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">pruneCids</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable" style="color: #f8f8f2;">patch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>perform<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">isJoinPatch</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>afterElementsRemoved<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">removedEls</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">pruneCids</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">phxChildrenAdded</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  afterElementsRemoved<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">elements</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">pruneCids</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">destroyedCIDs</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>
    <span class="ahl-variable" style="color: #f8f8f2;">elements</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">parent</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">components</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>all<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">parent</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">`[<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_COMPONENT</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>]`</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">hooks</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>all<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">parent</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">`[<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_HOOK</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>]`</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable" style="color: #f8f8f2;">components</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>concat<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">parent</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">cid</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>componentID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">isCid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">cid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">destroyedCIDs</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>indexOf<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">cid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-operator" style="color: #f8f8f2;">-</span>1<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">destroyedCIDs</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>push<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">cid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable" style="color: #f8f8f2;">hooks</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>concat<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">parent</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">hookEl</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">hook</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getHook<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">hookEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-variable" style="color: #f8f8f2;">hook</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>destroyHook<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">hook</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; We should not pruneCids on joins. Otherwise, in case of</span>
    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; rejoins, we may notify cids that no longer belong to the</span>
    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; current LiveView to be removed.</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">pruneCids</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>maybePushComponentsDestroyed<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">destroyedCIDs</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  joinNewChildren<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>findPhxChildren<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinChild<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  getChildById<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">id</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>root<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>children<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">id</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  getDescendentByEl<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>children<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_PARENT_ID</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  destroyDescendent<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">id</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">for</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">parentId</span> <span class="ahl-keyword" style="color: #ff79c6;">in</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>root<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>children<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">for</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">childId</span> <span class="ahl-keyword" style="color: #ff79c6;">in</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>root<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>children<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">parentId</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">childId</span> <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-variable" style="color: #f8f8f2;">id</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>root<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>children<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">parentId</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">childId</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>destroy<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  joinChild<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">child</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getChildById<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable" style="color: #f8f8f2;">child</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">view</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">new</span> <span class="ahl-variable" style="color: #f8f8f2;">View</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>root<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>children<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">view</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">view</span>
      <span class="ahl-variable" style="color: #f8f8f2;">view</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>join<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>childJoins<span class="ahl-operator" style="color: #f8f8f2;">++</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  isJoinPending<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinPending <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  ackJoin<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">_child</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>childJoins<span class="ahl-operator" style="color: #f8f8f2;">--</span>

    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>childJoins <span class="ahl-operator" style="color: #f8f8f2;">===</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>parent<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>parent<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>ackJoin<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onAllChildJoinsComplete<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  onAllChildJoinsComplete<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinCallback<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pendingJoinOps<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">view</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">op</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable" style="color: #f8f8f2;">view</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isDestroyed<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">op</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pendingJoinOps <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  update<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">diff</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">events</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isJoinPending<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>hasPendingLink<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>root<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isMain<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pendingDiffs<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>push<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>diff<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> events<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>rendered<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>mergeDiff<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">diff</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">phxChildrenAdded</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">false</span>

    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; When the diff only contains component diffs, then walk components</span>
    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; and patch only the parent component containers found in the diff.</span>
    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; Otherwise, patch entire LV container.</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>rendered<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isComponentOnlyDiff<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">diff</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>time<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;component patch complete&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">parentCids</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>findExistingParentCIDs<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>rendered<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>componentCIDs<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">diff</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-variable" style="color: #f8f8f2;">parentCids</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">parentCID</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
          <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>componentPatch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>rendered<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getComponent<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">diff</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">parentCID</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">parentCID</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">phxChildrenAdded</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
        <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable" style="color: #f8f8f2;">isEmpty</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">diff</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>time<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;full patch complete&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">streams</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>renderContainer<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">diff</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;update&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">patch</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">new</span> <span class="ahl-variable" style="color: #f8f8f2;">DOMPatch</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">streams</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-variable" style="color: #f8f8f2;">phxChildrenAdded</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>performPatch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">patch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>dispatchEvents<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">events</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">phxChildrenAdded</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinNewChildren<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  renderContainer<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">diff</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">kind</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>time<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">`toString diff (<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">kind</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>)`</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">tag</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>tagName
      <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; Don&#x27;t skip any component in the diff nor any marked as pruned</span>
      <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; (as they may have been added back)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">cids</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">diff</span> ? <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>rendered<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>componentCIDs<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">diff</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> : <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">streams</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>rendered<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>toString<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">cids</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-string" style="color: #f1fa8c;">`&lt;<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">tag</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>&gt;<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>&lt;&#x2f;<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">tag</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>&gt;`</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">streams</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  componentPatch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">diff</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">cid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">isEmpty</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">diff</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">false</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">streams</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>rendered<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>componentToString<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">cid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">patch</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">new</span> <span class="ahl-variable" style="color: #f8f8f2;">DOMPatch</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">streams</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">cid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">childrenAdded</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>performPatch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">patch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">childrenAdded</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  getHook<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>viewHooks<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">ViewHook</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>elementID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  addHook<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">ViewHook</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>elementID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">hookName</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">`data-phx-<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_HOOK</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>`</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_HOOK</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">hookName</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>ownsElement<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">callbacks</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getHookCallbacks<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">hookName</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">callbacks</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">logError</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">`no DOM ID for hook &quot;<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">hookName</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>&quot;. Hooks require a unique ID on each element.`</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">hook</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">new</span> <span class="ahl-variable" style="color: #f8f8f2;">ViewHook</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">callbacks</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>viewHooks<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">ViewHook</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>elementID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">hook</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">hook</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">hook</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">hookName</span> <span class="ahl-operator" style="color: #f8f8f2;">!==</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">logError</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">`unknown hook found for &quot;<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">hookName</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>&quot;`</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  destroyHook<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">hook</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable" style="color: #f8f8f2;">hook</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>__destroyed<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable" style="color: #f8f8f2;">hook</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>__cleanup__<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">delete</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>viewHooks<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">ViewHook</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>elementID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">hook</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  applyPendingUpdates<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pendingDiffs<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>diff<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> events<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>update<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">diff</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">events</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pendingDiffs <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>eachChild<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">child</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">child</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>applyPendingUpdates<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  eachChild<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">children</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>root<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>children<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">for</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">id</span> <span class="ahl-keyword" style="color: #ff79c6;">in</span> <span class="ahl-variable" style="color: #f8f8f2;">children</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getChildById<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">id</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  onChannel<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">event</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">cb</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onChannel<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>channel<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">event</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">resp</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isJoinPending<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>root<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pendingJoinOps<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>push<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">cb</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>requestDOMUpdate<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">cb</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  bindChannel<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; The diff event should be handled by the regular update operations.</span>
    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; All other operations are queued to be applied only after join.</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onChannel<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>channel<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;diff&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">rawDiff</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>requestDOMUpdate<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>applyDiff<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;update&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">rawDiff</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>diff<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> events<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>update<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">diff</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">events</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onChannel<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;redirect&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>to<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> flash<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onRedirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>to<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> flash<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onChannel<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;live_patch&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">redir</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onLivePatch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">redir</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onChannel<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;live_redirect&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">redir</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onLiveRedirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">redir</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>channel<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onError<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">reason</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onError<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">reason</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>channel<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onClose<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">reason</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onClose<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">reason</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  destroyAllChildren<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>eachChild<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">child</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">child</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>destroy<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  onLiveRedirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">redir</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>to<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> kind<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> flash<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">redir</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">url</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>expandURL<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">to</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>historyRedirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">url</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">kind</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">flash</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  onLivePatch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">redir</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>to<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> kind<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">redir</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>href <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>expandURL<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">to</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>historyPatch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">to</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">kind</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  expandURL<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">to</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">to</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>startsWith<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;&#x2f;&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> ? <span class="ahl-string" style="color: #f1fa8c;">`<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">window</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>location<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>protocol<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>&#x2f;&#x2f;<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">window</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>location<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>host<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">to</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>`</span> : <span class="ahl-variable" style="color: #f8f8f2;">to</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  onRedirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>to<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> flash<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>redirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">to</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">flash</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  isDestroyed<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>destroyed <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  joinDead<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isDead <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  join<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>showLoader<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>loaderTimeout<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>bindChannel<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isMain<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>stopCallback <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>withPageLoading<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>to: <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>href<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> kind: <span class="ahl-string" style="color: #f1fa8c;">&quot;initial&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinCallback <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">onDone</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">onDone</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">onDone</span> <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-keyword" style="color: #ff79c6;">function</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-variable" style="color: #f8f8f2;">callback</span> ? <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinCount<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onDone</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> : <span class="ahl-variable" style="color: #f8f8f2;">onDone</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>wrapPush<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>timeout: <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">false</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>channel<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>join<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>receive<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;ok&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">data</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
          <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isDestroyed<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
            <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>requestDOMUpdate<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onJoin<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">data</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
          <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
        <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>receive<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;error&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">resp</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isDestroyed<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onJoinError<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>receive<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;timeout&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isDestroyed<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onJoinError<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>reason: <span class="ahl-string" style="color: #f1fa8c;">&quot;timeout&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  onJoinError<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>reason <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;reload&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>log<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;error&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-string" style="color: #f1fa8c;">`failed mount with <span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>status<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>. Falling back to page request`</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isMain<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onRedirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>to: <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>href<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>reason <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;unauthorized&quot;</span> <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>reason <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;stale&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>log<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;error&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-string" style="color: #f1fa8c;">&quot;unauthorized live_redirect. Falling back to page request&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isMain<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onRedirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>to: <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>href<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>redirect <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>live_redirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinPending <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">false</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>channel<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>leave<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>redirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onRedirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>redirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>live_redirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onLiveRedirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>live_redirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>displayError<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_LOADING_CLASS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">PHX_ERROR_CLASS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">PHX_SERVER_ERROR_CLASS</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>log<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;error&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-string" style="color: #f1fa8c;">&quot;unable to join&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isConnected<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>reloadWithJitter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  onClose<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">reason</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isDestroyed<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>hasPendingLink<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">reason</span> <span class="ahl-operator" style="color: #f8f8f2;">!==</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;leave&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>reloadWithJitter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>destroyAllChildren<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>dropActiveElement<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; document.activeElement can be null in Internet Explorer 11</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">document</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>activeElement<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">document</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>activeElement<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>blur<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isUnloaded<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>showLoader<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">BEFORE_UNLOAD_LOADER_TIMEOUT</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  onError<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">reason</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onClose<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">reason</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isConnected<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>log<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;error&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-string" style="color: #f1fa8c;">&quot;view crashed&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">reason</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isUnloaded<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isConnected<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>displayError<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_LOADING_CLASS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">PHX_ERROR_CLASS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">PHX_SERVER_ERROR_CLASS</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>displayError<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_LOADING_CLASS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">PHX_ERROR_CLASS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">PHX_CLIENT_ERROR_CLASS</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  displayError<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">classes</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isMain<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>dispatchEvent<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">window</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;phx:page-loading-start&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>detail: <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>to: <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>href<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> kind: <span class="ahl-string" style="color: #f1fa8c;">&quot;error&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>showLoader<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>setContainerClasses<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span>...<span class="ahl-variable" style="color: #f8f8f2;">classes</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>execAll<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;disconnected&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  pushWithReply<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">refGenerator</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">event</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">payload</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onReply</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">function</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isConnected<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">refGenerator</span> ? <span class="ahl-variable" style="color: #f8f8f2;">refGenerator</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> : <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">onLoadingDone</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">function</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>page_loading <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_PAGE_LOADING</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">!==</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">onLoadingDone</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>withPageLoading<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>kind: <span class="ahl-string" style="color: #f1fa8c;">&quot;element&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> target: <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-keyword" style="color: #ff79c6;">typeof</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">payload</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>cid<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">!==</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;number&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">delete</span> <span class="ahl-variable" style="color: #f8f8f2;">payload</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>cid <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>wrapPush<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>timeout: <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>channel<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>push<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">event</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">payload</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">PUSH_TIMEOUT</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>receive<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;ok&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">resp</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
          <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">finish</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">hookReply</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
            <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>redirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onRedirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>redirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
            <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>live_patch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onLivePatch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>live_patch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
            <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>live_redirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onLiveRedirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>live_redirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
            <span class="ahl-variable" style="color: #f8f8f2;">onLoadingDone</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
            <span class="ahl-variable" style="color: #f8f8f2;">onReply</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">hookReply</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
          <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
          <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>diff<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
            <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>requestDOMUpdate<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
              <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>applyDiff<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;update&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>diff<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>diff<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> reply<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> events<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
                <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">ref</span> <span class="ahl-operator" style="color: #f8f8f2;">!==</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>undoRefs<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
                <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>update<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">diff</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">events</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
                <span class="ahl-variable" style="color: #f8f8f2;">finish</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">reply</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
              <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
            <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
          <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
            <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">ref</span> <span class="ahl-operator" style="color: #f8f8f2;">!==</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>undoRefs<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
            <span class="ahl-variable" style="color: #f8f8f2;">finish</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
          <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
        <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  undoRefs<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isConnected<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; exit if external form triggered</span>

    <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>all<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">document</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">`[<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_REF_SRC</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>=&quot;<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>&quot;][<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_REF</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>=&quot;<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>&quot;]`</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">disabledVal</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_DISABLED</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">readOnlyVal</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_READONLY</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; remove refs</span>
      <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>removeAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_REF</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>removeAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_REF_SRC</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; restore inputs</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">readOnlyVal</span> <span class="ahl-operator" style="color: #f8f8f2;">!==</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>readOnly <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">readOnlyVal</span> <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;true&quot;</span> ? <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span> : <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">false</span>
        <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>removeAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_READONLY</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">disabledVal</span> <span class="ahl-operator" style="color: #f8f8f2;">!==</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>disabled <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">disabledVal</span> <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;true&quot;</span> ? <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span> : <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">false</span>
        <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>removeAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_DISABLED</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; remove classes</span>
      <span class="ahl-variable" style="color: #f8f8f2;">PHX_EVENT_CLASSES</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">className</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>removeClass<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">className</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; restore disables</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">disableRestore</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_DISABLE_WITH_RESTORE</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">disableRestore</span> <span class="ahl-operator" style="color: #f8f8f2;">!==</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>innerText <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">disableRestore</span>
        <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>removeAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_DISABLE_WITH_RESTORE</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">toEl</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>private<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">PHX_REF</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">toEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">hook</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>triggerBeforeUpdateHook<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">toEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-variable" style="color: #f8f8f2;">DOMPatch</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>patchEl<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">toEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getActiveElement<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">hook</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">hook</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>__updated<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
        <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>deletePrivate<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">PHX_REF</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  putRef<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">elements</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">event</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">newRef</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>ref<span class="ahl-operator" style="color: #f8f8f2;">++</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">disableWith</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_DISABLE_WITH</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>loading<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">elements</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">elements</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>concat<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>all<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">document</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>loading<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

    <span class="ahl-keyword" style="color: #ff79c6;">for</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-keyword" style="color: #ff79c6;">of</span> <span class="ahl-variable" style="color: #f8f8f2;">elements</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>setAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_REF</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">newRef</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>setAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_REF_SRC</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>submitter <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>submitter <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>form<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">continue</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

      <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>classList<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>add<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">`phx-<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">event</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>-loading`</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">disableText</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">disableWith</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">disableText</span> <span class="ahl-operator" style="color: #f8f8f2;">!==</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_DISABLE_WITH_RESTORE</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
          <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>setAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_DISABLE_WITH_RESTORE</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>innerText<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
        <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">disableText</span> <span class="ahl-operator" style="color: #f8f8f2;">!==</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>innerText <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">disableText</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
        <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; PHX_DISABLED could have already been set in disableForm</span>
        <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>setAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_DISABLED</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_DISABLED</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>disabled<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>setAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;disabled&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">newRef</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">elements</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  componentID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">cid</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_COMPONENT</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">cid</span> ? <span class="ahl-variable" style="color: #f8f8f2;">parseInt</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">cid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> : <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  targetComponentID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">target</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">isCid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">cidOrSelector</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>target <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-variable" style="color: #f8f8f2;">target</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;target&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">isCid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">cidOrSelector</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">parseInt</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">cidOrSelector</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">cidOrSelector</span> <span class="ahl-operator" style="color: #f8f8f2;">!==</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span> <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>target<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>closestComponentID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  closestComponentID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">isCid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">maybe</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>closest<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">`[<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_COMPONENT</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>]`</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>ownsElement<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>componentID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  pushHookEvent<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">event</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">payload</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onReply</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isConnected<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>log<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;hook&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-string" style="color: #f1fa8c;">&quot;unable to push hook event. LiveView not connected&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">event</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">payload</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">false</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">els</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>putRef<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;hook&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pushWithReply<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">els</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;event&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      type: <span class="ahl-string" style="color: #f1fa8c;">&quot;hook&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
      event: <span class="ahl-variable" style="color: #f8f8f2;">event</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
      value: <span class="ahl-variable" style="color: #f8f8f2;">payload</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
      cid: <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>closestComponentID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">reply</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">onReply</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">reply</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">ref</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  extractMeta<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">value</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">prefix</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;value-&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">for</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">i</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> 0<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">;</span> <span class="ahl-variable" style="color: #f8f8f2;">i</span> <span class="ahl-operator" style="color: #f8f8f2;">&lt;</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>attributes<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">;</span> <span class="ahl-variable" style="color: #f8f8f2;">i</span><span class="ahl-operator" style="color: #f8f8f2;">++</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">meta</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">name</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>attributes<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">i</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>name
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">name</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>startsWith<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">prefix</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">name</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>replace<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">prefix</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">name</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>value <span class="ahl-operator" style="color: #f8f8f2;">!==</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">undefined</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-keyword" style="color: #ff79c6;">instanceof</span> <span class="ahl-variable" style="color: #f8f8f2;">HTMLFormElement</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">meta</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>value <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>value

      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>tagName <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;INPUT&quot;</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">CHECKABLE_INPUTS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>indexOf<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>type<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">&gt;=</span> 0 <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>checked<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-keyword" style="color: #ff79c6;">delete</span> <span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>value
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">value</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">meta</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-keyword" style="color: #ff79c6;">for</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">key</span> <span class="ahl-keyword" style="color: #ff79c6;">in</span> <span class="ahl-variable" style="color: #f8f8f2;">value</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">key</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">value</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">key</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">meta</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>


  pushEvent<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">type</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">phxEvent</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onReply</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pushWithReply<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>putRef<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">type</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;event&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      type: <span class="ahl-variable" style="color: #f8f8f2;">type</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
      event: <span class="ahl-variable" style="color: #f8f8f2;">phxEvent</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
      value: <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>extractMeta<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>value<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
      cid: <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>targetComponentID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">reply</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">onReply</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">onReply</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">reply</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  pushFileProgress<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">fileEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">entryRef</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">progress</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onReply</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">function</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>withinOwners<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">fileEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>form<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">view</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">view</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pushWithReply<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;progress&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        event: <span class="ahl-variable" style="color: #f8f8f2;">fileEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">view</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_PROGRESS</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
        ref: <span class="ahl-variable" style="color: #f8f8f2;">fileEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_UPLOAD_REF</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
        entry_ref: <span class="ahl-variable" style="color: #f8f8f2;">entryRef</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
        progress: <span class="ahl-variable" style="color: #f8f8f2;">progress</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
        cid: <span class="ahl-variable" style="color: #f8f8f2;">view</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>targetComponentID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">fileEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>form<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onReply</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  pushInput<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">forceCid</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">phxEvent</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">uploads</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">cid</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">isCid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">forceCid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> ? <span class="ahl-variable" style="color: #f8f8f2;">forceCid</span> : <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>targetComponentID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>form<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">refGenerator</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>putRef<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>form<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;change&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">formData</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">meta</span>  <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>extractMeta<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>form<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span> <span class="ahl-keyword" style="color: #ff79c6;">instanceof</span> <span class="ahl-variable" style="color: #f8f8f2;">HTMLButtonElement</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>submitter <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">inputEl</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;change&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">formData</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">serializeForm</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>form<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>_target: <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>_target<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> ...<span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>name<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">formData</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">serializeForm</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>form<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>_target: <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>_target<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> ...<span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isUploadInput<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>files <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>files<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">&gt;</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">LiveUploader</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>trackFiles<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">Array</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>from<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>files<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable" style="color: #f8f8f2;">uploads</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">LiveUploader</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>serializeUploads<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">event</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      type: <span class="ahl-string" style="color: #f1fa8c;">&quot;form&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
      event: <span class="ahl-variable" style="color: #f8f8f2;">phxEvent</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
      value: <span class="ahl-variable" style="color: #f8f8f2;">formData</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
      uploads: <span class="ahl-variable" style="color: #f8f8f2;">uploads</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
      cid: <span class="ahl-variable" style="color: #f8f8f2;">cid</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pushWithReply<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">refGenerator</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;event&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">event</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">resp</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>showError<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_FEEDBACK_FOR</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_FEEDBACK_GROUP</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isUploadInput<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isAutoUpload<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">LiveUploader</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filesAwaitingPreflight<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">&gt;</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
          <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">_els</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">refGenerator</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
          <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>uploadFiles<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>form<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">cid</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">_uploads</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
            <span class="ahl-variable" style="color: #f8f8f2;">callback</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
            <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>triggerAwaitingSubmit<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>form<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
            <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>undoRefs<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
          <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable" style="color: #f8f8f2;">callback</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  triggerAwaitingSubmit<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">awaitingSubmit</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getScheduledSubmit<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">awaitingSubmit</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">_el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">_ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">_opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">awaitingSubmit</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>cancelSubmit<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  getScheduledSubmit<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>formSubmits<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>find<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">_ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">_opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">_callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isSameNode<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  scheduleSubmit<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getScheduledSubmit<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>formSubmits<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>push<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  cancelSubmit<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>formSubmits <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>formSubmits<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">_callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isSameNode<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>undoRefs<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">false</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  disableForm<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">filterIgnored</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">userIgnored</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">closestPhxBinding</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">`<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_UPDATE</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>=ignore`</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>form<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">userIgnored</span> <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-variable" style="color: #f8f8f2;">closestPhxBinding</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;data-phx-update=ignore&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>form<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">filterDisables</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>hasAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_DISABLE_WITH</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">filterButton</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>tagName <span class="ahl-operator" style="color: #f8f8f2;">==</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;BUTTON&quot;</span>

    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">filterInput</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-string" style="color: #f1fa8c;">&quot;INPUT&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;TEXTAREA&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;SELECT&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>includes<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>tagName<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">formElements</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">Array</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>from<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>elements<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">disables</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">formElements</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">filterDisables</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">buttons</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">formElements</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">filterButton</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">filterIgnored</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">inputs</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">formElements</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">filterInput</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">filterIgnored</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-variable" style="color: #f8f8f2;">buttons</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">button</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">button</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>setAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_DISABLED</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">button</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>disabled<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable" style="color: #f8f8f2;">button</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>disabled <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable" style="color: #f8f8f2;">inputs</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">input</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>setAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_READONLY</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>readOnly<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>readOnly <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>files<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>setAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_DISABLED</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>disabled<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>disabled <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>setAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_PAGE_LOADING</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>putRef<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>concat<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">disables</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>concat<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">buttons</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>concat<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputs</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;submit&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  pushFormSubmit<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">phxEvent</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">submitter</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onReply</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">refGenerator</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>disableForm<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>...<span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> form: <span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> submitter: <span class="ahl-variable" style="color: #f8f8f2;">submitter</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">cid</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>targetComponentID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">LiveUploader</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>hasUploadsInProgress<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">_els</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">refGenerator</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">push</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pushFormSubmit<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">phxEvent</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">submitter</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onReply</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>scheduleSubmit<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">push</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">LiveUploader</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>inputsAwaitingPreflight<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">&gt;</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">els</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">refGenerator</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">proxyRefGen</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">els</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>uploadFiles<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">cid</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">uploads</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; if we still having pending preflights it means we have invalid entries</span>
        <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; and the phx-submit cannot be completed</span>
        <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">LiveUploader</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>inputsAwaitingPreflight<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">&gt;</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
          <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>undoRefs<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
        <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">meta</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>extractMeta<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">formData</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">serializeForm</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>submitter<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> ...<span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pushWithReply<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">proxyRefGen</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;event&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
          type: <span class="ahl-string" style="color: #f1fa8c;">&quot;form&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
          event: <span class="ahl-variable" style="color: #f8f8f2;">phxEvent</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
          value: <span class="ahl-variable" style="color: #f8f8f2;">formData</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
          cid: <span class="ahl-variable" style="color: #f8f8f2;">cid</span>
        <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onReply</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>hasAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_REF</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>classList<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>contains<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;phx-submit-loading&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">meta</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>extractMeta<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">formData</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">serializeForm</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>submitter<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> ...<span class="ahl-variable" style="color: #f8f8f2;">meta</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pushWithReply<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">refGenerator</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;event&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        type: <span class="ahl-string" style="color: #f1fa8c;">&quot;form&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
        event: <span class="ahl-variable" style="color: #f8f8f2;">phxEvent</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
        value: <span class="ahl-variable" style="color: #f8f8f2;">formData</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
        cid: <span class="ahl-variable" style="color: #f8f8f2;">cid</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onReply</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  uploadFiles<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">cid</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onComplete</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">joinCountAtUpload</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinCount
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">inputEls</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">LiveUploader</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>activeFileInputs<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">formEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">numFileInputsInProgress</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">inputEls</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length

    <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; get each file input</span>
    <span class="ahl-variable" style="color: #f8f8f2;">inputEls</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">uploader</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-keyword" style="color: #ff79c6;">new</span> <span class="ahl-variable" style="color: #f8f8f2;">LiveUploader</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable" style="color: #f8f8f2;">numFileInputsInProgress</span><span class="ahl-operator" style="color: #f8f8f2;">--</span>
        <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">numFileInputsInProgress</span> <span class="ahl-operator" style="color: #f8f8f2;">===</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">onComplete</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">;</span>

      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">entries</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">uploader</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>entries<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>map<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">entry</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">entry</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>toPreflightPayload<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">entries</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">===</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable" style="color: #f8f8f2;">numFileInputsInProgress</span><span class="ahl-operator" style="color: #f8f8f2;">--</span>
        <span class="ahl-keyword" style="color: #ff79c6;">return</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">payload</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        ref: <span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_UPLOAD_REF</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
        entries: <span class="ahl-variable" style="color: #f8f8f2;">entries</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span>
        cid: <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>targetComponentID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>form<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>log<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;upload&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-string" style="color: #f1fa8c;">&quot;sending preflight request&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">payload</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pushWithReply<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;allow_upload&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">payload</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">resp</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>log<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;upload&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-string" style="color: #f1fa8c;">&quot;got preflight response&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; the preflight will reject entries beyond the max entries</span>
        <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; so we error and cancel entries on the client that are missing from the response</span>
        <span class="ahl-variable" style="color: #f8f8f2;">uploader</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>entries<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">entry</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
          <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>entries <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>entries<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">entry</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>ref<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
            <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>handleFailedEntryPreflight<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">entry</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>ref<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;failed preflight&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">uploader</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
          <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
        <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; for auto uploads, we may have an empty entries response from the server</span>
        <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; for form submits that contain invalid entries</span>
        <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>error <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-variable" style="color: #f8f8f2;">Object</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>keys<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>entries<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">===</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
          <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>undoRefs<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">ref</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
          <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">errors</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>error <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>
          <span class="ahl-variable" style="color: #f8f8f2;">errors</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>map<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">entry_ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">reason</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
            <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>handleFailedEntryPreflight<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">entry_ref</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">reason</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">uploader</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
          <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
          <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">onError</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
            <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>channel<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>onError<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
              <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinCount <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-variable" style="color: #f8f8f2;">joinCountAtUpload</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
            <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
          <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
          <span class="ahl-variable" style="color: #f8f8f2;">uploader</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>initAdapterUpload<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">onError</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  handleFailedEntryPreflight<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">uploadRef</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">reason</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">uploader</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">uploader</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isAutoUpload<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; uploadRef may be top level upload config ref or entry ref</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">entry</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">uploader</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>entries<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>find<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">entry</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">entry</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>ref <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-variable" style="color: #f8f8f2;">uploadRef</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>toString<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">entry</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">entry</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>cancel<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">uploader</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>entries<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>map<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">entry</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">entry</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>cancel<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>log<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;upload&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-string" style="color: #f1fa8c;">`error for entry <span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">uploadRef</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>`</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">reason</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  dispatchUploads<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">name</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">filesOrBlobs</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">targetElement</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>targetCtxElement<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">inputs</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>findUploadInputs<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">targetElement</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>name <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-variable" style="color: #f8f8f2;">name</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputs</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">===</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">logError</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">`no live file inputs found matching the name &quot;<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">name</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>&quot;`</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputs</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">&gt;</span> 1<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">logError</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">`duplicate live file inputs found matching the name &quot;<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">name</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>&quot;`</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
    <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>dispatchEvent<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputs</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span>0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">PHX_TRACK_UPLOADS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>detail: <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>files: <span class="ahl-variable" style="color: #f8f8f2;">filesOrBlobs</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  targetCtxElement<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">isCid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">target</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>findComponentNodeList<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">target</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  pushFormRecovery<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">newCid</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>withinOwners<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">view</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">phxChange</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;change&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">inputs</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">Array</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>from<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>elements<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isFormInput<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>name <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>hasAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">phxChange</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">inputs</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">===</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

      <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; we must clear tracked uploads before recovery as they no longer have valid refs</span>
      <span class="ahl-variable" style="color: #f8f8f2;">inputs</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">input</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>hasAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_UPLOAD_REF</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">LiveUploader</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>clearFiles<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">input</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">inputs</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>find<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>type <span class="ahl-operator" style="color: #f8f8f2;">!==</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;hidden&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-variable" style="color: #f8f8f2;">inputs</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span>0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>

      <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">phxEvent</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_AUTO_RECOVER</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">||</span> <span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;change&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable" style="color: #f8f8f2;">JS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>exec<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;change&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">phxEvent</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">view</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-string" style="color: #f1fa8c;">&quot;push&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>_target: <span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>name<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> newCid: <span class="ahl-variable" style="color: #f8f8f2;">newCid</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> callback: <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  pushLinkPatch<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">href</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">linkRef</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>setPendingLink<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">href</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">refGen</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">targetEl</span> ? <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>putRef<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">targetEl</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;click&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> : <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">fallback</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>redirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">window</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>location<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>href<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">url</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">href</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>startsWith<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;&#x2f;&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> ? <span class="ahl-string" style="color: #f1fa8c;">`<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">location</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>protocol<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>&#x2f;&#x2f;<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">location</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>host<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">href</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>`</span> : <span class="ahl-variable" style="color: #f8f8f2;">href</span>

    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">push</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pushWithReply<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">refGen</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;live_patch&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>url<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">resp</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>requestDOMUpdate<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>link_redirect<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
          <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>replaceMain<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">href</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">linkRef</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
          <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>commitPendingLink<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">linkRef</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
            <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>href <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">href</span>
          <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
          <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>applyPendingUpdates<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
          <span class="ahl-variable" style="color: #f8f8f2;">callback</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">callback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">linkRef</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">push</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">push</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>receive<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;timeout&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">fallback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">fallback</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  formsForRecovery<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">html</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>joinCount <span class="ahl-operator" style="color: #f8f8f2;">===</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">phxChange</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;change&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">template</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">document</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>createElement<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">&quot;template&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable" style="color: #f8f8f2;">template</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>innerHTML <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">html</span>

    <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span>
      <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>all<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">`form[<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">phxChange</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>]`</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>ownsElement<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>elements<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">&gt;</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_AUTO_RECOVER</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">!==</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;ignore&quot;</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>map<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
          <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; attribute given via JS module needs to be escaped as it contains the symbols []&quot;,</span>
          <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; which result in an invalid css selector otherwise.</span>
          <span class="ahl-keyword" style="color: #ff79c6;">const</span> <span class="ahl-variable" style="color: #f8f8f2;">phxChangeValue</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">CSS</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>escape<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">phxChange</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
          <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">newForm</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">template</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>content<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>querySelector<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-string" style="color: #f1fa8c;">`form[id=&quot;<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>&quot;][<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">phxChange</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>=&quot;<span class="ahl-punctuation ahl-special" style="color: #ff79c6;">${</span><span class="ahl-variable" style="color: #f8f8f2;">phxChangeValue</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>&quot;]`</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
          <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">newForm</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
            <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">newForm</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>targetComponentID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">newForm</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>
          <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span> <span class="ahl-keyword" style="color: #ff79c6;">else</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
            <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>targetComponentID<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span>
          <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
        <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">[</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">newForm</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">newCid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">]</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">newForm</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  maybePushComponentsDestroyed<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">destroyedCIDs</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">willDestroyCIDs</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">destroyedCIDs</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">cid</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>findComponentNodeList<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">cid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">===</span> 0
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

    <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">willDestroyCIDs</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">&gt;</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; we must reset the render change tracking for cids that</span>
      <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; could be added back from the server so we don&#x27;t skip them</span>
      <span class="ahl-variable" style="color: #f8f8f2;">willDestroyCIDs</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">cid</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>rendered<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>resetRender<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">cid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pushWithReply<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;cids_will_destroy&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>cids: <span class="ahl-variable" style="color: #f8f8f2;">willDestroyCIDs</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
        <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; See if any of the cids we wanted to destroy were added back,</span>
        <span class="ahl-comment" style="color: #6272A4;">&#x2f;&#x2f; if they were added back, we don&#x27;t actually destroy them.</span>
        <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">completelyDestroyCIDs</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">willDestroyCIDs</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>filter<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">cid</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
          <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>findComponentNodeList<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>el<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">cid</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">===</span> 0
        <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>

        <span class="ahl-keyword" style="color: #ff79c6;">if</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">completelyDestroyCIDs</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>length <span class="ahl-operator" style="color: #f8f8f2;">&gt;</span> 0<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
          <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pushWithReply<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-constant ahl-builtin" style="color: #BD93F9;">null</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-string" style="color: #f1fa8c;">&quot;cids_destroyed&quot;</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>cids: <span class="ahl-variable" style="color: #f8f8f2;">completelyDestroyCIDs</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
            <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>rendered<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pruneCIDs<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">resp</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>cids<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
          <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
        <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  ownsElement<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-keyword" style="color: #ff79c6;">let</span> <span class="ahl-variable" style="color: #f8f8f2;">parentViewEl</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>closest<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_VIEW_SELECTOR</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable" style="color: #f8f8f2;">el</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>getAttribute<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_PARENT_ID</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id <span class="ahl-operator" style="color: #f8f8f2;">||</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">parentViewEl</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable" style="color: #f8f8f2;">parentViewEl</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id <span class="ahl-operator" style="color: #f8f8f2;">===</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>id<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">||</span>
      <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-operator" style="color: #f8f8f2;">!</span><span class="ahl-variable" style="color: #f8f8f2;">parentViewEl</span> <span class="ahl-operator" style="color: #f8f8f2;">&amp;&amp;</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>isDead<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  submitForm<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">phxEvent</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">submitter</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
    <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>putPrivate<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">PHX_HAS_SUBMITTED</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">const</span> <span class="ahl-variable" style="color: #f8f8f2;">phxFeedbackFor</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_FEEDBACK_FOR</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">const</span> <span class="ahl-variable" style="color: #f8f8f2;">phxFeedbackGroup</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">PHX_FEEDBACK_GROUP</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-keyword" style="color: #ff79c6;">const</span> <span class="ahl-variable" style="color: #f8f8f2;">inputs</span> <span class="ahl-operator" style="color: #f8f8f2;">=</span> <span class="ahl-variable" style="color: #f8f8f2;">Array</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>from<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>elements<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable" style="color: #f8f8f2;">inputs</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">input</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>putPrivate<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">PHX_HAS_SUBMITTED</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-constant ahl-builtin" style="color: #BD93F9;">true</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>blurActiveElement<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>pushFormSubmit<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">form</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">targetCtx</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">phxEvent</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">submitter</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">opts</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span>
      <span class="ahl-variable" style="color: #f8f8f2;">inputs</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>forEach<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">input</span> <span class="ahl-operator" style="color: #f8f8f2;">=&gt;</span> <span class="ahl-variable" style="color: #f8f8f2;">DOM</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>showError<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">input</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">phxFeedbackFor</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">,</span> <span class="ahl-variable" style="color: #f8f8f2;">phxFeedbackGroup</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
      <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>restorePreviouslyActiveFocus<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
    <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span>
  <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>

  binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">kind</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">{</span> <span class="ahl-keyword" style="color: #ff79c6;">return</span> <span class="ahl-variable ahl-builtin" style="font-style: italic; color: #BD93F9;">this</span><span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>liveSocket<span class="ahl-punctuation ahl-delimiter" style="color: #f8f8f2;">.</span>binding<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">(</span><span class="ahl-variable" style="color: #f8f8f2;">kind</span><span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">)</span> <span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
<span class="ahl-punctuation ahl-bracket" style="color: #f8f8f2;">}</span>
</code></pre>
</body>
</html>
